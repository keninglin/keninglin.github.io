<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET Web Forms 教學</title>
    <!-- Bootstrap 5.3.0 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome 6.4.0 CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- 索引選單相關樣式 -->
    <style>
        /* 平滑滾動效果 */
        html {
            scroll-behavior: smooth;
        }

        /* 錨點偏移，避免被固定導航欄遮蓋 */
        [id] {
            scroll-margin-top: 80px; /* 根據你的導航欄高度調整 */
        }

        /* 索引選單樣式 */
        .index-menu {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 4px solid #0d6efd;
        }

        .index-menu a {
            transition: all 0.2s ease;
            padding: 2px 0;
            display: inline-block;
        }

        .index-menu a:hover {
            color: #0d6efd !important;
            transform: translateX(5px);
        }

        /* 主選單標題樣式 */
        .index-menu h5.index-main-topic { /* Renamed class for clarity */
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
            padding-bottom: 8px;
            margin-bottom: 15px !important;
        }

        /* 子選單項目縮排與間距 */
        .index-menu .ps-3 { /* Keep this for sub-items if using week1's exact structure */
            border-left: 2px dotted rgba(0, 0, 0, 0.2);
            margin-left: 10px;
        }
        .index-menu ul.sub-items { /* Added class for sub-items list */
             padding-left: 20px; /* Indent sub-items */
        }

        /* 子選單徽章樣式 - reusing from week1 for consistency */
        .index-menu .badge.bg-outline-primary {
            background-color: transparent !important;
            border: 1px solid #0d6efd !important;
        }
        .index-menu .badge.bg-outline-success {
            background-color: transparent !important;
            border: 1px solid #198754 !important;
        }
        .index-menu .badge.bg-outline-info {
            background-color: transparent !important;
            border: 1px solid #0dcaf0 !important;
        }
         .index-menu .badge.bg-outline-warning {
            background-color: transparent !important;
            border: 1px solid #ffc107 !important;
        }
        .index-menu .badge.bg-outline-danger {
            background-color: transparent !important;
            border: 1px solid #dc3545 !important;
        }
        .index-menu .badge.bg-outline-secondary {
            background-color: transparent !important;
            border: 1px solid #6c757d !important;
        }

        /* 浮動回到頂部按鈕 */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #0d6efd;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background: #0b5ed7;
            transform: translateY(-2px);
        }

        /* 程式碼複製按鈕樣式 */
        .code-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(108, 117, 125, 0.8);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 10;
            backdrop-filter: blur(4px);
            min-width: 60px;
        }

        .copy-btn:hover {
            background: rgba(108, 117, 125, 0.9);
            transform: scale(1.05);
        }

        .copy-btn.success {
            background: rgba(25, 135, 84, 0.8);
        }

        .copy-btn.success:hover {
            background: rgba(25, 135, 84, 0.9);
        }

        /* 確保程式碼區塊有適當的padding避免被按鈕遮擋 */
        .code-container pre {
            padding-top: 40px !important;
            padding-right: 80px !important;
            overflow-x: auto;
        }

        /* 在較小螢幕上調整按鈕位置 */
        @media (max-width: 768px) {
            .copy-btn {
                top: 6px;
                right: 6px;
                padding: 3px 6px;
                font-size: 11px;
                min-width: 50px;
            }
            
            .code-container pre {
                padding-top: 35px !important;
                padding-right: 60px !important;
            }
        }
    </style>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
            <div class="container">
                <a href="aspnet-webforms.html" class="navbar-brand"><i class="fa-solid fa-graduation-cap me-2"></i>ASP.NET Web Forms 教學</a>
            </div>
        </nav>
    </header>
    <main class="container" id="top" style="padding-top: 70px;"> <!-- Added padding-top for fixed navbar -->
        <section class="lesson">
            <h1 class="display-6 fw-bold mb-4"><i class="fa-solid fa-server me-2"></i>ASP.NET Web Forms 教學</h1>
            <!-- 課程索引選單 -->
            <div class="alert alert-light border mb-4 index-menu">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="alert-heading mb-0"><i class="fa-solid fa-list me-2 text-primary"></i>課程內容索引</h5>
                    <button class="btn btn-sm btn-outline-primary" type="button" data-bs-toggle="collapse"
                        data-bs-target="#indexContent" aria-expanded="true" aria-controls="indexContent">
                        <i class="fa-solid fa-chevron-up" id="toggleIcon"></i>
                    </button>
                </div>
                <div class="collapse show" id="indexContent">
                    <p class="mb-3 mt-2 small text-muted">點擊下方連結快速跳轉到對應章節</p>

                    <!-- Curriculum Index -->
                    <div class="row">
                        <div class="col-md-6">
                            <!-- Section 0 - HTTP 基礎 -->
                            <div class="mb-3">
                                <h5 class="text-dark mb-2 fw-bold">
                                    <a href="#http-basics" class="text-decoration-none text-dark">
                                        <span class="badge bg-dark me-2">0</span><i class="fa-solid fa-globe me-2"></i>HTTP 協議基礎
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#http-intro" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.1</span>HTTP 協議介紹</a></li>
                                    <li class="mb-1"><a href="#http-methods" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.2</span>HTTP 請求方法 (GET、POST、PUT、DELETE)</a></li>
                                    <li class="mb-1"><a href="#http-status" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.3</span>HTTP 狀態碼</a></li>
                                    <li class="mb-1"><a href="#http-headers" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.4</span>HTTP 標頭與內容類型</a></li>
                                </ul>
                            </div>
                            <!-- Section 1 -->
                            <div class="mb-3">
                                <h5 class="text-primary mb-2 fw-bold">
                                    <a href="#aspnet-intro" class="text-decoration-none text-primary">
                                        <span class="badge bg-primary me-2">1</span><i class="fa-solid fa-book me-2"></i>認識 ASP.NET Web Forms
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-intro-what" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">1.1</span>什麼是 Web Forms？</a></li>
                                    <li class="mb-1"><a href="#aspnet-intro-diff" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">1.2</span>與 ASP.NET MVC 和 ASP.NET Core MVC 的差異</a></li>
                                    <li class="mb-1"><a href="#aspnet-intro-http" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">1.3</span>Web Forms 如何處理 HTTP 請求</a></li>
                                </ul>
                            </div>
                            <!-- Section 2 -->
                            <div class="mb-3">
                                <h5 class="text-success mb-2 fw-bold">
                                    <a href="#aspnet-env" class="text-decoration-none text-success">
                                        <span class="badge bg-success me-2">2</span><i class="fa-solid fa-tools me-2"></i>開發環境安裝與設定
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-env-vs" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">2.1</span>安裝 Visual Studio</a></li>
                                    <li class="mb-1"><a href="#aspnet-env-project" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">2.2</span>建立第一個 Web Forms 專案</a></li>
                                </ul>
                            </div>
                            <!-- Section 3 -->
                            <div class="mb-3">
                                <h5 class="text-info mb-2 fw-bold">
                                    <a href="#aspnet-structure" class="text-decoration-none text-info">
                                        <span class="badge bg-info me-2">3</span><i class="fa-solid fa-folder-open me-2"></i>專案結構與檔案說明
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-structure-overview" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.1</span>專案架構概覽</a></li>
                                    <li class="mb-1"><a href="#aspnet-structure-core-files" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.2</span>重要檔案詳解</a></li>
                                    <li class="mb-1"><a href="#aspnet-structure-folders" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.3</span>核心資料夾解析</a></li>
                                </ul>
                            </div>
                            <!-- Section 4 -->
                            <div class="mb-3">
                                <h5 class="text-warning mb-2 fw-bold">
                                    <a href="#aspnet-ui" class="text-decoration-none text-warning">
                                        <span class="badge bg-warning me-2">4</span><i class="fa-solid fa-palette me-2"></i>設計網頁介面
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-ui-designer" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">4.1</span>使用設計器與原始碼編輯</a></li>
                                    <li class="mb-1"><a href="#aspnet-ui-controls" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">4.2</span>常用伺服器控制項</a></li>
                                </ul>
                            </div>
                            <!-- Section 5 -->
                            <div class="mb-3">
                                <h5 class="text-success mb-2 fw-bold">
                                    <a href="#aspnet-api" class="text-decoration-none text-success">
                                        <span class="badge bg-success me-2">5</span><i class="fa-solid fa-code me-2"></i>實作 API 與檔案處理
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-api-overview" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">5.1</span>建立 RESTful API 端點</a></li>
                                    <li class="mb-1"><a href="#aspnet-file-upload" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">5.2</span>檔案上傳處理</a></li>
                                    <li class="mb-1"><a href="#aspnet-json-processing" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">5.3</span>JSON 資料處理與儲存</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6">                         
                            <!-- Section 6 -->
                            <div class="mb-3">
                                <h5 class="text-danger mb-2 fw-bold">
                                    <a href="#aspnet-logic" class="text-decoration-none text-danger">
                                        <span class="badge bg-danger me-2">6</span><i class="fa-solid fa-cogs me-2"></i>事件處理與程式邏輯
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-logic-lifecycle" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">6.1</span>Page Life Cycle</a></li>
                                    <li class="mb-1"><a href="#aspnet-logic-events" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">6.2</span>控制項事件</a></li>
                                </ul>
                            </div>
                            <!-- Section 7 -->
                            <div class="mb-3">
                                <h5 class="text-primary mb-2 fw-bold">
                                    <a href="#aspnet-data" class="text-decoration-none text-primary">
                                        <span class="badge bg-primary me-2">7</span><i class="fa-solid fa-database me-2"></i>資料繫結與資料庫操作
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-data-binding" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">7.1</span>使用 SqlDataSource、GridView</a></li>
                                    <li class="mb-1"><a href="#aspnet-data-connection" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">7.2</span>資料庫連線設定</a></li>
                                </ul>
                            </div>
                            <!-- Section 7 -->
                            <div class="mb-3">
                                <h5 class="text-success mb-2 fw-bold">
                                    <a href="#aspnet-state" class="text-decoration-none text-success">
                                        <span class="badge bg-success me-2">7</span><i class="fa-solid fa-history me-2"></i>狀態管理
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-state-management" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">7.1</span>ViewState、Session、Cookie、Application</a></li>
                                </ul>
                            </div>
                            <!-- Section 8 -->
                            <div class="mb-3">
                                <h5 class="text-info mb-2 fw-bold">
                                    <a href="#aspnet-security" class="text-decoration-none text-info">
                                        <span class="badge bg-info me-2">8</span><i class="fa-solid fa-shield-alt me-2"></i>驗證與安全性
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-security-validation" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">8.1</span>驗證控制項</a></li>
                                    <li class="mb-1"><a href="#aspnet-security-auth" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">8.2</span>使用者登入與授權</a></li>
                                </ul>
                            </div>
                            <!-- Section 9 -->
                            <div class="mb-3">
                                <h5 class="text-warning mb-2 fw-bold">
                                    <a href="#aspnet-deploy" class="text-decoration-none text-warning">
                                        <span class="badge bg-warning me-2">9</span><i class="fa-solid fa-rocket me-2"></i>網站發佈與部署
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-deploy-iis" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">9.1</span>發佈到本機 IIS</a></li>
                                    <li class="mb-1"><a href="#aspnet-deploy-azure" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">9.2</span>發佈到雲端（如 Azure）</a></li>
                                </ul>
                            </div>
                            <!-- Section 10 -->
                            <div class="mb-3">
                                <h5 class="text-danger mb-2 fw-bold">
                                    <a href="#aspnet-advanced" class="text-decoration-none text-danger">
                                        <span class="badge bg-danger me-2">10</span><i class="fa-solid fa-star me-2"></i>進階主題
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-advanced-masteruser" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">10.1</span>Master Page 與 User Control</a></li>
                                    <li class="mb-1"><a href="#aspnet-advanced-customcontrols" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">10.2</span>自訂伺服器控制項</a></li>
                                    <li class="mb-1"><a href="#aspnet-advanced-ajax" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">10.3</span>AJAX 與 UpdatePanel</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Sections -->
                
                <!-- HTTP 基礎章節 -->
                <section id="http-basics" class="py-3">
                    <h2 class="text-dark fw-bold border-bottom pb-2 mb-3"><span class="badge bg-dark me-2">0</span>HTTP 協議基礎</h2>
                    
                    <div id="http-intro" class="mb-4">
                        <h4 class="text-dark">0.1 HTTP 協議介紹</h4>
                        
                        <div class="alert alert-dark border-start border-4 border-dark">
                            <h5 class="alert-heading"><i class="fa-solid fa-globe me-2"></i>什麼是 HTTP？</h5>
                            <p class="mb-0">HTTP (HyperText Transfer Protocol) 是網際網路上最重要的通信協議，定義了瀏覽器和伺服器之間如何交換資料。</p>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-exchange-alt me-2"></i>HTTP 的工作原理</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-light">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-arrow-right me-2 text-success"></i>請求 (Request)</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">用戶端（瀏覽器）向伺服器發送請求</p>
                                        <ul class="small mb-0">
                                            <li>請求方法 (GET, POST 等)</li>
                                            <li>請求 URL</li>
                                            <li>請求標頭</li>
                                            <li>請求主體 (如有)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-light">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-arrow-left me-2 text-info"></i>回應 (Response)</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">伺服器處理請求後回傳回應</p>
                                        <ul class="small mb-0">
                                            <li>狀態碼 (200, 404 等)</li>
                                            <li>回應標頭</li>
                                            <li>回應主體 (HTML, JSON 等)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-info-circle me-2"></i>HTTP 的特性</h5>
                        <div class="bg-light p-3 rounded">
                            <ul class="mb-0">
                                <li><strong>無狀態 (Stateless)：</strong>每個請求都是獨立的，伺服器不會記住之前的請求</li>
                                <li><strong>基於文字：</strong>HTTP 訊息都是可讀的文字格式</li>
                                <li><strong>簡單易懂：</strong>協議設計簡潔，容易理解和實作</li>
                                <li><strong>可擴展：</strong>可以透過標頭擴展功能</li>
                            </ul>
                        </div>
                    </div>

                    <div id="http-methods" class="mb-4">
                        <h4 class="text-dark">0.2 HTTP 請求方法 (GET、POST、PUT、DELETE)</h4>
                        
                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-list me-2"></i>四種主要的 HTTP 方法</h5>
                        
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>方法</th>
                                        <th>用途</th>
                                        <th>安全性</th>
                                        <th>冪等性</th>
                                        <th>常見用途</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge bg-success">GET</span></td>
                                        <td>讀取資料</td>
                                        <td>安全</td>
                                        <td>冪等</td>
                                        <td>瀏覽網頁、查詢資料</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-primary">POST</span></td>
                                        <td>新增資料</td>
                                        <td>不安全</td>
                                        <td>非冪等</td>
                                        <td>提交表單、新增記錄</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-warning">PUT</span></td>
                                        <td>更新資料</td>
                                        <td>不安全</td>
                                        <td>冪等</td>
                                        <td>完整更新資源</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-danger">DELETE</span></td>
                                        <td>刪除資料</td>
                                        <td>不安全</td>
                                        <td>冪等</td>
                                        <td>刪除資源</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="alert alert-info mt-4">
                            <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>重要概念說明</h6>
                            <ul class="mb-0 small">
                                <li><strong>安全 (Safe)：</strong>不會修改伺服器上的資料，只讀取</li>
                                <li><strong>冪等 (Idempotent)：</strong>多次執行相同請求的效果相同</li>
                                <li><strong>Web Forms 主要使用 GET 和 POST</strong>，PUT 和 DELETE 在 REST API 中較常見</li>
                            </ul>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-shield-alt me-2"></i>為什麼冪等性重要？</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-redo me-2"></i>網路重試安全</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">當網路不穩定或請求逾時時，系統可以安全地重試冪等操作，不用擔心產生重複的副作用。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>更新使用者資料失敗時，可以安全重試，不會造成數據異常。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-user-shield me-2"></i>防止重複操作</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">防止使用者重複點擊按鈕或重複提交表單造成的問題，確保系統狀態的一致性。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>刪除資料時，多次點擊不會產生錯誤或異常狀態。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-cogs me-2"></i>系統可靠性</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">提高系統的容錯能力，即使在分散式環境或微服務架構中，也能確保操作的可預測性。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>在負載平衡環境下，請求可能被路由到不同伺服器，冪等性確保結果一致。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-code me-2"></i>API 設計標準</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">符合 REST API 設計原則，讓 API 更容易理解、使用和維護，提高開發效率。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>第三方開發者可以安全地整合您的 API，不用擔心重複呼叫的問題。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-cloud me-2"></i>什麼是 REST API？</h5>
                        
                        <div class="alert alert-primary border-start border-4 border-primary">
                            <h6 class="alert-heading"><i class="fa-solid fa-info-circle me-2"></i>REST API 定義</h6>
                            <p class="mb-0"><strong>REST (Representational State Transfer)</strong> 是一種軟體架構風格，定義了設計網路服務的一組約束條件。REST API 是遵循這些原則設計的應用程式介面。</p>
                        </div>

                        <h6 class="text-dark mt-3 mb-2"><i class="fa-solid fa-list me-2"></i>REST 的六大原則</h6>
                        <div class="table-responsive">
                            <table class="table table-striped table-sm">
                                <thead class="table-dark">
                                    <tr>
                                        <th>原則</th>
                                        <th>說明</th>
                                        <th>範例</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>客戶端-伺服器分離</strong></td>
                                        <td>前端與後端獨立開發</td>
                                        <td>Web Forms 頁面 + Web API 後端</td>
                                    </tr>
                                    <tr>
                                        <td><strong>無狀態 (Stateless)</strong></td>
                                        <td>每個請求包含所有必要資訊</td>
                                        <td>不依賴 Session，使用 Token 驗證</td>
                                    </tr>
                                    <tr>
                                        <td><strong>可快取 (Cacheable)</strong></td>
                                        <td>回應可以被快取以提高效能</td>
                                        <td>靜態資料加上 Cache-Control 標頭</td>
                                    </tr>
                                    <tr>
                                        <td><strong>統一介面</strong></td>
                                        <td>使用標準的 HTTP 方法和狀態碼</td>
                                        <td>GET /users、POST /users</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h6 class="text-dark mt-3 mb-2"><i class="fa-solid fa-route me-2"></i>REST API 的 URL 設計模式</h6>
                        <div class="bg-light p-3 rounded">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-success mb-2">✅ 好的設計</h6>
                                    <ul class="small mb-0">
                                        <li><code>GET /api/users</code> - 取得所有使用者</li>
                                        <li><code>GET /api/users/123</code> - 取得特定使用者</li>
                                        <li><code>POST /api/users</code> - 建立新使用者</li>
                                        <li><code>PUT /api/users/123</code> - 更新使用者</li>
                                        <li><code>DELETE /api/users/123</code> - 刪除使用者</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-danger mb-2">❌ 不好的設計</h6>
                                    <ul class="small mb-0">
                                        <li><code>GET /api/getUsers</code> - 動詞在 URL 中</li>
                                        <li><code>POST /api/user/delete</code> - 錯誤的 HTTP 方法</li>
                                        <li><code>GET /api/users?action=create</code> - 用查詢參數表示動作</li>
                                        <li><code>POST /api/updateUser</code> - 不一致的命名</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <h6 class="text-dark mt-3 mb-2"><i class="fa-solid fa-exchange-alt me-2"></i>REST API vs Web Forms</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0">REST API 特點</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li>資源導向的 URL 設計</li>
                                            <li>使用 HTTP 動詞表達操作</li>
                                            <li>回傳 JSON 或 XML 格式</li>
                                            <li>無狀態，適合行動應用</li>
                                            <li>容易測試和偵錯</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0">Web Forms 特點</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li>頁面導向的設計</li>
                                            <li>主要使用 GET 和 POST</li>
                                            <li>回傳完整的 HTML 頁面</li>
                                            <li>有狀態，使用 ViewState</li>
                                            <li>適合傳統網頁應用</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-success mt-3">
                            <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>學習重點</h6>
                            <ul class="mb-0 small">
                                <li><strong>冪等性</strong>確保操作的安全性和可靠性，是設計穩定系統的重要概念</li>
                                <li><strong>REST API</strong>提供了一套標準化的網路服務設計原則</li>
                                <li>雖然 Web Forms 不是 REST 風格，但了解這些概念有助於設計更好的 Web 應用程式</li>
                                <li>現代 Web 開發趨向於使用 REST API + 前端框架的架構</li>
                            </ul>
                        </div>
                    </div>

                    <div id="http-status" class="mb-4">
                        <h4 class="text-dark">0.3 HTTP 狀態碼</h4>
                        
                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-traffic-light me-2"></i>常見的 HTTP 狀態碼</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0">2xx - 成功</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>200 OK：</strong>請求成功</li>
                                            <li><strong>201 Created：</strong>資源已建立</li>
                                            <li><strong>204 No Content：</strong>成功但無內容</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0">3xx - 重新導向</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>301 Moved Permanently：</strong>永久重新導向</li>
                                            <li><strong>302 Found：</strong>暫時重新導向</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0">4xx - 用戶端錯誤</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>400 Bad Request：</strong>請求格式錯誤</li>
                                            <li><strong>401 Unauthorized：</strong>未授權</li>
                                            <li><strong>404 Not Found：</strong>資源不存在</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="card mb-3">
                                    <div class="card-header bg-danger text-white">
                                        <h6 class="card-title mb-0">5xx - 伺服器錯誤</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>500 Internal Server Error：</strong>伺服器內部錯誤</li>
                                            <li><strong>503 Service Unavailable：</strong>服務暫時無法使用</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="http-headers" class="mb-4">
                        <h4 class="text-dark">0.4 HTTP 標頭與內容類型</h4>
                        
                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-tags me-2"></i>常用的 HTTP 標頭</h5>
                        
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>標頭名稱</th>
                                        <th>用途</th>
                                        <th>範例值</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>Content-Type</code></td>
                                        <td>指定內容類型</td>
                                        <td>text/html, application/json</td>
                                    </tr>
                                    <tr>
                                        <td><code>Content-Length</code></td>
                                        <td>內容長度</td>
                                        <td>1024</td>
                                    </tr>
                                    <tr>
                                        <td><code>User-Agent</code></td>
                                        <td>用戶端資訊</td>
                                        <td>Mozilla/5.0 (Windows NT 10.0)</td>
                                    </tr>
                                    <tr>
                                        <td><code>Accept</code></td>
                                        <td>可接受的內容類型</td>
                                        <td>text/html, application/json</td>
                                    </tr>
                                    <tr>
                                        <td><code>Cookie</code></td>
                                        <td>Cookie 資料</td>
                                        <td>sessionid=abc123</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-file-alt me-2"></i>常見的內容類型 (Content-Type)</h5>
                        <div class="bg-light p-3 rounded">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="small mb-0">
                                        <li><code>text/html</code> - HTML 文件</li>
                                        <li><code>text/css</code> - CSS 樣式表</li>
                                        <li><code>text/javascript</code> - JavaScript</li>
                                        <li><code>application/json</code> - JSON 資料</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="small mb-0">
                                        <li><code>image/jpeg</code> - JPEG 圖片</li>
                                        <li><code>image/png</code> - PNG 圖片</li>
                                        <li><code>application/pdf</code> - PDF 文件</li>
                                        <li><code>multipart/form-data</code> - 表單檔案上傳</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="aspnet-intro" class="py-3">
                    <h2 class="text-primary fw-bold border-bottom pb-2 mb-3"><span class="badge bg-primary me-2">1</span>認識 ASP.NET Web Forms</h2>
                    <div id="aspnet-intro-what" class="mb-4">
                        <h4 class="text-dark">1.1 什麼是 Web Forms？</h4>
                        
                        <div class="alert alert-primary border-start border-4 border-primary">
                            <h5 class="alert-heading"><i class="fa-solid fa-info-circle me-2"></i>ASP.NET Web Forms 簡介</h5>
                            <p class="mb-0">ASP.NET Web Forms 是 Microsoft 提供的網頁應用程式開發框架，讓開發者能以事件驅動的方式建立動態網頁應用程式。</p>
                        </div>

                        <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-puzzle-piece me-2"></i>Web Forms 的核心概念</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-mouse-pointer me-2"></i>事件驅動模型</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">類似桌面應用程式的開發方式</p>
                                        <ul class="small mb-0">
                                            <li>按鈕點擊事件</li>
                                            <li>頁面載入事件</li>
                                            <li>控制項值改變事件</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-eye me-2"></i>視覺化設計</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">提供拖拉式的設計介面</p>
                                        <ul class="small mb-0">
                                            <li>豐富的伺服器控制項</li>
                                            <li>視覺化佈局設計</li>
                                            <li>屬性視窗設定</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>Web Forms 的架構組成</h5>
                        
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-primary">
                                    <tr>
                                        <th>組件</th>
                                        <th>檔案副檔名</th>
                                        <th>用途</th>
                                        <th>範例</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>頁面檔案</strong></td>
                                        <td>.aspx</td>
                                        <td>定義使用者介面</td>
                                        <td>Default.aspx</td>
                                    </tr>
                                    <tr>
                                        <td><strong>程式碼檔案</strong></td>
                                        <td>.aspx.cs</td>
                                        <td>處理事件邏輯</td>
                                        <td>Default.aspx.cs</td>
                                    </tr>
                                    <tr>
                                        <td><strong>主版頁面</strong></td>
                                        <td>.master</td>
                                        <td>統一版面配置</td>
                                        <td>Site.master</td>
                                    </tr>
                                    <tr>
                                        <td><strong>使用者控制項</strong></td>
                                        <td>.ascx</td>
                                        <td>可重用的控制項</td>
                                        <td>Header.ascx</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>簡單的 Web Forms 範例</h5>
                        
                        <div class="bg-light p-3 rounded">
                            <h6 class="mb-2">Default.aspx (頁面設計)</h6>
                            <pre class="mb-3"><code>&lt;%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="MyApp.Default" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head runat="server"&gt;
    &lt;title&gt;我的第一個 Web Forms 頁面&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;h1&gt;歡迎使用 ASP.NET Web Forms&lt;/h1&gt;
        &lt;asp:Label ID="lblMessage" runat="server" Text="請點擊下方按鈕" /&gt;
        &lt;br /&gt;&lt;br /&gt;
        &lt;asp:Button ID="btnHello" runat="server" Text="說哈囉" OnClick="btnHello_Click" /&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                            <h6 class="mb-2">Default.aspx.cs (程式邏輯)</h6>
                            <pre class="mb-0"><code>using System;
using System.Web.UI;

namespace MyApp
{
    public partial class Default : Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            // 頁面載入時執行
            if (!IsPostBack)
            {
                lblMessage.Text = "頁面首次載入完成";
            }
        }

        protected void btnHello_Click(object sender, EventArgs e)
        {
            // 按鈕點擊事件
            lblMessage.Text = "哈囉！現在時間是：" + DateTime.Now.ToString();
        }
    }
}</code></pre>
                        </div>

                        <div class="alert alert-success mt-4">
                            <h6 class="alert-heading"><i class="fa-solid fa-check-circle me-2"></i>Web Forms 的優點</h6>
                            <ul class="mb-0 small">
                                <li><strong>快速開發：</strong>RAD (Rapid Application Development) 開發模式</li>
                                <li><strong>事件導向：</strong>類似 WinForms 的開發體驗</li>
                                <li><strong>豐富控制項：</strong>內建大量的伺服器控制項</li>
                                <li><strong>狀態管理：</strong>自動處理頁面狀態（ViewState）</li>
                                <li><strong>IDE 支援：</strong>Visual Studio 完整的設計時支援</li>
                            </ul>
                        </div>
                    </div>
                    <div id="aspnet-intro-diff" class="mb-4">
                    <h4 class="text-dark">1.2 與 ASP.NET MVC 和 ASP.NET Core MVC 的差異</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-balance-scale me-2"></i>三種不同的開發模式</h5>
                        <p class="mb-0">ASP.NET Web Forms、ASP.NET MVC 和 ASP.NET Core MVC 是三種不同的網頁開發架構，代表了 Microsoft Web 技術的演進歷程。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-timeline me-2"></i>技術演進歷程</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-primary text-white text-center">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-calendar me-2"></i>2002年</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h5 class="text-primary">ASP.NET Web Forms</h5>
                                    <p class="small">第一代 ASP.NET 框架<br/>事件驅動模式<br/>類似 Windows Forms</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white text-center">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-calendar me-2"></i>2009年</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h5 class="text-success">ASP.NET MVC</h5>
                                    <p class="small">基於 .NET Framework<br/>MVC 架構模式<br/>更好的可測試性</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-danger text-white text-center">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-calendar me-2"></i>2016年</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h5 class="text-danger">ASP.NET Core MVC</h5>
                                    <p class="small">跨平台框架<br/>高性能架構<br/>雲端原生設計</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-table me-2"></i>核心差異比較</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-warning">
                                <tr>
                                    <th>特性</th>
                                    <th>Web Forms</th>
                                    <th>ASP.NET MVC</th>
                                    <th>ASP.NET Core MVC</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>架構模式</strong></td>
                                    <td>事件驅動 (Event-Driven)</td>
                                    <td>模型-視圖-控制器 (MVC)</td>
                                    <td>模型-視圖-控制器 (MVC)</td>
                                </tr>
                                <tr>
                                    <td><strong>平台支援</strong></td>
                                    <td>Windows + IIS</td>
                                    <td>Windows + IIS</td>
                                    <td>跨平台 (Windows/Linux/macOS)</td>
                                </tr>
                                <tr>
                                    <td><strong>運行時</strong></td>
                                    <td>.NET Framework</td>
                                    <td>.NET Framework</td>
                                    <td>.NET Core / .NET 5+</td>
                                </tr>
                                <tr>
                                    <td><strong>URL 結構</strong></td>
                                    <td>/Default.aspx</td>
                                    <td>/Home/Index</td>
                                    <td>/Home/Index</td>
                                </tr>
                                <tr>
                                    <td><strong>狀態管理</strong></td>
                                    <td>有狀態 (ViewState)</td>
                                    <td>無狀態 (Stateless)</td>
                                    <td>無狀態 (Stateless)</td>
                                </tr>
                                <tr>
                                    <td><strong>測試性</strong></td>
                                    <td>較難進行單元測試</td>
                                    <td>容易進行單元測試</td>
                                    <td>優秀的單元測試支援</td>
                                </tr>
                                <tr>
                                    <td><strong>HTML 控制</strong></td>
                                    <td>較少控制權</td>
                                    <td>完全控制 HTML 輸出</td>
                                    <td>完全控制 HTML 輸出</td>
                                </tr>
                                <tr>
                                    <td><strong>性能</strong></td>
                                    <td>中等（ViewState 開銷）</td>
                                    <td>良好</td>
                                    <td>優秀（高性能設計）</td>
                                </tr>
                                <tr>
                                    <td><strong>開發速度</strong></td>
                                    <td>快速</td>
                                    <td>中等</td>
                                    <td>中等至快速</td>
                                </tr>
                                <tr>
                                    <td><strong>學習曲線</strong></td>
                                    <td>較平緩（類似桌面開發）</td>
                                    <td>較陡峭（需了解 MVC）</td>
                                    <td>中等（豐富的文檔和工具）</td>
                                </tr>
                                <tr>
                                    <td><strong>生命週期狀態</strong></td>
                                    <td>維護模式</td>
                                    <td>維護模式</td>
                                    <td>積極開發</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code-branch me-2"></i>架構模式詳細對比</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0">Web Forms 架構</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        <div class="bg-light p-2 rounded mb-2">
                                            <strong>頁面 (.aspx)</strong>
                                        </div>
                                        <div class="text-muted">↕</div>
                                        <div class="bg-light p-2 rounded">
                                            <strong>程式碼 (.aspx.cs)</strong>
                                        </div>
                                    </div>
                                    <ul class="small mb-0">
                                        <li>頁面和邏輯緊密結合</li>
                                        <li>事件處理在 Code-Behind</li>
                                        <li>PostBack 機制</li>
                                        <li>伺服器控制項</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">ASP.NET MVC 架構</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>Model</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>View</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded">
                                            <strong>Controller</strong>
                                        </div>
                                    </div>
                                    <ul class="small mb-0">
                                        <li>關注點分離</li>
                                        <li>路由導向</li>
                                        <li>RESTful 設計</li>
                                        <li>Razor 視圖引擎</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="card-title mb-0">ASP.NET Core MVC 架構</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>Model</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>View</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>Controller</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded">
                                            <strong>Middleware</strong>
                                        </div>
                                    </div>
                                    <ul class="small mb-0">
                                        <li>模組化架構</li>
                                        <li>中間件管道</li>
                                        <li>依賴注入內建</li>
                                        <li>統一的 Web API</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-lightbulb me-2"></i>選擇建議</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3 border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">適合使用 Web Forms</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>快速開發原型或內部系統</li>
                                        <li>團隊有 WinForms 開發經驗</li>
                                        <li>維護現有的 Web Forms 應用</li>
                                        <li>重點在商業邏輯而非使用者介面</li>
                                        <li>傳統企業應用程式</li>
                                        <li>學習 ASP.NET 的入門</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3 border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">適合使用 ASP.NET MVC</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>維護現有的 MVC 應用</li>
                                        <li>需要完全控制 HTML 輸出</li>
                                        <li>重視單元測試</li>
                                        <li>與前端框架整合</li>
                                        <li>Windows 環境限制</li>
                                        <li>不想遷移到 Core</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3 border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="card-title mb-0">適合使用 ASP.NET Core MVC</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>新專案開發（強烈推薦）</li>
                                        <li>跨平台部署需求</li>
                                        <li>高性能要求</li>
                                        <li>雲端原生應用</li>
                                        <li>微服務架構</li>
                                        <li>容器化部署</li>
                                        <li>現代化 Web 應用程式</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>程式碼風格對比</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Web Forms 處理表單提交</h6>
                        <pre class="mb-3"><code>// Default.aspx.cs
protected void btnSubmit_Click(object sender, EventArgs e)
{
    string name = txtName.Text;
    string email = txtEmail.Text;
    
    // 處理資料
    SaveUser(name, email);
    
    lblMessage.Text = "儲存成功！";
}</code></pre>
                        
                        <h6 class="mb-2">ASP.NET MVC 處理表單提交</h6>
                        <pre class="mb-3"><code>// HomeController.cs
[HttpPost]
public ActionResult Create(UserModel model)
{
    if (ModelState.IsValid)
    {
        // 處理資料
        SaveUser(model.Name, model.Email);
        
        ViewBag.Message = "儲存成功！";
        return View(model);
    }
    
    return View(model);
}</code></pre>
                        
                        <h6 class="mb-2">ASP.NET Core MVC 處理表單提交</h6>
                        <pre class="mb-0"><code>// HomeController.cs
[HttpPost]
public async Task&lt;IActionResult&gt; Create(UserModel model)
{
    if (ModelState.IsValid)
    {
        // 處理資料（非同步）
        await _userService.SaveUserAsync(model.Name, model.Email);
        
        TempData["Message"] = "儲存成功！";
        return RedirectToAction(nameof(Index));
    }
    
    return View(model);
}</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-info-circle me-2"></i>遷移路徑建議</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>從 Web Forms 遷移：</strong></p>
                                <ul class="small mb-0">
                                    <li>先學習 MVC 概念和 Razor 語法</li>
                                    <li>逐步重寫核心功能</li>
                                    <li>考慮直接遷移到 ASP.NET Core</li>
                                    <li>利用 .NET Upgrade Assistant</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>從 ASP.NET MVC 遷移：</strong></p>
                                <ul class="small mb-0">
                                    <li>使用 .NET Upgrade Assistant</li>
                                    <li>更新依賴項目和套件</li>
                                    <li>調整 Startup 和設定</li>
                                    <li>測試和效能優化</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-star me-2"></i>學習重點</h6>
                        <ul class="mb-0 small">
                            <li><strong>Web Forms</strong> 適合學習 Web 開發基礎概念</li>
                            <li><strong>ASP.NET MVC</strong> 引入了現代 Web 開發模式</li>
                            <li><strong>ASP.NET Core MVC</strong> 是目前和未來的主流選擇</li>
                            <li>理解三者差異有助於做出明智的技術決策</li>
                            <li>新專案強烈建議使用 ASP.NET Core MVC</li>
                        </ul>
                    </div>
                </div>

                <div id="aspnet-intro-http" class="mb-4">
                    <h4 class="text-dark">1.3 Web Forms 如何處理 HTTP 請求</h4>
                    
                    <div class="alert alert-primary border-start border-4 border-primary">
                        <h5 class="alert-heading"><i class="fa-solid fa-exchange-alt me-2"></i>Web Forms 的 HTTP 請求處理機制</h5>
                        <p class="mb-0">ASP.NET Web Forms 提供了一套完整的機制來處理 HTTP 請求，將複雜的 HTTP 協議抽象化為事件驅動的程式設計模型。</p>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-flow-chart me-2"></i>HTTP 請求的生命週期</h5>
                    
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card mb-4">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-route me-2"></i>完整的請求處理流程</h6>
                                </div>
                                <div class="card-body">
                                    <div class="bg-light p-3 rounded">
                                        <div class="row text-center">
                                            <div class="col-md-2">
                                                <div class="bg-primary text-white p-2 rounded mb-2">
                                                    <i class="fa-solid fa-globe fa-2x"></i>
                                                </div>
                                                <strong>1. 瀏覽器</strong>
                                                <p class="small">發送 HTTP 請求</p>
                                            </div>
                                            <div class="col-md-1 d-flex align-items-center justify-content-center">
                                                <i class="fa-solid fa-arrow-right fa-2x text-primary"></i>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="bg-success text-white p-2 rounded mb-2">
                                                    <i class="fa-solid fa-server fa-2x"></i>
                                                </div>
                                                <strong>2. IIS</strong>
                                                <p class="small">接收並路由請求</p>
                                            </div>
                                            <div class="col-md-1 d-flex align-items-center justify-content-center">
                                                <i class="fa-solid fa-arrow-right fa-2x text-success"></i>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="bg-warning text-dark p-2 rounded mb-2">
                                                    <i class="fa-solid fa-cogs fa-2x"></i>
                                                </div>
                                                <strong>3. ASP.NET Runtime</strong>
                                                <p class="small">編譯和執行頁面</p>
                                            </div>
                                            <div class="col-md-1 d-flex align-items-center justify-content-center">
                                                <i class="fa-solid fa-arrow-right fa-2x text-warning"></i>
                                            </div>
                                            <div class="col-md-2">
                                                <div class="bg-danger text-white p-2 rounded mb-2">
                                                    <i class="fa-solid fa-file-code fa-2x"></i>
                                                </div>
                                                <strong>4. .aspx 頁面</strong>
                                                <p class="small">執行頁面邏輯</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-list-ol me-2"></i>詳細處理步驟</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">步驟 1-2：請求接收與路由</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li><strong>瀏覽器發送請求</strong>
                                            <ul class="small mt-1">
                                                <li>使用者在瀏覽器輸入 URL 或點擊連結</li>
                                                <li>瀏覽器建立 HTTP 請求並發送到伺服器</li>
                                                <li>包含請求方法（GET/POST）、URL、標頭等</li>
                                            </ul>
                                        </li>
                                        <li><strong>IIS 接收請求</strong>
                                            <ul class="small mt-1">
                                                <li>IIS 根據 URL 判斷要處理的應用程式</li>
                                                <li>檢查檔案副檔名（.aspx）</li>
                                                <li>將請求轉交給 ASP.NET Runtime</li>
                                            </ul>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">步驟 3-4：編譯與執行</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0" start="3">
                                        <li><strong>ASP.NET Runtime 處理</strong>
                                            <ul class="small mt-1">
                                                <li>檢查頁面是否已編譯</li>
                                                <li>如未編譯，將 .aspx 轉換為 C# 類別</li>
                                                <li>編譯成 .NET 組件並載入到記憶體</li>
                                            </ul>
                                        </li>
                                        <li><strong>頁面執行與回應</strong>
                                            <ul class="small mt-1">
                                                <li>建立頁面實例並執行頁面生命週期</li>
                                                <li>處理控制項事件和程式邏輯</li>
                                                <li>產生 HTML 並傳回給瀏覽器</li>
                                            </ul>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-globe me-2"></i>與傳統 HTML 表單的比較</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">Web Forms 的優勢</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>事件驅動：</strong>可處理伺服器端事件</li>
                                        <li><strong>狀態管理：</strong>自動保持控制項狀態</li>
                                        <li><strong>豐富控制項：</strong>內建驗證、資料繫結等功能</li>
                                        <li><strong>開發效率：</strong>類似桌面應用程式開發</li>
                                        <li><strong>抽象化：</strong>隱藏 HTTP 協議的複雜性</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0">傳統 HTML 表單</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>簡單直接：</strong>直接使用 HTTP GET/POST</li>
                                        <li><strong>輕量級：</strong>沒有額外的 ViewState 開銷</li>
                                        <li><strong>完全控制：</strong>開發者控制所有 HTML 輸出</li>
                                        <li><strong>RESTful：</strong>容易實作 REST API 風格</li>
                                        <li><strong>前端友善：</strong>容易與 JavaScript 框架整合</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-key me-2"></i>Web Forms HTTP 處理重點整理</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>核心概念：</strong></p>
                                <ul class="small mb-0">
                                    <li>Web Forms 將 HTTP 協議包裝成事件驅動模型</li>
                                    <li>透過 ViewState 在無狀態協議上實現狀態管理</li>
                                    <li>PostBack 機制處理伺服器端事件</li>
                                    <li>Page Life Cycle 提供完整的請求處理流程</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>開發要點：</strong></p>
                                <ul class="small mb-0">
                                    <li>理解 IsPostBack 屬性的重要性</li>
                                    <li>適當使用 Page_Load 和控制項事件</li>
                                    <li>注意 ViewState 對效能的影響</li>
                                    <li>善用 HTTP 請求物件取得客戶端資訊</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                
                </section>

                <section id="aspnet-env" class="py-3">
                    <h2 class="text-success fw-bold border-bottom pb-2 mb-3"><span class="badge bg-success me-2">2</span>開發環境安裝與設定</h2>
                    
                    <div id="aspnet-env-vs" class="mb-4">
                        <h4 class="text-dark">2.1 安裝 Visual Studio</h4>
                        
                        <div class="alert alert-success border-start border-4 border-success">
                            <h5 class="alert-heading"><i class="fa-solid fa-download me-2"></i>開發環境準備</h5>
                            <p class="mb-0">ASP.NET Web Forms 開發需要安裝 Visual Studio 和相關的開發工具。我們將逐步引導您完成整個安裝過程。</p>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-laptop-code me-2"></i>Visual Studio 版本選擇</h5>
                        
                        <div class="row">
                            <div class="col-md-4">
                                <div class="card mb-3 border-primary">
                                    <div class="card-header bg-primary text-white text-center">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-gift me-2"></i>Community</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small text-center"><strong>免費版本</strong></p>
                                        <ul class="small mb-3">
                                            <li>功能完整的 IDE</li>
                                            <li>支援 Web Forms 開發</li>
                                            <li>內建偵錯工具</li>
                                            <li>IntelliSense 程式碼提示</li>
                                            <li>Git 版本控制</li>
                                        </ul>
                                        <p class="card-text small"><strong>適合：</strong>個人開發者、學生、小型團隊</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="card mb-3 border-warning">
                                    <div class="card-header bg-warning text-dark text-center">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-briefcase me-2"></i>Professional</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small text-center"><strong>付費版本</strong></p>
                                        <ul class="small mb-3">
                                            <li>包含 Community 所有功能</li>
                                            <li>進階偵錯和診斷工具</li>
                                            <li>程式碼分析工具</li>
                                            <li>測試工具</li>
                                            <li>Azure DevOps 整合</li>
                                        </ul>
                                        <p class="card-text small"><strong>適合：</strong>專業開發者、中型企業</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-4">
                                <div class="card mb-3 border-danger">
                                    <div class="card-header bg-danger text-white text-center">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-building me-2"></i>Enterprise</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small text-center"><strong>企業版本</strong></p>
                                        <ul class="small mb-3">
                                            <li>包含 Professional 所有功能</li>
                                            <li>進階架構和建模工具</li>
                                            <li>Live Unit Testing</li>
                                            <li>IntelliTrace</li>
                                            <li>程式碼覆蓋率分析</li>
                                        </ul>
                                        <p class="card-text small"><strong>適合：</strong>大型企業、複雜專案</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-info">
                            <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>建議</h6>
                            <p class="mb-0">對於學習 ASP.NET Web Forms，<strong>Visual Studio Community</strong> 已經足夠使用，功能完整且完全免費。</p>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-cog me-2"></i>系統需求</h5>
                        
                        <div class="card mb-4">
                            <div class="card-header bg-success text-white">
                                <h6 class="card-title mb-0"><i class="fa-solid fa-desktop me-2"></i>Visual Studio 2022 系統需求</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-success mb-2">最低需求</h6>
                                        <ul class="small mb-3">
                                            <li><strong>作業系統：</strong>Windows 10 1909 版或更新版本</li>
                                            <li><strong>處理器：</strong>1.8 GHz 或更快的 64 位元處理器</li>
                                            <li><strong>記憶體：</strong>4 GB RAM</li>
                                            <li><strong>硬碟空間：</strong>最少 850 MB</li>
                                            <li><strong>顯示器：</strong>1366 x 768 解析度</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-success mb-2">建議配置</h6>
                                        <ul class="small mb-3">
                                            <li><strong>作業系統：</strong>Windows 11 或 Windows 10 21H2</li>
                                            <li><strong>處理器：</strong>四核心 2.6 GHz 或更快</li>
                                            <li><strong>記憶體：</strong>16 GB RAM 或更多</li>
                                            <li><strong>硬碟空間：</strong>至少 50 GB 可用空間</li>
                                            <li><strong>顯示器：</strong>1920 x 1080 或更高解析度</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-download me-2"></i>下載與安裝步驟</h5>
                        
                        <div class="card mb-4">
                            <div class="card-header bg-info text-white">
                                <h6 class="card-title mb-0"><i class="fa-solid fa-step-forward me-2"></i>詳細安裝流程</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-info mb-3">步驟 1-3：下載與啟動安裝</h6>
                                        <ol class="small mb-4">
                                            <li><strong>前往官方網站</strong>
                                                <ul class="small mt-1">
                                                    <li>開啟瀏覽器訪問 <a href="https://visualstudio.microsoft.com/" target="_blank" class="text-decoration-none">visualstudio.microsoft.com</a></li>
                                                    <li>點擊「下載 Visual Studio」</li>
                                                    <li>選擇「Community 2022」（免費版）</li>
                                                </ul>
                                            </li>
                                            <li><strong>下載安裝程式</strong>
                                                <ul class="small mt-1">
                                                    <li>檔案名稱：vs_community.exe</li>
                                                    <li>檔案大小：約 3-4 MB（啟動器）</li>
                                                    <li>儲存到容易找到的位置</li>
                                                </ul>
                                            </li>
                                            <li><strong>執行安裝程式</strong>
                                                <ul class="small mt-1">
                                                    <li>以系統管理員身分執行</li>
                                                    <li>允許程式進行變更</li>
                                                    <li>等待 Visual Studio Installer 啟動</li>
                                                </ul>
                                            </li>
                                        </ol>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <h6 class="text-info mb-3">步驟 4-6：選擇工作負載</h6>
                                        <ol class="small mb-4" start="4">
                                            <li><strong>選擇工作負載</strong>
                                                <ul class="small mt-1">
                                                    <li>勾選「ASP.NET 和 Web 開發」</li>
                                                    <li>可選擇「.NET 桌面開發」（建議）</li>
                                                    <li>確認安裝位置有足夠空間</li>
                                                </ul>
                                            </li>
                                            <li><strong>個別元件（可選）</strong>
                                                <ul class="small mt-1">
                                                    <li>Git for Windows</li>
                                                    <li>SQL Server Express LocalDB</li>
                                                    <li>IIS Express</li>
                                                </ul>
                                            </li>
                                            <li><strong>開始安裝</strong>
                                                <ul class="small mt-1">
                                                    <li>點擊「安裝」按鈕</li>
                                                    <li>等待下載和安裝完成</li>
                                                    <li>過程可能需要 30-60 分鐘</li>
                                                </ul>
                                            </li>
                                        </ol>
                                    </div>
                                </div>
                                
                                <div class="bg-light p-3 rounded">
                                    <h6 class="mb-2"><i class="fa-solid fa-tools me-2"></i>推薦的工作負載配置</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p class="small mb-2"><strong>✅ 必要項目：</strong></p>
                                            <ul class="small mb-0">
                                                <li>ASP.NET 和 Web 開發</li>
                                                <li>.NET Framework 4.8 開發工具</li>
                                                <li>IIS Express</li>
                                                <li>SQL Server Express LocalDB</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <p class="small mb-2"><strong>🔶 建議項目：</strong></p>
                                            <ul class="small mb-0">
                                                <li>.NET 桌面開發</li>
                                                <li>Git for Windows</li>
                                                <li>GitHub Extension for Visual Studio</li>
                                                <li>Web 效能和負載測試工具</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-check-circle me-2"></i>安裝後驗證</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-play me-2"></i>首次啟動</h6>
                                    </div>
                                    <div class="card-body">
                                        <ol class="small mb-0">
                                            <li>啟動 Visual Studio 2022</li>
                                            <li>選擇開發設定（建議選擇「一般」）</li>
                                            <li>登入 Microsoft 帳戶（可略過）</li>
                                            <li>選擇佈景主題（深色/淺色）</li>
                                            <li>點擊「啟動 Visual Studio」</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-vial me-2"></i>功能測試</h6>
                                    </div>
                                    <div class="card-body">
                                        <ol class="small mb-0">
                                            <li>檢查「檔案」→「新增」→「專案」選單</li>
                                            <li>確認可看到「ASP.NET Web 應用程式」範本</li>
                                            <li>檢查「工具」→「選項」設定頁面</li>
                                            <li>確認「檢視」→「伺服器總管」可開啟</li>
                                            <li>測試 IntelliSense 程式碼提示功能</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-warning">
                            <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>常見安裝問題</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="small mb-2"><strong>問題與解決方案：</strong></p>
                                    <ul class="small mb-0">
                                        <li><strong>安裝失敗：</strong>檢查網路連線，清理暫存檔案</li>
                                        <li><strong>空間不足：</strong>清理磁碟空間，選擇其他安裝位置</li>
                                        <li><strong>權限問題：</strong>以系統管理員身分執行</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="small mb-2"><strong>實用指令：</strong></p>
                                    <ul class="small mb-0">
                                        <li><strong>清理安裝：</strong>使用 Visual Studio Installer 修復</li>
                                        <li><strong>離線安裝：</strong>下載完整安裝套件</li>
                                        <li><strong>更新檢查：</strong>定期透過 Installer 更新</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="aspnet-env-project" class="mb-4">
                        <h4 class="text-dark">2.2 建立第一個 Web Forms 專案</h4>
                        
                        <div class="alert alert-success border-start border-4 border-success">
                            <h5 class="alert-heading"><i class="fa-solid fa-rocket me-2"></i>建立您的第一個專案</h5>
                            <p class="mb-0">現在我們將使用 Visual Studio 建立第一個 ASP.NET Web Forms 專案，並了解專案的基本結構和執行方式。</p>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-plus-circle me-2"></i>建立新專案步驟</h5>
                        
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h6 class="card-title mb-0"><i class="fa-solid fa-step-forward me-2"></i>詳細建立流程</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-primary mb-3">步驟 1-3：專案建立</h6>
                                        <ol class="small mb-4">
                                            <li><strong>開啟 Visual Studio</strong>
                                                <ul class="small mt-1">
                                                    <li>啟動 Visual Studio 2022</li>
                                                    <li>點擊「建立新專案」</li>
                                                    <li>或使用快速鍵 Ctrl+Shift+N</li>
                                                </ul>
                                            </li>
                                            <li><strong>選擇專案範本</strong>
                                                <ul class="small mt-1">
                                                    <li>搜尋「ASP.NET Web」</li>
                                                    <li>選擇「ASP.NET Web 應用程式 (.NET Framework)」</li>
                                                    <li>確認語言為「C#」</li>
                                                    <li>點擊「下一步」</li>
                                                </ul>
                                            </li>
                                            <li><strong>設定專案資訊</strong>
                                                <ul class="small mt-1">
                                                    <li>專案名稱：MyFirstWebApp</li>
                                                    <li>位置：選擇適合的資料夾</li>
                                                    <li>方案名稱：MyFirstWebApp</li>
                                                    <li>點擊「建立」</li>
                                                </ul>
                                            </li>
                                        </ol>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <h6 class="text-primary mb-3">步驟 4-6：範本選擇</h6>
                                        <ol class="small mb-4" start="4">
                                            <li><strong>選擇 Web Forms 範本</strong>
                                                <ul class="small mt-1">
                                                    <li>選擇「Web Forms」範本</li>
                                                    <li>不要選擇「Empty」或「MVC」</li>
                                                    <li>確認 .NET Framework 版本（建議 4.8）</li>
                                                </ul>
                                            </li>
                                            <li><strong>進階設定</strong>
                                                <ul class="small mt-1">
                                                    <li>驗證：無驗證（暫時）</li>
                                                    <li>HTTPS 設定：勾選（建議）</li>
                                                    <li>Docker 支援：不勾選</li>
                                                </ul>
                                            </li>
                                            <li><strong>完成建立</strong>
                                                <ul class="small mt-1">
                                                    <li>點擊「建立」按鈕</li>
                                                    <li>等待專案建立完成</li>
                                                    <li>Visual Studio 自動開啟專案</li>
                                                </ul>
                                            </li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-folder-open me-2"></i>專案結構初探</h5>
                        
                        <div class="card mb-4">
                            <div class="card-header bg-info text-white">
                                <h6 class="card-title mb-0"><i class="fa-solid fa-sitemap me-2"></i>預設專案結構</h6>
                            </div>
                            <div class="card-body">
                                <div class="bg-light p-3 rounded mb-3">
                                    <pre class="mb-0 small"><code>📁 MyFirstWebApp
├─ 📁 App_Data                    <span class="text-muted">// 應用程式資料檔案</span>
├─ 📁 App_Start                   <span class="text-muted">// 啟動設定檔案</span>
│   ├─ 📄 BundleConfig.cs         <span class="text-muted">// CSS/JS 打包設定</span>
│   ├─ 📄 FilterConfig.cs         <span class="text-muted">// 全域篩選器設定</span>
│   └─ 📄 RouteConfig.cs          <span class="text-muted">// 路由設定</span>
├─ 📁 Content                     <span class="text-muted">// 靜態資源</span>
│   ├─ 📄 bootstrap.css           <span class="text-muted">// Bootstrap 樣式框架</span>
│   └─ 📄 Site.css                <span class="text-muted">// 網站自訂樣式</span>
├─ 📁 Scripts                     <span class="text-muted">// JavaScript 檔案</span>
│   ├─ 📄 bootstrap.js            <span class="text-muted">// Bootstrap JavaScript</span>
│   ├─ 📄 jquery-3.4.1.js         <span class="text-muted">// jQuery 函式庫</span>
│   └─ 📄 modernizr-2.8.3.js      <span class="text-muted">// 瀏覽器功能檢測</span>
├─ 📝 About.aspx                  <span class="text-muted">// 關於我們頁面</span>
├─ 📝 Contact.aspx                <span class="text-muted">// 聯絡我們頁面</span>
├─ 📝 Default.aspx                <span class="text-muted">// 網站首頁</span>
├─ 📝 Global.asax                 <span class="text-muted">// 全域應用程式檔案</span>
├─ 📝 Site.Master                 <span class="text-muted">// 主版頁面</span>
├─ 📝 ViewSwitcher.ascx           <span class="text-muted">// 檢視切換控制項</span>
└─ 📝 Web.config                  <span class="text-muted">// 組態設定檔</span></code></pre>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <h6 class="text-info mb-2">重要檔案說明</h6>
                                        <ul class="small mb-0">
                                            <li><strong>Default.aspx：</strong>網站的預設首頁</li>
                                            <li><strong>Site.Master：</strong>定義統一的版面配置</li>
                                            <li><strong>Web.config：</strong>應用程式組態設定</li>
                                            <li><strong>Global.asax：</strong>全域事件處理</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6 class="text-info mb-2">資源資料夾</h6>
                                        <ul class="small mb-0">
                                            <li><strong>Content：</strong>CSS 樣式檔案</li>
                                            <li><strong>Scripts：</strong>JavaScript 檔案</li>
                                            <li><strong>App_Data：</strong>資料庫和資料檔案</li>
                                            <li><strong>App_Start：</strong>應用程式啟動設定</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-play me-2"></i>執行與測試專案</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-rocket me-2"></i>啟動偵錯</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="small mb-2"><strong>執行方式：</strong></p>
                                        <ul class="small mb-3">
                                            <li>按 F5 鍵（偵錯模式）</li>
                                            <li>按 Ctrl+F5（不偵錯執行）</li>
                                            <li>點擊工具列的「▶ IIS Express」按鈕</li>
                                            <li>選單：偵錯 → 開始偵錯</li>
                                        </ul>
                                        <p class="small mb-0"><strong>建議：</strong>初學者使用 F5 進行偵錯執行</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-globe me-2"></i>瀏覽器測試</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="small mb-2"><strong>預期結果：</strong></p>
                                        <ul class="small mb-3">
                                            <li>瀏覽器自動開啟</li>
                                            <li>顯示預設的 Web Forms 首頁</li>
                                            <li>可看到 Bootstrap 樣式的導航列</li>
                                            <li>包含首頁、關於、聯絡等連結</li>
                                        </ul>
                                        <p class="small mb-0"><strong>URL 格式：</strong>https://localhost:44xxx/</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-edit me-2"></i>第一次修改</h5>
                        
                        <div class="card mb-4">
                            <div class="card-header bg-primary text-white">
                                <h6 class="card-title mb-0"><i class="fa-solid fa-code me-2"></i>修改首頁內容</h6>
                            </div>
                            <div class="card-body">
                                <p class="small mb-3">讓我們來修改 Default.aspx 首頁，加入自己的內容：</p>
                                
                                <h6 class="mb-2">1. 開啟 Default.aspx</h6>
                                <div class="bg-light p-3 rounded mb-3">
                                    <p class="small mb-2">在方案總管中雙擊 Default.aspx，將會看到類似以下的程式碼：</p>
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-0 small"><code>&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="jumbotron"&gt;
        &lt;h1&gt;ASP.NET&lt;/h1&gt;
        &lt;p class="lead"&gt;ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS and JavaScript.&lt;/p&gt;
        &lt;p&gt;&lt;a href="http://www.asp.net" class="btn btn-primary btn-lg"&gt;Learn more &raquo;&lt;/a&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>
                                    </div>
                                </div>
                                
                                <h6 class="mb-2">2. 修改為自訂內容</h6>
                                <div class="bg-light p-3 rounded mb-3">
                                    <p class="small mb-2">將內容修改為：</p>
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-0 small"><code>&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="jumbotron"&gt;
        &lt;h1&gt;歡迎來到我的第一個 Web Forms 網站！&lt;/h1&gt;
        &lt;p class="lead"&gt;這是我使用 ASP.NET Web Forms 建立的第一個網站。&lt;/p&gt;
        &lt;p&gt;今天是：&lt;asp:Label ID="lblDate" runat="server"&gt;&lt;/asp:Label&gt;&lt;/p&gt;
        &lt;p&gt;&lt;asp:Button ID="btnHello" runat="server" Text="點我打招呼" CssClass="btn btn-primary btn-lg" OnClick="btnHello_Click" /&gt;&lt;/p&gt;
        &lt;p&gt;&lt;asp:Label ID="lblMessage" runat="server" CssClass="text-success h4"&gt;&lt;/asp:Label&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>
                                    </div>
                                </div>

                                <h6 class="mb-2">3. 加入程式邏輯</h6>
                                <div class="bg-light p-3 rounded mb-3">
                                    <p class="small mb-2">開啟 Default.aspx.cs（按 F7 或右鍵選擇「檢視程式碼」），在 Page_Load 方法中加入：</p>
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-0 small"><code>protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        lblDate.Text = DateTime.Now.ToString("yyyy年MM月dd日 HH:mm:ss");
    }
}

protected void btnHello_Click(object sender, EventArgs e)
{
    lblMessage.Text = "哈囉！歡迎學習 ASP.NET Web Forms！";
}</code></pre>
                                    </div>
                                </div>

                                <h6 class="mb-2">4. 測試修改結果</h6>
                                <ul class="small mb-0">
                                    <li>按 Ctrl+S 儲存檔案</li>
                                    <li>按 F5 執行專案</li>
                                    <li>觀察頁面顯示目前時間</li>
                                    <li>點擊按鈕測試互動功能</li>
                                </ul>
                            </div>
                        </div>

                        <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-tools me-2"></i>開發工具介紹</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-window-maximize me-2"></i>重要視窗</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>方案總管：</strong>管理專案檔案結構</li>
                                            <li><strong>屬性視窗：</strong>設定控制項屬性</li>
                                            <li><strong>工具箱：</strong>拖放控制項到頁面</li>
                                            <li><strong>錯誤清單：</strong>顯示編譯錯誤和警告</li>
                                            <li><strong>輸出視窗：</strong>顯示建置和偵錯資訊</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-keyboard me-2"></i>實用快速鍵</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>F5：</strong>開始偵錯</li>
                                            <li><strong>Ctrl+F5：</strong>執行但不偵錯</li>
                                            <li><strong>F7：</strong>檢視程式碼</li>
                                            <li><strong>Shift+F7：</strong>檢視設計工具</li>
                                            <li><strong>Ctrl+K+C：</strong>註解程式碼</li>
                                            <li><strong>Ctrl+K+U：</strong>取消註解</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-success mt-4">
                            <h6 class="alert-heading"><i class="fa-solid fa-check-circle me-2"></i>完成第一個專案！</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="small mb-2"><strong>您已經學會：</strong></p>
                                    <ul class="small mb-0">
                                        <li>安裝 Visual Studio 開發環境</li>
                                        <li>建立新的 Web Forms 專案</li>
                                        <li>了解基本的專案結構</li>
                                        <li>修改頁面內容和程式邏輯</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="small mb-2"><strong>下一步學習：</strong></p>
                                    <ul class="small mb-0">
                                        <li>深入了解專案結構和檔案用途</li>
                                        <li>學習更多伺服器控制項</li>
                                        <li>掌握頁面生命週期</li>
                                        <li>實作資料繫結功能</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <div id="aspnet-structure" class="py-3">
                <h2 class="text-info fw-bold border-bottom pb-2 mb-3"><span class="badge bg-info me-2">3</span>專案結構與檔案說明</h2>
                
                <div id="aspnet-structure-overview" class="mb-4">
                    <h4 class="text-dark">3.1 專案架構概覽</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-sitemap me-2"></i>ASP.NET Web Forms 專案架構</h5>
                        <p class="mb-0">我們將逐一深入了解 Visual Studio 中每個檔案和資料夾的具體用途，幫助您掌握專案組織結構。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-folder-tree me-2"></i>完整專案結構圖</h5>
                    
                    <div class="bg-light p-3 rounded mb-4">
                        <pre class="mb-0 small"><code>📁 方案 'WebApplication1' (1 / 1 個專案)
└─ 📁 WebApplication1
    ├─ 🔗 Connected Services      <span class="text-muted">// 第三方服務連接</span>
    ├─ 🔧 Properties              <span class="text-muted">// 專案屬性設定</span>
    ├─ 📚 參考                    <span class="text-muted">// 程式庫參照</span>
    ├─ 📁 App_Data               <span class="text-muted">// 應用程式資料</span>
    ├─ 📁 App_Start              <span class="text-muted">// 啟動設定檔案</span>
    │   ├─ 📄 BundleConfig.cs     <span class="text-muted">// 資源打包設定</span>
    │   └─ 📄 RouteConfig.cs      <span class="text-muted">// 路由設定</span>
    ├─ 📁 Content                <span class="text-muted">// 靜態資源</span>
    │   ├─ 📄 bootstrap.css       <span class="text-muted">// Bootstrap 樣式</span>
    │   └─ 📄 Site.css            <span class="text-muted">// 網站樣式</span>
    ├─ 📁 Scripts                <span class="text-muted">// JavaScript 檔案</span>
    │   ├─ � bootstrap.js        <span class="text-muted">// Bootstrap 腳本</span>
    │   └─ � jquery-3.4.1.js     <span class="text-muted">// jQuery 函式庫</span>
    ├─ 📝 About.aspx             <span class="text-muted">// 關於頁面</span>
    ├─ 📝 Bundle.config          <span class="text-muted">// 打包設定檔</span>
    ├─ 📝 Contact.aspx           <span class="text-muted">// 聯絡頁面</span>
    ├─ 📝 Default.aspx           <span class="text-muted">// 預設首頁</span>
    ├─ � favicon.ico            <span class="text-muted">// 網站圖示</span>
    ├─ 📝 Global.asax            <span class="text-muted">// 全域應用程式檔案</span>
    ├─ 📝 packages.config        <span class="text-muted">// NuGet 套件設定</span>
    ├─ 📝 Site.Master            <span class="text-muted">// 主版頁面</span>
    ├─ 📝 Site.Mobile.Master     <span class="text-muted">// 行動版主版頁面</span>
    ├─ 📝 ViewSwitcher.ascx      <span class="text-muted">// 檢視切換控制項</span>
    └─ 📝 Web.config             <span class="text-muted">// 主要設定檔</span></code></pre>
                    </div>
                </div>

                <div id="aspnet-structure-core-files" class="mb-4">
                    <h4 class="text-dark">3.2 重要檔案詳解</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-file-code me-2"></i>核心檔案深度解析</h5>
                        <p class="mb-0">我們將深入解析 ASP.NET Web Forms 專案中的三個核心檔案：Global.asax、Default.aspx 和 Site.Master，詳細說明每個檔案的結構、用途和程式碼內容。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-globe me-2"></i>Global.asax - 全域應用程式檔案</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-danger text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-server me-2"></i>Global.asax 檔案解析</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案作用：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式全域事件處理</li>
                                        <li>應用程式生命週期管理</li>
                                        <li>全域變數初始化</li>
                                        <li>路由和 Bundle 註冊</li>
                                        <li>全域錯誤處理</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>關聯檔案：</strong></p>
                                    <ul class="small mb-3">
                                        <li>Global.asax.cs - 程式邏輯</li>
                                        <li>App_Start/*.cs - 啟動設定檔案</li>
                                        <li>RouteConfig.cs - 路由設定</li>
                                        <li>BundleConfig.cs - 資源打包設定</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-play me-2"></i>Application_Start 方法解析</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>void Application_Start(object sender, EventArgs e)
{
    // 應用程式啟動時執行的程式碼
    // 這個方法在整個應用程式生命週期中只執行一次
    
    // 註冊路由設定 - 讓網址更友善
    RouteConfig.RegisterRoutes(RouteTable.Routes);
    
    // 註冊 Bundle 設定 - CSS/JS 檔案打包優化
    BundleConfig.RegisterBundles(BundleTable.Bundles);
    
    // 可以在這裡初始化全域變數
    Application["StartTime"] = DateTime.Now;
    Application["VisitorCount"] = 0;
}</code></pre>
                                </div>
                                <p class="small text-muted mt-2"><strong>說明：</strong>Application_Start 是應用程式啟動時的入口點，用於初始化全域設定和資源。</p>
                            </div>

                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-route me-2"></i>RouteConfig.RegisterRoutes 方法詳解</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>public static void RegisterRoutes(RouteCollection routes)
{
    // 建立友善 URL 設定物件
    var settings = new FriendlyUrlSettings();
    
    // 設定自動重新導向模式為永久重新導向 (301)
    // 這有助於 SEO，告訴搜尋引擎這是永久性的 URL 變更
    settings.AutoRedirectMode = RedirectMode.Permanent;
    
    // 也可以手動定義路由規則
    // 需要放在 EnableFriendlyUrls 之前
    // routes.MapPageRoute("ProductDetails", 
    //                    "products/{id}", 
    //                    "~/ProductDetails.aspx");
    
    // 啟用友善 URL 功能
    // 將傳統的 .aspx 網址轉換為更簡潔的格式
    // 例如：/Default.aspx → /Default 或 /
    routes.EnableFriendlyUrls(settings);
    
}</code></pre>
                                </div>
                                
                                <div class="alert alert-info mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-code me-1"></i>MapPageRoute 詳細說明</h6>
                                    <div class="small">
                                        <p><strong>語法結構：</strong></p>
                                        <div class="code-container mb-2">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0"><code>routes.MapPageRoute(
    "路由名稱",           // 唯一識別名稱
    "URL模式",           // 友善URL格式
    "實際頁面路徑"        // 對應的.aspx檔案
);</code></pre>
                                        </div>
                                        
                                        <p><strong>實際運用範例：</strong></p>
                                        <div class="code-container mb-2">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0"><code>// 產品詳細頁面路由
routes.MapPageRoute("ProductDetails", 
                   "products/{id}", 
                   "~/Pages/ProductDetails.aspx");

// 使用者個人資料頁面
routes.MapPageRoute("UserProfile", 
                   "user/{username}", 
                   "~/Account/Profile.aspx");

// 分類瀏覽頁面
routes.MapPageRoute("CategoryView", 
                   "category/{categoryName}/page/{pageNumber}", 
                   "~/Products/Category.aspx");</code></pre>
                                        </div>
                                        
                                        <p><strong>參數使用方式：</strong></p>
                                        <ul class="mb-2">
                                            <li><code>{id}</code> - 在 Page_Load 中透過 <code>Page.RouteData.Values["id"]</code> 取得</li>
                                            <li><code>{username}</code> - 透過 <code>Page.RouteData.Values["username"]</code> 存取</li>
                                            <li>支援可選參數：<code>{categoryName?}</code></li>
                                            <li>支援預設值：在 RouteValueDictionary 中設定</li>
                                        </ul>
                                        
                                        <p><strong>在頁面中取得路由參數：</strong></p>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0"><code>protected void Page_Load(object sender, EventArgs e)
{
    // 取得路由參數
    string productId = Page.RouteData.Values["id"] as string;
    
    if (!string.IsNullOrEmpty(productId))
    {
        // 使用 productId 載入產品資料
        LoadProductDetails(productId);
    }
}</code></pre>
                                        </div>
                                    </div>
                                </div>
                                </div>
                                <div class="alert alert-success mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-lightbulb me-1"></i>友善 URL 的好處</h6>
                                    <ul class="small mb-0">
                                        <li><strong>SEO 優化：</strong>搜尋引擎更容易理解網址結構</li>
                                        <li><strong>使用者友善：</strong>網址更簡潔易讀，容易記憶</li>
                                        <li><strong>專業形象：</strong>隱藏技術實作細節（.aspx）</li>
                                        <li><strong>向後相容：</strong>舊的 .aspx 網址仍然可以正常運作</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2"><i class="fa-solid fa-package me-2"></i>BundleConfig.RegisterBundles 方法詳解</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>public static void RegisterBundles(BundleCollection bundles)
{
    // 註冊 jQuery Script Manager 對應
    RegisterJQueryScriptManager();

    // Web Forms 核心 JavaScript Bundle
    // 包含 Web Forms 基本功能所需的 JavaScript 檔案
    bundles.Add(new ScriptBundle("~/bundles/WebFormsJs").Include(
                    "~/Scripts/WebForms/WebForms.js",          // 基本 Web Forms 功能
                    "~/Scripts/WebForms/WebUIValidation.js",   // 客戶端驗證
                    "~/Scripts/WebForms/MenuStandards.js",     // 選單控制項
                    "~/Scripts/WebForms/Focus.js",             // 焦點管理
                    "~/Scripts/WebForms/GridView.js",          // GridView 控制項
                    "~/Scripts/WebForms/DetailsView.js",       // DetailsView 控制項
                    "~/Scripts/WebForms/TreeView.js",          // TreeView 控制項
                    "~/Scripts/WebForms/WebParts.js"));        // Web Parts 功能

    // Microsoft AJAX JavaScript Bundle
    // 順序很重要！這些檔案有明確的相依性
    bundles.Add(new ScriptBundle("~/bundles/MsAjaxJs").Include(
            "~/Scripts/WebForms/MsAjax/MicrosoftAjax.js",                // AJAX 核心框架
            "~/Scripts/WebForms/MsAjax/MicrosoftAjaxApplicationServices.js", // 應用程式服務
            "~/Scripts/WebForms/MsAjax/MicrosoftAjaxTimer.js",           // Timer 控制項
            "~/Scripts/WebForms/MsAjax/MicrosoftAjaxWebForms.js"));      // Web Forms AJAX

    // Modernizr Bundle - 瀏覽器功能檢測
    bundles.Add(new ScriptBundle("~/bundles/modernizr").Include(
                    "~/Scripts/modernizr-*"));
}</code></pre>
                                </div>
                                
                                <div class="alert alert-success mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-info-circle me-1"></i>Bundle 使用說明</h6>
                                    <div class="small">
                                        <p><strong>1. WebFormsJs Bundle 預設使用檔案：</strong></p>
                                        <ul class="mb-2">
                                            <li><strong>Site.Master：</strong>在主版頁面中透過 ScriptManager 自動載入</li>
                                            <li><strong>具有伺服器控制項的頁面：</strong>包含 GridView、DetailsView、TreeView 等控制項的頁面</li>
                                            <li><strong>使用驗證控制項的頁面：</strong>RequiredFieldValidator、RegularExpressionValidator 等</li>
                                        </ul>
                                        
                                        <p><strong>2. MsAjaxJs Bundle 預設使用檔案：</strong></p>
                                        <ul class="mb-2">
                                            <li><strong>使用 UpdatePanel 的頁面：</strong>部分頁面更新功能</li>
                                            <li><strong>使用 Timer 控制項的頁面：</strong>定時更新功能</li>
                                            <li><strong>AJAX 啟用的頁面：</strong>包含 ScriptManager 且 EnablePageMethods="true"</li>
                                        </ul>
                                        
                                        <p><strong>在 Site.Master 中的使用方式：</strong></p>
                                        <div class="code-container mb-2">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0"><code>&lt;asp:ScriptManager runat="server"&gt;
    &lt;Scripts&gt;
        &lt;asp:ScriptReference Name="MsAjaxBundle" /&gt;
        &lt;asp:ScriptReference Name="WebFormsJs" /&gt;
    &lt;/Scripts&gt;
&lt;/asp:ScriptManager&gt;</code></pre>
                                        </div>
                                        
                                        <p><strong>手動載入 Bundle 的方式：</strong></p>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0"><code>&lt;%-- 在頁面或主版頁面中 --%&gt;
&lt;%: Scripts.Render("~/bundles/WebFormsJs") %&gt;
&lt;%: Scripts.Render("~/bundles/MsAjaxJs") %&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="alert alert-warning mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-exclamation-triangle me-1"></i>載入順序重要性</h6>
                                    <div class="small">
                                        <p><strong>正確的載入順序：</strong></p>
                                        <ol class="mb-2">
                                            <li><strong>MicrosoftAjax.js</strong> - 必須最先載入，提供 AJAX 基礎架構</li>
                                            <li><strong>MicrosoftAjaxApplicationServices.js</strong> - 應用程式服務支援</li>
                                            <li><strong>MicrosoftAjaxTimer.js</strong> - Timer 控制項支援</li>
                                            <li><strong>MicrosoftAjaxWebForms.js</strong> - Web Forms AJAX 整合</li>
                                        </ol>
                                        <p class="mb-0"><strong>注意：</strong>順序錯誤會導致 JavaScript 錯誤和功能失效！</p>
                                    </div>
                                </div>

// jQuery Script Manager 註冊方法
public static void RegisterJQueryScriptManager()
{
    // 定義 jQuery 的不同版本路徑
    ScriptManager.ScriptResourceMapping.AddDefinition("jquery",
        new ScriptResourceDefinition
        {
            Path = "~/scripts/jquery-3.7.0.min.js",           // 正式版（壓縮）
            DebugPath = "~/scripts/jquery-3.7.0.js",          // 偵錯版（未壓縮）
            CdnPath = "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.7.0.min.js",
            CdnDebugPath = "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.7.0.js"
        });
}</code></pre>
                                </div>
                                <div class="alert alert-warning mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-exclamation-triangle me-1"></i>Bundle 重要概念</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p class="small mb-1"><strong>檔案合併：</strong></p>
                                            <ul class="small mb-2">
                                                <li>減少 HTTP 請求次數</li>
                                                <li>提升頁面載入速度</li>
                                                <li>自動處理檔案相依性</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <p class="small mb-1"><strong>自動優化：</strong></p>
                                            <ul class="small mb-2">
                                                <li>Release 模式自動壓縮</li>
                                                <li>Debug 模式保持原檔案</li>
                                                <li>CDN 支援（網路優化）</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="alert alert-primary mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-code-compare me-1"></i>BundleConfig.cs vs Bundle.config 詳細比較</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="bg-success text-white p-2 rounded mb-2">
                                                <h6 class="small mb-2"><strong>BundleConfig.cs (程式化設定)</strong></h6>
                                                <div class="code-container">
                                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                                    <pre class="mb-1 text-black" style="font-size: 10px;"><code>// C# 程式碼
bundles.Add(new ScriptBundle("~/bundles/jquery")
    .Include("~/Scripts/jquery-{version}.js"));
    
// 條件判斷
if (HttpContext.Current.IsDebuggingEnabled)
{
    bundles.Add(new ScriptBundle("~/bundles/debug")
        .Include("~/Scripts/debug.js"));
}</code></pre>
                                                </div>
                                                <ul class="small mb-0 mt-1">
                                                    <li>✅ 支援複雜邏輯和條件判斷</li>
                                                    <li>✅ 可動態建立 Bundle</li>
                                                    <li>✅ 強型別檢查</li>
                                                    <li>❌ 需要重新編譯</li>
                                                    <li>❌ 程式碼較複雜</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="bg-warning text-dark p-2 rounded mb-2">
                                                <h6 class="small mb-2"><strong>Bundle.config (宣告式設定)</strong></h6>
                                                <div class="code-container">
                                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                                    <pre class="mb-1" style="font-size: 10px;"><code>&lt;!-- XML 設定 --&gt;
&lt;bundles&gt;
  &lt;scriptBundle path="~/bundles/jquery"&gt;
    &lt;include path="~/Scripts/jquery-*.js" /&gt;
  &lt;/scriptBundle&gt;
  
  &lt;styleBundle path="~/Content/css"&gt;
    &lt;include path="~/Content/*.css" /&gt;
  &lt;/styleBundle&gt;
&lt;/bundles&gt;</code></pre>
                                                </div>
                                                <ul class="small mb-0 mt-1">
                                                    <li>✅ 設定檔案方式，不需重編譯</li>
                                                    <li>✅ 語法簡單易懂</li>
                                                    <li>✅ 支援萬用字元 (*)</li>
                                                    <li>❌ 功能較有限</li>
                                                    <li>❌ 不支援複雜邏輯</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="bg-light p-2 rounded">
                                        <p class="small mb-1"><strong><i class="fa-solid fa-lightbulb me-1"></i>選擇建議：</strong></p>
                                        <ul class="small mb-0">
                                            <li><strong>簡單專案：</strong>使用 Bundle.config，設定簡單且彈性</li>
                                            <li><strong>複雜專案：</strong>使用 BundleConfig.cs，支援動態邏輯和條件判斷</li>
                                            <li><strong>混合使用：</strong>可以同時使用兩種方式，BundleConfig.cs 優先權較高</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-file-code me-2"></i>Default.aspx - 預設首頁</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-home me-2"></i>Default.aspx 檔案解析</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案作用：</strong></p>
                                    <ul class="small mb-3">
                                        <li>網站的預設首頁</li>
                                        <li>定義頁面內容結構</li>
                                        <li>使用主版頁面進行版面配置</li>
                                        <li>包含響應式設計元素</li>
                                        <li>展示網站主要功能</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>關聯檔案：</strong></p>
                                    <ul class="small mb-3">
                                        <li>Default.aspx.cs - 程式邏輯</li>
                                        <li>Default.aspx.designer.cs - 設計器產生</li>
                                        <li>Site.Master - 主版頁面</li>
                                        <li>Content/Site.css - 樣式表</li>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-code me-2"></i>頁面指示詞 (Page Directive)</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;%@ Page Title="Home Page"           // 設定頁面標題
         Language="C#"                  // 指定程式語言為 C#
         MasterPageFile="~/Site.Master" // 指定使用的主版頁面
         AutoEventWireup="true"         // 自動連結事件處理常式
         CodeBehind="Default.aspx.cs"   // 指定程式碼後置檔案
         Inherits="WebApplication3._Default" %&gt;  // 指定繼承的類別</code></pre>
                                </div>
                                <p class="small text-muted mt-2"><strong>說明：</strong>Page 指示詞定義了頁面的基本屬性和行為設定。</p>
                            </div>

                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-layout-template me-2"></i>內容區域 (Content Areas)</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;

    &lt;main&gt;
        &lt;!-- 主要標題區域 --&gt;
        &lt;section class="row" aria-labelledby="aspnetTitle"&gt;
            &lt;h1 id="aspnetTitle"&gt;ASP.NET&lt;/h1&gt;
            &lt;p class="lead"&gt;ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS, and JavaScript.&lt;/p&gt;
            &lt;p&gt;&lt;a href="http://www.asp.net" class="btn btn-primary btn-md"&gt;Learn more &amp;raquo;&lt;/a&gt;&lt;/p&gt;
        &lt;/section&gt;

        &lt;!-- 三欄式功能介紹區域 --&gt;
        &lt;div class="row"&gt;
            &lt;!-- 第一欄：開始使用 --&gt;
            &lt;section class="col-md-4" aria-labelledby="gettingStartedTitle"&gt;
                &lt;h2 id="gettingStartedTitle"&gt;Getting started&lt;/h2&gt;
                &lt;p&gt;ASP.NET Web Forms lets you build dynamic websites using a familiar drag-and-drop, event-driven model. A design surface and hundreds of controls and components let you rapidly build sophisticated, powerful UI-driven sites with data access.&lt;/p&gt;
                &lt;p&gt;&lt;a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkId=301948"&gt;Learn more &amp;raquo;&lt;/a&gt;&lt;/p&gt;
            &lt;/section&gt;
            
            &lt;!-- 第二欄：程式庫管理 --&gt;
            &lt;section class="col-md-4" aria-labelledby="librariesTitle"&gt;
                &lt;h2 id="librariesTitle"&gt;Get more libraries&lt;/h2&gt;
                &lt;p&gt;NuGet is a free Visual Studio extension that makes it easy to add, remove, and update libraries and tools in Visual Studio projects.&lt;/p&gt;
                &lt;p&gt;&lt;a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkId=301949"&gt;Learn more &amp;raquo;&lt;/a&gt;&lt;/p&gt;
            &lt;/section&gt;
            
            &lt;!-- 第三欄：網站託管 --&gt;
            &lt;section class="col-md-4" aria-labelledby="hostingTitle"&gt;
                &lt;h2 id="hostingTitle"&gt;Web Hosting&lt;/h2&gt;
                &lt;p&gt;You can easily find a web hosting company that offers the right mix of features and price for your applications.&lt;/p&gt;
                &lt;p&gt;&lt;a class="btn btn-default" href="https://go.microsoft.com/fwlink/?LinkId=301950"&gt;Learn more &amp;raquo;&lt;/a&gt;&lt;/p&gt;
            &lt;/section&gt;
        &lt;/div&gt;
    &lt;/main&gt;

&lt;/asp:Content&gt;</code></pre>
                                </div>
                                <div class="alert alert-success mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-star me-1"></i>設計重點分析</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p class="small mb-1"><strong>響應式設計：</strong></p>
                                            <ul class="small mb-2">
                                                <li>使用 Bootstrap 的 col-md-4 類別</li>
                                                <li>支援不同螢幕尺寸自動調整</li>
                                                <li>行動裝置優先的設計理念</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <p class="small mb-1"><strong>無障礙設計：</strong></p>
                                            <ul class="small mb-2">
                                                <li>使用 aria-labelledby 增強語意</li>
                                                <li>適當的 HTML5 語意標籤</li>
                                                <li>清楚的標題階層結構</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-layout-template me-2"></i>Site.Master - 主版頁面</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-th-large me-2"></i>Site.Master 檔案解析</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案作用：</strong></p>
                                    <ul class="small mb-3">
                                        <li>定義網站統一版面配置</li>
                                        <li>提供共用的導航選單</li>
                                        <li>管理全域 CSS/JavaScript 引用</li>
                                        <li>設定網站標題和 meta 標籤</li>
                                        <li>建立響應式網站結構</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>關聯檔案：</strong></p>
                                    <ul class="small mb-3">
                                        <li>Site.Master.cs - 程式邏輯</li>
                                        <li>Site.Master.designer.cs - 設計器產生</li>
                                        <li>Content/Site.css - 樣式表</li>
                                        <li>Scripts/ - JavaScript 檔案</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-code me-2"></i>Master 指示詞與 HTML 結構</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;%@ Master Language="C#"                    // 指定為主版頁面，使用 C#
           AutoEventWireup="true"               // 自動事件連結
           CodeBehind="Site.master.cs"          // 程式碼後置檔案
           Inherits="WebApplication3.SiteMaster" %&gt;  // 繼承的類別

&lt;!DOCTYPE html&gt;
&lt;html lang="zh"&gt;  &lt;!-- 設定語言為中文，有助於 SEO 和無障礙功能 --&gt;
&lt;head runat="server"&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    
    &lt;!-- 動態標題：結合頁面標題與應用程式名稱 --&gt;
    &lt;title&gt;&lt;%: Page.Title %&gt; - 我的 ASP.NET 應用程式&lt;/title&gt;</code></pre>
                                </div>
                            </div>

                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-cogs me-2"></i>JavaScript 和 CSS 資源管理</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>    &lt;!-- Modernizr：瀏覽器功能檢測，必須放在 head 中 --&gt;
    &lt;asp:PlaceHolder runat="server"&gt;
        &lt;%: Scripts.Render("~/bundles/modernizr") %&gt;
    &lt;/asp:PlaceHolder&gt;

    &lt;!-- CSS Bundle：自動載入和最佳化 CSS 檔案 --&gt;
    &lt;webopt:bundlereference runat="server" path="~/Content/css" /&gt;
    
    &lt;!-- 網站圖示 --&gt;
    &lt;link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" /&gt;
&lt;/head&gt;</code></pre>
                                </div>
                                <p class="small text-muted mt-2"><strong>說明：</strong>資源載入順序很重要：Modernizr 在 head 中，其他 JS 在 body 底部。</p>
                            </div>

                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-cog me-2"></i>ScriptManager 設定</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;form runat="server"&gt;
    &lt;!-- ScriptManager：管理所有 JavaScript 資源和 AJAX 功能 --&gt;
    &lt;asp:ScriptManager runat="server"&gt;
        &lt;Scripts&gt;
            &lt;!-- Framework 核心腳本 --&gt;
            &lt;asp:ScriptReference Name="MsAjaxBundle" /&gt;        &lt;!-- Microsoft AJAX 框架 --&gt;
            &lt;asp:ScriptReference Name="jquery" /&gt;             &lt;!-- jQuery 函式庫 --&gt;
            
            &lt;!-- Web Forms 專用腳本 --&gt;
            &lt;asp:ScriptReference Name="WebForms.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebForms.js" /&gt;
            &lt;asp:ScriptReference Name="WebUIValidation.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebUIValidation.js" /&gt;
            &lt;asp:ScriptReference Name="MenuStandards.js" Assembly="System.Web" Path="~/Scripts/WebForms/MenuStandards.js" /&gt;
            &lt;asp:ScriptReference Name="GridView.js" Assembly="System.Web" Path="~/Scripts/WebForms/GridView.js" /&gt;
            &lt;asp:ScriptReference Name="DetailsView.js" Assembly="System.Web" Path="~/Scripts/WebForms/DetailsView.js" /&gt;
            &lt;asp:ScriptReference Name="TreeView.js" Assembly="System.Web" Path="~/Scripts/WebForms/TreeView.js" /&gt;
            &lt;asp:ScriptReference Name="WebParts.js" Assembly="System.Web" Path="~/Scripts/WebForms/WebParts.js" /&gt;
            &lt;asp:ScriptReference Name="Focus.js" Assembly="System.Web" Path="~/Scripts/WebForms/Focus.js" /&gt;
            &lt;asp:ScriptReference Name="WebFormsBundle" /&gt;     &lt;!-- 自訂 Web Forms Bundle --&gt;
        &lt;/Scripts&gt;
    &lt;/asp:ScriptManager&gt;</code></pre>
                                </div>
                                <div class="alert alert-info mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-lightbulb me-1"></i>ScriptManager 的重要性</h6>
                                    <p class="small mb-1"><strong>ScriptManager 是 Web Forms AJAX 功能的核心：</strong></p>
                                    <ul class="small mb-0">
                                        <li>管理 UpdatePanel、Timer 等 AJAX 控制項</li>
                                        <li>處理異步 PostBack 和部分頁面更新</li>
                                        <li>提供客戶端 JavaScript 函式庫</li>
                                        <li>統一管理所有 JavaScript 資源載入</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-bars me-2"></i>響應式導航選單</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>    &lt;!-- Bootstrap 響應式導航列 --&gt;
    &lt;nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-dark bg-dark"&gt;
        &lt;div class="container"&gt;
            &lt;!-- 網站標誌/品牌名稱 --&gt;
            &lt;a class="navbar-brand" runat="server" href="~/"&gt;應用程式名稱&lt;/a&gt;
            
            &lt;!-- 行動裝置選單切換按鈕 --&gt;
            &lt;button type="button" class="navbar-toggler" 
                    data-bs-toggle="collapse" 
                    data-bs-target=".navbar-collapse" 
                    title="切換導覽" 
                    aria-controls="navbarSupportedContent"
                    aria-expanded="false" 
                    aria-label="Toggle navigation"&gt;
                &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
            &lt;/button&gt;
            
            &lt;!-- 可收合的導航選單 --&gt;
            &lt;div class="collapse navbar-collapse d-sm-inline-flex justify-content-between"&gt;
                &lt;ul class="navbar-nav flex-grow-1"&gt;
                    &lt;li class="nav-item"&gt;&lt;a class="nav-link" runat="server" href="~/"&gt;首頁&lt;/a&gt;&lt;/li&gt;
                    &lt;li class="nav-item"&gt;&lt;a class="nav-link" runat="server" href="~/About"&gt;關於&lt;/a&gt;&lt;/li&gt;
                    &lt;li class="nav-item"&gt;&lt;a class="nav-link" runat="server" href="~/Contact"&gt;連絡人&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/nav&gt;</code></pre>
                                </div>
                            </div>

                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2"><i class="fa-solid fa-layout me-2"></i>主要內容區域與頁尾</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>    &lt;!-- 主要內容容器 --&gt;
    &lt;div class="container body-content"&gt;
        &lt;!-- 內容佔位符：子頁面內容插入點 --&gt;
        &lt;asp:ContentPlaceHolder ID="MainContent" runat="server"&gt;
        &lt;/asp:ContentPlaceHolder&gt;
        
        &lt;hr /&gt;
        
        &lt;!-- 網站頁尾 --&gt;
        &lt;footer&gt;
            &lt;p&gt;&amp;copy; &lt;%: DateTime.Now.Year %&gt; - 我的 ASP.NET 應用程式&lt;/p&gt;
        &lt;/footer&gt;
    &lt;/div&gt;
&lt;/form&gt;

&lt;!-- 在頁面底部載入 Bootstrap JavaScript --&gt;
&lt;asp:PlaceHolder runat="server"&gt;
    &lt;%: Scripts.Render("~/Scripts/bootstrap.js") %&gt;
&lt;/asp:PlaceHolder&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                </div>
                                <div class="alert alert-success mt-2">
                                    <h6 class="alert-heading small"><i class="fa-solid fa-star me-1"></i>版面配置最佳實踐</h6>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <p class="small mb-1"><strong>效能優化：</strong></p>
                                            <ul class="small mb-2">
                                                <li>JavaScript 放在頁面底部</li>
                                                <li>CSS 放在頁面頂部</li>
                                                <li>使用 Bundle 減少 HTTP 請求</li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6">
                                            <p class="small mb-1"><strong>使用者體驗：</strong></p>
                                            <ul class="small mb-2">
                                                <li>響應式設計適應各種裝置</li>
                                                <li>一致的導航和版面配置</li>
                                                <li>清楚的內容結構分離</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-check-circle me-2"></i>重要檔案整合運作</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>應用程式啟動流程：</strong></p>
                                <ol class="small mb-0">
                                    <li><strong>Global.asax</strong> Application_Start 初始化</li>
                                    <li>註冊路由和 Bundle 設定</li>
                                    <li><strong>Site.Master</strong> 載入共用版面</li>
                                    <li><strong>Default.aspx</strong> 插入特定內容</li>
                                    <li>組合成完整的 HTML 回應</li>
                                </ol>
                            </div>
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>開發重點：</strong></p>
                                <ul class="small mb-0">
                                    <li>理解每個檔案的職責分工</li>
                                    <li>善用 Bundle 和路由優化效能</li>
                                    <li>保持主版頁面的一致性</li>
                                    <li>適當使用 ContentPlaceHolder</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-cogs me-2"></i>Web.config - 應用程式組態檔</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-dark">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-wrench me-2"></i>Web.config 檔案解析</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案作用：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式組態設定</li>
                                        <li>資料庫連線字串管理</li>
                                        <li>系統設定與安全性規則</li>
                                        <li>IIS 伺服器行為控制</li>
                                        <li>錯誤處理與偵錯設定</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>重要特性：</strong></p>
                                    <ul class="small mb-3">
                                        <li>XML 格式的組態檔案</li>
                                        <li>階層式組態繼承</li>
                                        <li>支援加密敏感資料</li>
                                        <li>執行階段自動重新載入</li>
                                        <li>開發/正式環境區分設定</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="alert alert-dark mb-3">
                                <h6 class="alert-heading"><i class="fa-solid fa-bolt me-2"></i>Web.config 最常用設定快速參考</h6>
                                <div class="row mt-3">
                                    <div class="col-md-4">
                                        <h6 class="small"><i class="fa-solid fa-1 me-1"></i>連線字串</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-1" style="font-size: 11px;"><code>&lt;connectionStrings&gt;
  &lt;add name="MyDB" 
    connectionString="..." /&gt;
&lt;/connectionStrings&gt;</code></pre>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <h6 class="small"><i class="fa-solid fa-2 me-1"></i>偵錯模式</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-1" style="font-size: 11px;"><code>&lt;compilation 
  debug="true" 
  targetFramework="4.8" /&gt;</code></pre>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <h6 class="small"><i class="fa-solid fa-3 me-1"></i>錯誤頁面</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-1" style="font-size: 11px;"><code>&lt;customErrors 
  mode="RemoteOnly" 
  defaultRedirect="~/Error.aspx" /&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-4">
                                        <h6 class="small"><i class="fa-solid fa-4 me-1"></i>應用程式設定</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-1" style="font-size: 11px;"><code>&lt;appSettings&gt;
  &lt;add key="Setting1" value="..." /&gt;
&lt;/appSettings&gt;</code></pre>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <h6 class="small"><i class="fa-solid fa-5 me-1"></i>檔案上傳限制</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-1" style="font-size: 11px;"><code>&lt;httpRuntime 
  maxRequestLength="51200" 
  executionTimeout="300" /&gt;</code></pre>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <h6 class="small"><i class="fa-solid fa-6 me-1"></i>Session 設定</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-1" style="font-size: 11px;"><code>&lt;sessionState 
  mode="InProc" 
  timeout="20" /&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                                <p class="small mb-0 mt-2"><i class="fa-solid fa-info-circle me-1"></i><strong>提示：</strong>這些是 90% 的專案都會用到的基本設定，建議優先掌握！</p>
                            </div>

                            
                            <div class="row">
                                
                                <div class="col-md-6">
                                    <div class="alert alert-success">
                                        <h6 class="alert-heading small"><i class="fa-solid fa-rocket me-1"></i>開發階段常用設定</h6>
                                        <div class="code-container mb-2">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0 small"><code>&lt;!-- 開發環境推薦設定 --&gt;
&lt;compilation debug="true" /&gt;
&lt;customErrors mode="Off" /&gt;
&lt;sessionState timeout="20" /&gt;
&lt;httpRuntime maxRequestLength="51200" /&gt;</code></pre>
                                        </div>
                                        <ul class="small mb-0">
                                            <li><strong>debug="true"</strong> - 啟用詳細錯誤訊息</li>
                                            <li><strong>customErrors="Off"</strong> - 顯示完整錯誤資訊</li>
                                            <li><strong>較長的 timeout</strong> - 方便偵錯</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="col-md-6">
                                    <div class="alert alert-warning">
                                        <h6 class="alert-heading small"><i class="fa-solid fa-server me-1"></i>正式環境必要設定</h6>
                                        <div class="code-container mb-2">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0 small"><code>&lt;!-- 正式環境安全設定 --&gt;
&lt;compilation debug="false" /&gt;
&lt;customErrors mode="RemoteOnly" /&gt;
&lt;httpRuntime enableVersionHeader="false" /&gt;
&lt;trust level="Full" /&gt;</code></pre>
                                        </div>
                                        <ul class="small mb-0">
                                            <li><strong>debug="false"</strong> - 提升效能，隱藏錯誤詳情</li>
                                            <li><strong>customErrors="RemoteOnly"</strong> - 對外顯示友善錯誤</li>
                                            <li><strong>enableVersionHeader="false"</strong> - 隱藏版本資訊</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="col-12">
                                    <div class="alert alert-info">
                                        <h6 class="alert-heading small"><i class="fa-solid fa-database me-1"></i>資料庫連線字串常用格式</h6>
                                        <div class="code-container">
                                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                            <pre class="mb-0 small"><code>&lt;connectionStrings&gt;
  &lt;!-- SQL Server LocalDB (開發常用) --&gt;
  &lt;add name="DefaultConnection" 
       connectionString="Data Source=(LocalDb)\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\MyApp.mdf;Initial Catalog=MyApp;Integrated Security=True" 
       providerName="System.Data.SqlClient" /&gt;
  
  &lt;!-- SQL Server (正式環境) --&gt;
  &lt;add name="ProductionDB" 
       connectionString="Server=myserver;Database=MyAppDB;User Id=myuser;Password=mypassword;" 
       providerName="System.Data.SqlClient" /&gt;
  
  &lt;!-- SQL Server Express --&gt;
  &lt;add name="ExpressDB" 
       connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=MyAppDB;Integrated Security=True" 
       providerName="System.Data.SqlClient" /&gt;
&lt;/connectionStrings&gt;</code></pre>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div class="bg-info text-white p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-globe me-2"></i>CORS (跨來源資源共用) 設定詳解</h6>
                                <div class="small">
                                    <p><strong>什麼是 CORS？</strong></p>
                                    <p>CORS (Cross-Origin Resource Sharing) 是一種安全機制，允許網頁從不同網域載入資源，解決瀏覽器的同源政策限制。</p>
                                    
                                    <p><strong>常見 CORS 設定選項：</strong></p>
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-2 text-black"><code>&lt;!-- 1. 允許所有來源（開發環境） --&gt;
&lt;add name="Access-Control-Allow-Origin" value="*" /&gt;

&lt;!-- 2. 允許特定網域（正式環境推薦） --&gt;
&lt;add name="Access-Control-Allow-Origin" value="https://mydomain.com" /&gt;

&lt;!-- 3. 允許多個特定網域 --&gt;
&lt;add name="Access-Control-Allow-Origin" value="https://app1.com, https://app2.com" /&gt;

&lt;!-- 4. 允許的 HTTP 方法 --&gt;
&lt;add name="Access-Control-Allow-Methods" value="GET, POST, PUT, DELETE, OPTIONS" /&gt;

&lt;!-- 5. 允許的請求標頭 --&gt;
&lt;add name="Access-Control-Allow-Headers" value="Content-Type, Authorization, X-Requested-With, X-Custom-Header" /&gt;

&lt;!-- 6. 預檢請求快取時間（秒） --&gt;
&lt;add name="Access-Control-Max-Age" value="3600" /&gt;

&lt;!-- 7. 允許傳送 Cookie 和憑證 --&gt;
&lt;add name="Access-Control-Allow-Credentials" value="true" /&gt;</code></pre>
                                    </div>
                                </div>
                            </div>

                            <div class="alert alert-warning mb-3">
                                <h6 class="alert-heading small"><i class="fa-solid fa-shield-alt me-1"></i>CORS 安全性考量</h6>
                                <div class="small">
                                    <p><strong>正式環境 CORS 設定建議：</strong></p>
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-2"><code>&lt;!-- 正式環境安全設定範例 --&gt;
&lt;customHeaders&gt;
  &lt;!-- 只允許信任的網域 --&gt;
  &lt;add name="Access-Control-Allow-Origin" value="https://myapp.com" /&gt;
  
  &lt;!-- 限制允許的 HTTP 方法 --&gt;
  &lt;add name="Access-Control-Allow-Methods" value="GET, POST" /&gt;
  
  &lt;!-- 限制允許的標頭 --&gt;
  &lt;add name="Access-Control-Allow-Headers" value="Content-Type, Authorization" /&gt;
  
  &lt;!-- 不允許傳送憑證（除非必要） --&gt;
  &lt;add name="Access-Control-Allow-Credentials" value="false" /&gt;
  
  &lt;!-- 設定合理的預檢快取時間 --&gt;
  &lt;add name="Access-Control-Max-Age" value="1800" /&gt; &lt;!-- 30分鐘 --&gt;
&lt;/customHeaders&gt;</code></pre>
                                    </div>
                                    <ul class="mb-0">
                                        <li><strong>避免使用 "*"：</strong>正式環境應指定具體網域</li>
                                        <li><strong>最小權限原則：</strong>只開放必要的方法和標頭</li>
                                        <li><strong>定期檢查：</strong>確認 CORS 設定符合當前需求</li>
                                        <li><strong>記錄監控：</strong>追蹤跨來源請求的使用情況</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="bg-success text-white p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-code me-2"></i>程式化 CORS 設定（推薦方式）</h6>
                                <div class="small">
                                    <p>除了在 Web.config 設定外，也可以在 Global.asax 中程式化處理 CORS：</p>
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-0 text-black"><code>// 在 Global.asax.cs 中添加
protected void Application_BeginRequest(object sender, EventArgs e)
{
    // 處理預檢請求 (OPTIONS)
    if (Request.HttpMethod == "OPTIONS")
    {
        Response.AddHeader("Access-Control-Allow-Origin", GetAllowedOrigin());
        Response.AddHeader("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE");
        Response.AddHeader("Access-Control-Allow-Headers", "Content-Type, Authorization");
        Response.AddHeader("Access-Control-Max-Age", "3600");
        Response.StatusCode = 200;
        Response.End();
    }
    else
    {
        // 一般請求添加 CORS 標頭
        Response.AddHeader("Access-Control-Allow-Origin", GetAllowedOrigin());
    }
}

private string GetAllowedOrigin()
{
    string origin = Request.Headers["Origin"];
    
    // 定義允許的網域清單
    string[] allowedOrigins = {
        "https://app1.com",
        "https://app2.com",
        "http://localhost:3000"  // 開發環境
    };
    
    // 檢查是否為允許的來源
    if (allowedOrigins.Contains(origin))
    {
        return origin;
    }
    
    return "https://myapp.com"; // 預設允許的網域
}</code></pre>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                                        <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-file-alt me-2"></i>其他重要檔案</h5>
                    <div class="row">
                         <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-link me-2"></i>Bundle.config</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>資源打包與最佳化設定</p>
                                    <p class="card-text small"><strong>功能：</strong></p>
                                    <ul class="small mb-2">
                                        <li>CSS/JS 檔案合併</li>
                                        <li>檔案壓縮</li>
                                        <li>減少 HTTP 請求</li>
                                        <li>提升載入效能</li>
                                    </ul>
                                    <div class="bg-light p-2 rounded mb-2">
                                        <pre class="mb-0" style="font-size: 10px;"><code>&lt;bundles&gt;
  &lt;styleBundle path="~/Content/css"&gt;
    &lt;include path="~/Content/bootstrap.css" /&gt;
    &lt;include path="~/Content/site.css" /&gt;
  &lt;/styleBundle&gt;
&lt;/bundles&gt;</code></pre>
                                    </div>
                                    
                                    <div class="alert alert-info p-2">
                                        <h6 class="small mb-2"><i class="fa-solid fa-code me-1"></i>Bundle.config vs BundleConfig.cs 差異</h6>
                                        <div class="small">
                                            <p class="mb-1"><strong class="text-primary">Bundle.config (XML檔案)：</strong></p>
                                            <ul class="small mb-2" style="margin-left: 15px;">
                                                <li>宣告式設定，使用 XML 語法</li>
                                                <li>設定檔案方式，不需重新編譯</li>
                                                <li>簡單的 include/exclude 設定</li>
                                                <li>適合靜態資源打包</li>
                                            </ul>
                                            
                                            <p class="mb-1"><strong class="text-success">BundleConfig.cs (C#檔案)：</strong></p>
                                            <ul class="small mb-0" style="margin-left: 15px;">
                                                <li>程式化設定，使用 C# 語法</li>
                                                <li>程式碼方式，需重新編譯</li>
                                                <li>支援複雜的邏輯和條件判斷</li>
                                                <li>可動態建立 Bundle 設定</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-secondary text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-box me-2"></i>packages.config</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>NuGet 套件管理檔案</p>
                                    <p class="card-text small"><strong>記錄內容：</strong></p>
                                    <ul class="small mb-2">
                                        <li>已安裝的套件名稱</li>
                                        <li>套件版本號</li>
                                        <li>目標 Framework 版本</li>
                                        <li>套件相依性</li>
                                    </ul>
                                    <p class="card-text small"><strong>注意：</strong>不要手動編輯此檔案</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">                                       
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-mobile-alt me-2"></i>ViewSwitcher.ascx</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>使用者控制項</p>
                                    <p class="card-text small"><strong>功能：</strong></p>
                                    <ul class="small mb-2">
                                        <li>桌面版/行動版切換</li>
                                        <li>響應式設計輔助</li>
                                        <li>使用者體驗優化</li>
                                        <li>可重複使用元件</li>
                                    </ul>
                                    <p class="card-text small"><strong>檔案：</strong></p>
                                    <ul class="small mb-0">
                                        <li>ViewSwitcher.ascx - 介面</li>
                                        <li>ViewSwitcher.ascx.cs - 邏輯</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-image me-2"></i>favicon.ico</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>網站圖示檔案</p>
                                    <p class="card-text small"><strong>顯示位置：</strong></p>
                                    <ul class="small mb-2">
                                        <li>瀏覽器分頁標籤</li>
                                        <li>書籤列</li>
                                        <li>桌面捷徑</li>
                                        <li>搜尋引擎結果</li>
                                    </ul>
                                    <p class="card-text small"><strong>建議：</strong>使用 16x16 或 32x32 像素的 .ico 檔案</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="aspnet-structure-folders" class="mb-4">
                    <h4 class="text-dark">3.3 核心資料夾解析</h4>
                    
                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-folder me-2"></i>App_Data 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-database me-2"></i>App_Data 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>主要用途：</strong></p>
                                    <ul class="small mb-3">
                                        <li>存放應用程式資料檔案</li>
                                        <li>Local DB 資料庫檔案 (.mdf)</li>
                                        <li>XML 資料檔案</li>
                                        <li>JSON 設定檔案</li>
                                        <li>SQLite 資料庫檔案</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>安全特性：</strong></p>
                                    <ul class="small mb-3">
                                        <li>IIS 預設拒絕直接存取</li>
                                        <li>無法透過瀏覽器直接下載</li>
                                        <li>適合存放敏感資料</li>
                                        <li>自動受到 Web.config 保護</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">典型內容範例：</h6>
                                <pre class="mb-0 small"><code>📁 App_Data/
├─ 📄 Database.mdf           <span class="text-muted">// SQL Server LocalDB 資料庫主檔</span>
├─ 📄 Database_Log.ldf       <span class="text-muted">// SQL Server 交易日誌檔</span>
├─ 📄 users.xml              <span class="text-muted">// XML 格式的使用者資料</span>
├─ 📄 settings.json          <span class="text-muted">// JSON 設定檔案</span>
└─ 📄 backup.bak             <span class="text-muted">// 資料庫備份檔案</span></code></pre>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-rocket me-2"></i>App_Start 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-play me-2"></i>App_Start 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>功能目的：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式啟動時的初始化設定</li>
                                        <li>路由規則設定</li>
                                        <li>資源打包與壓縮設定</li>
                                        <li>篩選器設定</li>
                                        <li>相依性注入設定</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>執行時機：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式首次啟動時</li>
                                        <li>在 Global.asax Application_Start 之後</li>
                                        <li>只執行一次</li>
                                        <li>設定全域規則</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2">BundleConfig.cs 範例：</h6>
                                <pre class="mb-0 small"><code>public class BundleConfig
{
    public static void RegisterBundles(BundleCollection bundles)
    {
        // JavaScript 打包
        bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-{version}.js"));
        
        // CSS 打包
        bundles.Add(new StyleBundle("~/Content/css").Include(
                    "~/Content/bootstrap.css",
                    "~/Content/site.css"));
    }
}</code></pre>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">RouteConfig.cs 範例：</h6>
                                <pre class="mb-0 small"><code>public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.EnableFriendlyUrls();
        routes.MapPageRoute("ProductDetails", 
                           "products/{id}", 
                           "~/ProductDetails.aspx");
    }
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-palette me-2"></i>Content 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-dark">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-css3-alt me-2"></i>Content 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>存放內容：</strong></p>
                                    <ul class="small mb-3">
                                        <li>CSS 樣式表檔案</li>
                                        <li>字型檔案 (fonts)</li>
                                        <li>圖片資源 (images)</li>
                                        <li>主題檔案 (themes)</li>
                                        <li>SASS/LESS 原始檔</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>組織結構：</strong></p>
                                    <ul class="small mb-3">
                                        <li>bootstrap.css - Bootstrap 框架</li>
                                        <li>Site.css - 網站自訂樣式</li>
                                        <li>themes/ - 主題資料夾</li>
                                        <li>images/ - 圖片檔案</li>
                                        <li>fonts/ - 字型檔案</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2">典型 Content 結構：</h6>
                                <pre class="mb-0 small"><code>📁 Content/
├─ 📄 bootstrap.css          <span class="text-muted">// Bootstrap CSS 框架</span>
├─ 📄 bootstrap.min.css      <span class="text-muted">// Bootstrap 壓縮版</span>
├─ 📄 Site.css               <span class="text-muted">// 網站主要樣式</span>
├─ 📁 themes/                <span class="text-muted">// 主題檔案夾</span>
│  ├─ 📄 blue-theme.css      <span class="text-muted">// 藍色主題</span>
│  └─ 📄 dark-theme.css      <span class="text-muted">// 暗色主題</span>
├─ 📁 images/                <span class="text-muted">// 圖片資源</span>
│  ├─ 🖼️ logo.png            <span class="text-muted">// 網站標誌</span>
│  └─ 🖼️ banner.jpg          <span class="text-muted">// 橫幅圖片</span>
└─ 📁 fonts/                 <span class="text-muted">// 字型檔案</span>
   ├─ 📄 custom-font.woff    <span class="text-muted">// 自訂字型</span>
   └─ 📄 icons.ttf           <span class="text-muted">// 圖示字型</span></code></pre>
                            </div>
                            <div class="alert alert-info">
                                <small><i class="fa-solid fa-lightbulb me-2"></i><strong>最佳實踐：</strong>使用相對路徑引用 Content 中的檔案，例如：<code>~/Content/Site.css</code></small>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>Scripts 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h6 class="card-title mb-0"><i class="fa-brands fa-js me-2"></i>Scripts 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>存放內容：</strong></p>
                                    <ul class="small mb-3">
                                        <li>JavaScript 檔案</li>
                                        <li>jQuery 函式庫</li>
                                        <li>Bootstrap JavaScript</li>
                                        <li>第三方 JS 套件</li>
                                        <li>自訂 JavaScript 功能</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案類型：</strong></p>
                                    <ul class="small mb-3">
                                        <li>.js - 一般 JavaScript 檔案</li>
                                        <li>.min.js - 壓縮版本</li>
                                        <li>.map - Source Map 檔案</li>
                                        <li>TypeScript 編譯後的檔案</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2">引用 Scripts 的方式：</h6>
                                <pre class="mb-0 small"><code>&lt;!-- 在 .aspx 頁面中引用 --&gt;
&lt;script src="&lt;%= ResolveUrl("~/Scripts/jquery-3.4.1.min.js") %&gt;"&gt;&lt;/script&gt;

&lt;!-- 使用 Bundle 打包引用 --&gt;
&lt;%: Scripts.Render("~/bundles/jquery") %&gt;

&lt;!-- 條件式載入 --&gt;
&lt;% if (!IsDebug) { %&gt;
    &lt;script src="~/Scripts/site.min.js"&gt;&lt;/script&gt;
&lt;% } else { %&gt;
    &lt;script src="~/Scripts/site.js"&gt;&lt;/script&gt;
&lt;% } %&gt;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

            </section>
            
            <section id="aspnet-ui" class="py-3">
                <h2 class="text-warning fw-bold border-bottom pb-2 mb-3"><span class="badge bg-warning me-2">4</span>設計網頁介面</h2>
                
                <div id="aspnet-ui-designer" class="mb-4">
                    <h4 class="text-dark">4.1 使用設計器與原始碼編輯</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-paint-brush me-2"></i>Visual Studio 設計模式</h5>
                        <p class="mb-0">Visual Studio 提供三種編輯模式：設計檢視、原始碼檢視和分割檢視，讓開發者能靈活設計網頁介面。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-eye me-2"></i>三種編輯模式</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-desktop me-2 text-primary"></i>設計檢視 (Design)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>視覺化拖拉操作</p>
                                    <p class="card-text small"><strong>優點：</strong>直觀、快速佈局</p>
                                    <p class="card-text small"><strong>適用：</strong>初學者、快速原型</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-code me-2 text-success"></i>原始碼檢視 (Source)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>直接編輯 HTML/ASPX</p>
                                    <p class="card-text small"><strong>優點：</strong>精確控制、效能最佳</p>
                                    <p class="card-text small"><strong>適用：</strong>進階開發者</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-columns me-2 text-info"></i>分割檢視 (Split)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>同時顯示設計與原始碼</p>
                                    <p class="card-text small"><strong>優點：</strong>即時預覽變更</p>
                                    <p class="card-text small"><strong>適用：</strong>學習階段</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-mouse-pointer me-2"></i>工具箱使用</h5>
                    
                    <div class="bg-light p-3 rounded mb-3">
                        <h6 class="mb-2">從工具箱拖拉控制項到頁面：</h6>
                        <ol class="small mb-0">
                            <li>開啟 Visual Studio 的「工具箱」視窗</li>
                            <li>展開「標準」或「資料」分類</li>
                            <li>選擇所需的控制項（如 Button、Label、TextBox）</li>
                            <li>拖拉到設計檢視的目標位置</li>
                            <li>在屬性視窗中調整控制項屬性</li>
                        </ol>
                    </div>
                </div>

                <div id="aspnet-ui-controls" class="mb-4">
                    <h4 class="text-dark">4.2 常用伺服器控制項</h4>
                    
                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-puzzle-piece me-2"></i>基本輸入控制項</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-warning">
                                <tr>
                                    <th>控制項</th>
                                    <th>用途</th>
                                    <th>常用屬性</th>
                                    <th>程式碼範例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>Label</code></td>
                                    <td>顯示文字</td>
                                    <td>Text, CssClass</td>
                                    <td><code>&lt;asp:Label ID="lblName" runat="server" Text="姓名" /&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>TextBox</code></td>
                                    <td>單行文字輸入</td>
                                    <td>Text, MaxLength</td>
                                    <td><code>&lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" /&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>Button</code></td>
                                    <td>觸發事件按鈕</td>
                                    <td>Text, OnClick</td>
                                    <td><code>&lt;asp:Button ID="btnSubmit" runat="server" Text="送出" OnClick="btnSubmit_Click" /&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>DropDownList</code></td>
                                    <td>下拉選單</td>
                                    <td>Items, SelectedValue</td>
                                    <td><code>&lt;asp:DropDownList ID="ddlCity" runat="server" CssClass="form-select"&gt;
            &lt;asp:ListItem Text="請選擇" Value="" /&gt;
            &lt;asp:ListItem Text="台北" Value="Taipei" /&gt;
            &lt;asp:ListItem Text="台中" Value="Taichung" /&gt;
            &lt;asp:ListItem Text="高雄" Value="Kaohsiung" /&gt;
        &lt;/asp:DropDownList&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>CheckBox</code></td>
                                    <td>勾選框</td>
                                    <td>Checked, Text</td>
                                    <td><code>&lt;asp:CheckBox ID="chkAgree" runat="server" Text="我同意" /&gt;</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-table me-2"></i>資料顯示控制項</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-th me-2"></i>GridView</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>表格形式顯示資料</p>
                                    <p class="card-text small"><strong>特色：</strong>支援分頁、排序、編輯</p>
                                    <div class="bg-light p-2 rounded mt-2">
                                        <code class="small">&lt;asp:GridView ID="gvUsers" runat="server" AutoGenerateColumns="false"&gt;<br>
                                        &nbsp;&nbsp;&lt;Columns&gt;<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;asp:BoundField DataField="Name" HeaderText="姓名" /&gt;<br>
                                        &nbsp;&nbsp;&lt;/Columns&gt;<br>
                                        &lt;/asp:GridView&gt;</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-repeat me-2"></i>Repeater</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>重複顯示資料模板</p>
                                    <p class="card-text small"><strong>特色：</strong>完全自訂 HTML 輸出</p>
                                    <div class="bg-light p-2 rounded mt-2">
                                        <code class="small">&lt;asp:Repeater ID="rptNews" runat="server"&gt;<br>
                                        &nbsp;&nbsp;&lt;ItemTemplate&gt;<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;%# Eval("Title") %&lt;/div&gt;<br>
                                        &nbsp;&nbsp;&lt;/ItemTemplate&gt;<br>
                                        &lt;/asp:Repeater&gt;</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>容器控制項</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-square me-2 text-primary"></i>Panel</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small">產生 &lt;div&gt; 標籤的容器</p>
                                    <p class="card-text small">可控制顯示/隱藏</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-grip me-2 text-success"></i>PlaceHolder</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small">不產生額外 HTML 標籤</p>
                                    <p class="card-text small">適合動態加入控制項</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-window-maximize me-2 text-info"></i>MultiView</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small">多頁面切換容器</p>
                                    <p class="card-text small">類似分頁效果</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>完整範例：用戶註冊表單</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <pre class="mb-0"><code>&lt;!-- 用戶註冊表單範例 --&gt;
&lt;asp:Panel ID="pnlRegister" runat="server" CssClass="container"&gt;
    &lt;h3&gt;用戶註冊&lt;/h3&gt;
    
    &lt;!-- 姓名輸入 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblName" runat="server" Text="姓名：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" MaxLength="50" /&gt;
    &lt;/div&gt;
    
    &lt;!-- Email 輸入 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblEmail" runat="server" Text="Email：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" TextMode="Email" /&gt;
    &lt;/div&gt;
    
    &lt;!-- 城市選擇 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblCity" runat="server" Text="城市：" CssClass="form-label" /&gt;
        &lt;asp:DropDownList ID="ddlCity" runat="server" CssClass="form-select"&gt;
            &lt;asp:ListItem Text="請選擇" Value="" /&gt;
            &lt;asp:ListItem Text="台北" Value="Taipei" /&gt;
            &lt;asp:ListItem Text="台中" Value="Taichung" /&gt;
            &lt;asp:ListItem Text="高雄" Value="Kaohsiung" /&gt;
        &lt;/asp:DropDownList&gt;
    &lt;/div&gt;
    
    &lt;!-- 同意條款 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:CheckBox ID="chkAgree" runat="server" Text="我同意服務條款" CssClass="form-check-input" /&gt;
    &lt;/div&gt;
    
    &lt;!-- 送出按鈕 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Button ID="btnRegister" runat="server" Text="註冊" CssClass="btn btn-primary" 
                    OnClick="btnRegister_Click" /&gt;
        &lt;asp:Button ID="btnCancel" runat="server" Text="取消" CssClass="btn btn-secondary ms-2" 
                    OnClick="btnCancel_Click" /&gt;
    &lt;/div&gt;
    
    &lt;!-- 訊息顯示 --&gt;
    &lt;asp:Label ID="lblMessage" runat="server" CssClass="alert alert-info" Visible="false" /&gt;
&lt;/asp:Panel&gt;</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-tips me-2"></i>設計介面小技巧</h6>
                        <ul class="mb-0 small">
                            <li><strong>使用 Bootstrap CSS 類別</strong>讓介面更美觀現代</li>
                            <li><strong>善用 Panel 控制項</strong>組織和群組相關控制項</li>
                            <li><strong>設定有意義的 ID</strong>便於後續程式碼維護</li>
                            <li><strong>結合 HTML 與伺服器控制項</strong>達到最佳的彈性</li>
                            <li><strong>預覽不同瀏覽器</strong>確保跨瀏覽器相容性</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-logic" class="py-3">
                <h2 class="text-danger fw-bold border-bottom pb-2 mb-3"><span class="badge bg-danger me-2">5</span>事件處理與程式邏輯</h2>
                <div id="aspnet-logic-lifecycle" class="mb-4">
                    <h4 class="text-dark">5.1 Page Life Cycle（頁面生命週期）</h4>
                    
                    <div class="alert alert-danger border-start border-4 border-danger">
                        <h5 class="alert-heading"><i class="fa-solid fa-recycle me-2"></i>什麼是 Page Life Cycle？</h5>
                        <p class="mb-0">Page Life Cycle 是 ASP.NET Web Forms 的核心概念，描述了當 HTTP 請求達到伺服器時，頁面物件從建立到銷毀的完整過程。</p>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-timeline me-2"></i>主要生命週期階段</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-danger">
                                <tr>
                                    <th>階段</th>
                                    <th>事件</th>
                                    <th>用途</th>
                                    <th>常見使用</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1. 頁面初始化</strong></td>
                                    <td>PreInit</td>
                                    <td>設定主版頁面、佈景主題</td>
                                    <td>動態設定 MasterPage</td>
                                </tr>
                                <tr>
                                    <td><strong>2. 控制項初始化</strong></td>
                                    <td>Init</td>
                                    <td>初始化控制項設定</td>
                                    <td>設定控制項預設值</td>
                                </tr>
                                <tr class="table-warning">
                                    <td><strong>3. 頁面載入</strong></td>
                                    <td>Load</td>
                                    <td>主要業務邏輯處理</td>
                                    <td>最常使用的事件</td>
                                </tr>
                                <tr>
                                    <td><strong>4. 控制項事件</strong></td>
                                    <td>Control Events</td>
                                    <td>處理使用者互動</td>
                                    <td>按鈕點擊、文字改變</td>
                                </tr>
                                <tr>
                                    <td><strong>5. 頁面預渲染</strong></td>
                                    <td>PreRender</td>
                                    <td>最後的變更機會</td>
                                    <td>最終資料設定</td>
                                </tr>
                                <tr>
                                    <td><strong>6. 頁面銷毀</strong></td>
                                    <td>Unload</td>
                                    <td>清理資源</td>
                                    <td>關閉資料庫連線</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實用程式碼範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">完整的生命週期事件處理：</h6>
                        <pre class="mb-0"><code>public partial class Default : System.Web.UI.Page
{
    protected void Page_PreInit(object sender, EventArgs e)
    {
        // 1. 頁面初始化階段 - 動態設定 MasterPage
        if (Session["UserType"] != null && Session["UserType"].ToString() == "Admin")
        {
            this.MasterPageFile = "~/Admin.master";
        }
    }

    protected void Page_Init(object sender, EventArgs e)
    {
        // 2. 控制項初始化階段 - 設定控制項屬性
        Button dynButton = new Button();
        dynButton.ID = "btnDynamic";
        dynButton.Text = "動態按鈕";
        dynButton.Click += DynButton_Click;
        this.form1.Controls.Add(dynButton);
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        // 3. 頁面載入階段 - 最常使用
        if (!IsPostBack)
        {
            // 首次載入時執行
            LoadInitialData();
        }
    }

    // 4. 控制項事件階段
    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        // 處理按鈕點擊事件
    }

    protected void Page_PreRender(object sender, EventArgs e)
    {
        // 5. 預渲染階段 - 最後的 UI 調整
        this.Title = "頁面已就緒 - " + DateTime.Now.ToString("HH:mm:ss");
    }

    protected void Page_Unload(object sender, EventArgs e)
    {
        // 6. 頁面銷毀階段 - 清理資源
        if (dbConnection != null)
        {
            dbConnection.Close();
            dbConnection.Dispose();
        }
    }
}</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-star me-2"></i>最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>Page_Load</strong> 是最常使用的事件，適合大部分業務邏輯</li>
                            <li>使用 <strong>IsPostBack</strong> 區分首次載入和 PostBack</li>
                            <li><strong>PreInit</strong> 用於動態設定 MasterPage 或 Theme</li>
                            <li><strong>PreRender</strong> 適合最後的 UI 調整</li>
                            <li><strong>Unload</strong> 用於清理資源，但不能使用 Response 物件</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-logic-events" class="mb-4">
                    <h4 class="text-dark">5.2 控制項事件（Click、TextChanged 等）</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-mouse-pointer me-2"></i>控制項事件處理</h5>
                        <p class="mb-0">控制項事件是 Web Forms 互動性的核心，讓開發者能夠回應使用者的各種操作行為。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-list me-2"></i>常用控制項事件</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-info">
                                <tr>
                                    <th>控制項</th>
                                    <th>事件</th>
                                    <th>觸發時機</th>
                                    <th>常見用途</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Button</strong></td>
                                    <td>Click</td>
                                    <td>點擊按鈕</td>
                                    <td>表單提交、操作執行</td>
                                </tr>
                                <tr>
                                    <td><strong>TextBox</strong></td>
                                    <td>TextChanged</td>
                                    <td>文字改變且失去焦點</td>
                                    <td>即時檢查、資料驗證</td>
                                </tr>
                                <tr>
                                    <td><strong>DropDownList</strong></td>
                                    <td>SelectedIndexChanged</td>
                                    <td>選項改變</td>
                                    <td>級聯選單、動態築選</td>
                                </tr>
                                <tr>
                                    <td><strong>CheckBox</strong></td>
                                    <td>CheckedChanged</td>
                                    <td>勾選狀態改變</td>
                                    <td>功能開關、選項控制</td>
                                </tr>
                                <tr>
                                    <td><strong>GridView</strong></td>
                                    <td>RowCommand</td>
                                    <td>資料列操作</td>
                                    <td>編輯、刪除、查看</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>Button Click 事件範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">ASPX 頁面：</h6>
                        <pre class="mb-3"><code>&lt;asp:Button ID="btnCalculate" runat="server" Text="計算" 
        CssClass="btn btn-primary" OnClick="btnCalculate_Click" /&gt;
&lt;asp:Label ID="lblResult" runat="server" CssClass="ms-2" /&gt;</code></pre>
                        
                        <h6 class="mb-2">C# 程式碼：</h6>
                        <pre class="mb-0"><code>protected void btnCalculate_Click(object sender, EventArgs e)
{
    try
    {
        int num1 = Convert.ToInt32(txtNumber1.Text);
        int num2 = Convert.ToInt32(txtNumber2.Text);
        int result = num1 + num2;
        
        lblResult.Text = $"{num1} + {num2} = {result}";
        lblResult.CssClass = "ms-2 text-success";
    }
    catch (Exception ex)
    {
        lblResult.Text = "輸入格式錯誤";
        lblResult.CssClass = "ms-2 text-danger";
    }
}</code></pre>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>注意事項</h6>
                        <ul class="mb-0 small">
                            <li><strong>AutoPostBack</strong> 會增加伺服器負載，請有節制地使用</li>
                            <li>事件處理中一定要包含 <strong>錯誤處理</strong></li>
                            <li>使用 <strong>Page.IsValid</strong> 驗證資料後再處理</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-api" class="py-3">
                <h2 class="text-success fw-bold border-bottom pb-2 mb-3"><span class="badge bg-success me-2">5</span>實作 API 與檔案處理</h2>
                
                <div id="aspnet-api-overview" class="mb-4">
                    <h4 class="text-dark">5.1 建立 RESTful API 端點</h4>
                    
                    <div class="alert alert-success border-start border-4 border-success">
                        <h5 class="alert-heading"><i class="fa-solid fa-code me-2"></i>API 實作概念</h5>
                        <p class="mb-0">在 ASP.NET Web Forms 中，可以透過建立 ASPX 頁面來實作 API 端點，處理 HTTP 請求並回傳 JSON 資料。這個範例展示了完整的 CRUD 操作實作。</p>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-globe me-2"></i>API 頁面基本架構</h5>
                    
                    <div class="bg-light p-3 rounded mb-3">
                        <h6 class="mb-2"><i class="fa-solid fa-file-code me-2"></i>Page_Load 事件處理</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>protected void Page_Load(object sender, EventArgs e)
{
    // 清除預設的 HTML 輸出
    Response.Clear();
    Response.ContentType = "application/json";
    
    // 設定 CORS 標頭（跨域請求支援）
    Response.Headers.Add("Access-Control-Allow-Origin", "*");
    Response.Headers.Add("Access-Control-Allow-Methods", "GET, POST, OPTIONS");
    Response.Headers.Add("Access-Control-Allow-Headers", "Content-Type");

    // 取得路由參數和 HTTP 方法
    string url = Page.RouteData.Values["url"] as string;
    string method = Request.HttpMethod;

    // 根據 URL 和方法路由到不同處理程序
    if (url == "article")
    {
        HandleArticleRequests(method);
    }
    else
    {
        Response.StatusCode = 404;
        Response.Write("{\"error\":\"找不到指定的API端點\"}");
    }

    Response.End();
}</code></pre>
                        </div>
                        <div class="alert alert-info mt-2">
                            <h6 class="alert-heading small"><i class="fa-solid fa-lightbulb me-1"></i>關鍵技巧</h6>
                            <ul class="small mb-0">
                                <li><strong>Response.Clear()</strong> - 清除預設 HTML 輸出</li>
                                <li><strong>ContentType</strong> - 設定回應類型為 JSON</li>
                                <li><strong>CORS 標頭</strong> - 允許跨域 AJAX 請求</li>
                                <li><strong>路由參數</strong> - 透過 RouteData.Values 取得動態參數</li>
                            </ul>
                        </div>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-download me-2"></i>處理 GET 請求（讀取資料）</h5>
                    
                    <div class="bg-light p-3 rounded mb-3">
                        <h6 class="mb-2"><i class="fa-solid fa-database me-2"></i>從 JSON 檔案讀取資料</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>private void HandleGetArticles()
{
    try
    {
        // 使用 Server.MapPath 取得實體檔案路徑
        string jsonPath = Server.MapPath("~/App_Data/article.json");
        
        if (File.Exists(jsonPath))
        {
            // 使用 UTF8 編碼讀取檔案，避免中文亂碼
            string json = File.ReadAllText(jsonPath, Encoding.UTF8);
            Response.Write(json);
        }
        else
        {
            // 檔案不存在時回傳空陣列，避免前端錯誤
            Response.Write("[]");
        }
    }
    catch (Exception ex)
    {
        // 設定錯誤狀態碼並回傳錯誤訊息
        Response.StatusCode = 500;
        Response.Write($"{{\"error\":\"讀取文章失敗: {ex.Message}\"}}");
    }
}</code></pre>
                        </div>
                        <div class="alert alert-success mt-2">
                            <h6 class="alert-heading small"><i class="fa-solid fa-check me-1"></i>最佳實踐</h6>
                            <ul class="small mb-0">
                                <li><strong>檔案存在檢查</strong> - 避免 FileNotFoundException</li>
                                <li><strong>UTF8 編碼</strong> - 確保中文字元正確顯示</li>
                                <li><strong>異常處理</strong> - 回傳適當的 HTTP 狀態碼</li>
                                <li><strong>預設值</strong> - 提供合理的預設回應</li>
                            </ul>
                        </div>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-upload me-2"></i>處理 POST 請求（新增資料）</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-form me-1"></i>表單資料處理</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0" style="font-size: 11px;"><code>private void HandleFormPostArticle()
{
    try
    {
        // 從表單取得資料並去除空白
        string title = Request.Form["title"]?.Trim();
        string content = Request.Form["content"]?.Trim();
        string date = Request.Form["date"]?.Trim();
        
        // 驗證必填欄位
        if (string.IsNullOrWhiteSpace(title) ||
            string.IsNullOrWhiteSpace(content) ||
            string.IsNullOrWhiteSpace(date))
        {
            // 表單提交失敗時重新導向
            string redirectUrl = "~/edit.html?error=" + 
                HttpUtility.UrlEncode("標題、內容和日期為必填欄位");
            Response.Redirect(redirectUrl, false);
            return;
        }

        // 處理檔案上傳
        string finalImagePath = "";
        if (Request.Files.Count > 0)
        {
            HttpPostedFile uploadedFile = Request.Files["imageFile"];
            if (uploadedFile?.ContentLength > 0)
            {
                finalImagePath = HandleFileUpload(uploadedFile);
            }
        }

        // 建立文章物件
        var newArticle = new
        {
            id = Guid.NewGuid().ToString(),
            title = title,
            content = content,
            date = date,
            image = finalImagePath,
            createdAt = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")
        };

        SaveArticle(newArticle);
        
        // 成功後重新導向
        Response.Redirect("~/edit.html?success=文章新增成功", false);
    }
    catch (Exception ex)
    {
        Response.Redirect($"~/edit.html?error={ex.Message}", false);
    }
}</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2"><i class="fa-solid fa-code-branch me-1"></i>JSON 資料處理</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0" style="font-size: 11px;"><code>private void HandleJsonPostArticle()
{
    try
    {
        // 讀取 POST 請求的 JSON 內容
        string jsonData;
        using (var reader = new StreamReader(
            Request.InputStream, Encoding.UTF8))
        {
            jsonData = reader.ReadToEnd();
        }

        if (string.IsNullOrWhiteSpace(jsonData))
        {
            Response.StatusCode = 400;
            Response.Write("{\"error\":\"請求內容不能為空\"}");
            return;
        }

        // 使用 Newtonsoft.Json 解析資料
        var articleData = JsonConvert.DeserializeObject&lt;dynamic&gt;(jsonData);
        
        // 驗證必填欄位
        if (string.IsNullOrWhiteSpace(articleData?.title?.ToString()))
        {
            Response.StatusCode = 400;
            Response.Write("{\"error\":\"標題為必填欄位\"}");
            return;
        }

        // 建立文章物件
        var newArticle = new
        {
            id = Guid.NewGuid().ToString(),
            title = articleData.title.ToString(),
            content = articleData.content.ToString(),
            date = articleData.date.ToString(),
            createdAt = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")
        };

        SaveArticle(newArticle);

        // 回傳 JSON 回應
        Response.StatusCode = 201; // Created
        Response.Write($"{{\"success\":true,\"articleId\":\"{newArticle.id}\"}}");
    }
    catch (JsonException)
    {
        Response.StatusCode = 400;
        Response.Write("{\"error\":\"JSON格式錯誤\"}");
    }
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <h6 class="alert-heading small"><i class="fa-solid fa-code me-1"></i>內容類型判斷技巧</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>// 根據 Content-Type 決定處理方式
string contentType = Request.ContentType ?? "";

if (contentType.Contains("application/x-www-form-urlencoded") || 
    contentType.Contains("multipart/form-data"))
{
    // 處理 HTML 表單提交
    HandleFormPostArticle();
}
else
{
    // 處理 JSON 提交
    HandleJsonPostArticle();
}</code></pre>
                        </div>
                        <p class="small mb-0 mt-2"><strong>說明：</strong>同一個 API 端點可以同時支援表單提交和 JSON 提交，提高 API 的彈性。</p>
                    </div>
                </div>

                <div id="aspnet-file-upload" class="mb-4">
                    <h4 class="text-dark">5.2 檔案上傳處理</h4>
                    
                    <div class="bg-light p-3 rounded mb-3">
                        <h6 class="mb-2"><i class="fa-solid fa-shield-alt me-2"></i>安全的檔案上傳實作</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>private string HandleFileUpload(HttpPostedFile uploadedFile)
{
    // 1. 檢查檔案類型（白名單方式）
    string[] allowedExtensions = { ".jpg", ".jpeg", ".png", ".gif", ".bmp" };
    string fileExtension = Path.GetExtension(uploadedFile.FileName).ToLower();
    
    if (!allowedExtensions.Contains(fileExtension))
    {
        throw new Exception("不支援的檔案類型。請上傳 JPG, PNG, GIF 或 BMP 格式的圖片。");
    }

    // 2. 檢查檔案大小限制
    int maxFileSize = 5 * 1024 * 1024; // 5MB
    if (uploadedFile.ContentLength > maxFileSize)
    {
        throw new Exception("檔案大小不能超過 5MB。");
    }

    // 3. 確保上傳目錄存在
    string uploadDir = Server.MapPath("~/uploads/images/");
    if (!Directory.Exists(uploadDir))
    {
        Directory.CreateDirectory(uploadDir);
    }

    // 4. 生成安全的唯一檔名
    string guidPart = Guid.NewGuid().ToString("N").Substring(0, 8);
    string fileName = $"{DateTime.Now:yyyyMMdd_HHmmss}_{guidPart}{fileExtension}";
    string filePath = Path.Combine(uploadDir, fileName);

    // 5. 儲存檔案
    uploadedFile.SaveAs(filePath);

    // 6. 回傳網頁可存取的相對路徑
    return $"uploads/images/{fileName}";
}</code></pre>
                        </div>
                        <div class="alert alert-danger mt-2">
                            <h6 class="alert-heading small"><i class="fa-solid fa-exclamation-triangle me-1"></i>檔案上傳安全要點</h6>
                            <ul class="small mb-0">
                                <li><strong>檔案類型驗證</strong> - 使用白名單，避免上傳可執行檔案</li>
                                <li><strong>檔案大小限制</strong> - 防止大檔案攻擊</li>
                                <li><strong>檔名重新命名</strong> - 避免檔名衝突和路徑穿越攻擊</li>
                                <li><strong>目錄權限控制</strong> - 上傳目錄不應有執行權限</li>
                                <li><strong>病毒掃描</strong> - 正式環境建議加入防毒檢查</li>
                            </ul>
                        </div>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-cog me-2"></i>Web.config 檔案上傳設定</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">增加檔案上傳限制設定：</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>&lt;system.web&gt;
  &lt;!-- 設定最大檔案上傳大小 (單位: KB) --&gt;
  &lt;httpRuntime maxRequestLength="51200" executionTimeout="300" /&gt;
&lt;/system.web&gt;

&lt;system.webServer&gt;
  &lt;security&gt;
    &lt;requestFiltering&gt;
      &lt;!-- IIS 層級的檔案大小限制 (單位: bytes) --&gt;
      &lt;requestLimits maxAllowedContentLength="52428800" /&gt;
    &lt;/requestFiltering&gt;
  &lt;/security&gt;
&lt;/system.webServer&gt;</code></pre>
                        </div>
                        <p class="small text-muted mt-2"><strong>說明：</strong>需要同時設定 ASP.NET 和 IIS 的檔案大小限制，兩者取較小值。</p>
                    </div>
                </div>

                <div id="aspnet-json-processing" class="mb-4">
                    <h4 class="text-dark">5.3 JSON 資料處理與儲存</h4>
                    
                    <div class="bg-light p-3 rounded mb-3">
                        <h6 class="mb-2"><i class="fa-solid fa-save me-2"></i>JSON 檔案讀寫操作</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>private void SaveArticle(object newArticle)
{
    // 取得 JSON 檔案路徑
    string jsonPath = Server.MapPath("~/App_Data/article.json");
    List&lt;object&gt; articles = new List&lt;object&gt;();

    // 讀取現有資料
    if (File.Exists(jsonPath))
    {
        try
        {
            string existingJson = File.ReadAllText(jsonPath, Encoding.UTF8);
            if (!string.IsNullOrWhiteSpace(existingJson))
            {
                articles = JsonConvert.DeserializeObject&lt;List&lt;object&gt;&gt;(existingJson) ?? new List&lt;object&gt;();
            }
        }
        catch
        {
            // JSON 格式錯誤時建立新列表
            articles = new List&lt;object&gt;();
        }
    }

    // 新文章插入到列表開頭（最新的在前面）
    articles.Insert(0, newArticle);

    // 確保目錄存在
    string appDataPath = Server.MapPath("~/App_Data/");
    if (!Directory.Exists(appDataPath))
    {
        Directory.CreateDirectory(appDataPath);
    }

    // 儲存回 JSON 檔案（使用縮排格式便於閱讀）
    string updatedJson = JsonConvert.SerializeObject(articles, Formatting.Indented);
    File.WriteAllText(jsonPath, updatedJson, Encoding.UTF8);
}</code></pre>
                        </div>
                        <div class="alert alert-info mt-2">
                            <h6 class="alert-heading small"><i class="fa-solid fa-lightbulb me-1"></i>JSON 處理技巧</h6>
                            <ul class="small mb-0">
                                <li><strong>錯誤處理</strong> - JSON 格式錯誤時不影響程式運行</li>
                                <li><strong>編碼一致性</strong> - 統一使用 UTF-8 避免亂碼</li>
                                <li><strong>格式化輸出</strong> - Formatting.Indented 讓檔案易於閱讀</li>
                                <li><strong>空值處理</strong> - 使用 null 條件運算子避免例外</li>
                            </ul>
                        </div>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-tags me-2"></i>陣列資料處理範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">字串轉陣列的常用方法：</h6>
                        <div class="code-container">
                            <button class="copy-btn" onclick="copyCode(this)">複製</button>
                            <pre class="mb-0 small"><code>// 處理標籤字串，轉換為字串陣列
string tagsString = Request.Form["tags"]?.Trim();
string[] tagsArray = new string[0]; // 預設空陣列

if (!string.IsNullOrWhiteSpace(tagsString))
{
    tagsArray = tagsString.Split(',')           // 用逗號分割
        .Select(tag => tag.Trim())              // 去除每個標籤的空白
        .Where(tag => !string.IsNullOrEmpty(tag)) // 過濾空字串
        .ToArray();                             // 轉為陣列
}

// 在匿名物件中使用
var article = new
{
    id = Guid.NewGuid().ToString(),
    title = title,
    tags = tagsArray,  // 陣列會自動序列化為 JSON 陣列
    createdAt = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")
};</code></pre>
                        </div>
                        <p class="small text-muted mt-2"><strong>提示：</strong>使用 LINQ 方法鏈可以讓資料處理更簡潔且可讀性更高。</p>
                    </div>
                </div>

                <div id="aspnet-api-summary" class="mb-4">
                    <h4 class="text-dark">5.4 函數與用法總覽</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-list me-2"></i>本章涵蓋的重要函數與技巧</h5>
                        <p class="mb-0">以下表格整理了本章範例中使用的所有重要函數、方法和程式設計技巧，方便查閱和學習。</p>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-table me-2"></i>核心函數與方法總覽</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th style="width: 20%;">分類</th>
                                    <th style="width: 25%;">函數/方法</th>
                                    <th style="width: 35%;">說明</th>
                                    <th style="width: 20%;">使用範例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- HTTP 處理相關 -->
                                <tr class="table-warning">
                                    <td rowspan="6"><strong>HTTP 處理</strong></td>
                                    <td><code>Response.Clear()</code></td>
                                    <td>清除預設 HTML 輸出，準備回傳自訂內容</td>
                                    <td>API 端點必用</td>
                                </tr>
                                <tr>
                                    <td><code>Response.ContentType</code></td>
                                    <td>設定回應內容類型</td>
                                    <td><code>"application/json"</code></td>
                                </tr>
                                <tr>
                                    <td><code>Response.Headers.Add()</code></td>
                                    <td>添加 HTTP 標頭（如 CORS）</td>
                                    <td>跨域請求支援</td>
                                </tr>
                                <tr>
                                    <td><code>Request.HttpMethod</code></td>
                                    <td>取得 HTTP 請求方法</td>
                                    <td>GET, POST, OPTIONS</td>
                                </tr>
                                <tr>
                                    <td><code>Request.ContentType</code></td>
                                    <td>檢查請求內容類型</td>
                                    <td>區分表單或 JSON</td>
                                </tr>
                                <tr>
                                    <td><code>Response.StatusCode</code></td>
                                    <td>設定 HTTP 狀態碼</td>
                                    <td>200, 400, 404, 500</td>
                                </tr>
                                
                                <!-- 路由與參數 -->
                                <tr class="table-info">
                                    <td rowspan="3"><strong>路由與參數</strong></td>
                                    <td><code>Page.RouteData.Values</code></td>
                                    <td>取得路由參數值</td>
                                    <td><code>Values["url"]</code></td>
                                </tr>
                                <tr>
                                    <td><code>Request.Form[]</code></td>
                                    <td>取得表單提交的資料</td>
                                    <td><code>Request.Form["title"]</code></td>
                                </tr>
                                <tr>
                                    <td><code>Request.InputStream</code></td>
                                    <td>讀取 POST 請求的原始內容</td>
                                    <td>JSON 資料解析</td>
                                </tr>
                                
                                <!-- 檔案處理 -->
                                <tr class="table-success">
                                    <td rowspan="7"><strong>檔案處理</strong></td>
                                    <td><code>Server.MapPath()</code></td>
                                    <td>將虛擬路徑轉為實體路徑</td>
                                    <td><code>~/App_Data/</code></td>
                                </tr>
                                <tr>
                                    <td><code>File.Exists()</code></td>
                                    <td>檢查檔案是否存在</td>
                                    <td>避免 FileNotFoundException</td>
                                </tr>
                                <tr>
                                    <td><code>File.ReadAllText()</code></td>
                                    <td>讀取整個文字檔案</td>
                                    <td>指定 UTF8 編碼</td>
                                </tr>
                                <tr>
                                    <td><code>File.WriteAllText()</code></td>
                                    <td>寫入文字到檔案</td>
                                    <td>儲存 JSON 資料</td>
                                </tr>
                                <tr>
                                    <td><code>Directory.Exists()</code></td>
                                    <td>檢查目錄是否存在</td>
                                    <td>建立上傳目錄前檢查</td>
                                </tr>
                                <tr>
                                    <td><code>Directory.CreateDirectory()</code></td>
                                    <td>建立目錄（包含父目錄）</td>
                                    <td>自動建立上傳資料夾</td>
                                </tr>
                                <tr>
                                    <td><code>Path.GetExtension()</code></td>
                                    <td>取得檔案副檔名</td>
                                    <td>檔案類型驗證</td>
                                </tr>
                                
                                <!-- JSON 處理 -->
                                <tr class="table-primary">
                                    <td rowspan="3"><strong>JSON 處理</strong></td>
                                    <td><code>JsonConvert.SerializeObject()</code></td>
                                    <td>物件序列化為 JSON 字串</td>
                                    <td>Newtonsoft.Json 套件</td>
                                </tr>
                                <tr>
                                    <td><code>JsonConvert.DeserializeObject()</code></td>
                                    <td>JSON 字串反序列化為物件</td>
                                    <td>支援 dynamic 類型</td>
                                </tr>
                                <tr>
                                    <td><code>Formatting.Indented</code></td>
                                    <td>格式化 JSON 輸出</td>
                                    <td>便於閱讀和偵錯</td>
                                </tr>
                                
                                <!-- 字串處理 -->
                                <tr class="table-secondary">
                                    <td rowspan="5"><strong>字串處理</strong></td>
                                    <td><code>string.IsNullOrWhiteSpace()</code></td>
                                    <td>檢查字串是否為空或空白</td>
                                    <td>輸入驗證必用</td>
                                </tr>
                                <tr>
                                    <td><code>string.Trim()</code></td>
                                    <td>移除字串前後空白</td>
                                    <td>清理使用者輸入</td>
                                </tr>
                                <tr>
                                    <td><code>string.Split()</code></td>
                                    <td>分割字串為陣列</td>
                                    <td>處理標籤列表</td>
                                </tr>
                                <tr>
                                    <td><code>HttpUtility.UrlEncode()</code></td>
                                    <td>URL 編碼字串</td>
                                    <td>安全傳遞參數</td>
                                </tr>
                                <tr>
                                    <td><code>Guid.NewGuid()</code></td>
                                    <td>產生唯一識別碼</td>
                                    <td>檔名和 ID 生成</td>
                                </tr>
                                
                                <!-- LINQ 方法 -->
                                <tr class="table-warning">
                                    <td rowspan="4"><strong>LINQ 方法</strong></td>
                                    <td><code>.Select()</code></td>
                                    <td>投影轉換每個元素</td>
                                    <td>資料格式轉換</td>
                                </tr>
                                <tr>
                                    <td><code>.Where()</code></td>
                                    <td>篩選符合條件的元素</td>
                                    <td>過濾空字串</td>
                                </tr>
                                <tr>
                                    <td><code>.ToArray()</code></td>
                                    <td>轉換為陣列</td>
                                    <td>終止 LINQ 查詢</td>
                                </tr>
                                <tr>
                                    <td><code>.Contains()</code></td>
                                    <td>檢查集合是否包含元素</td>
                                    <td>檔案類型白名單檢查</td>
                                </tr>
                                
                                <!-- 日期時間 -->
                                <tr class="table-info">
                                    <td rowspan="2"><strong>日期時間</strong></td>
                                    <td><code>DateTime.Now</code></td>
                                    <td>取得目前日期時間</td>
                                    <td>記錄建立時間</td>
                                </tr>
                                <tr>
                                    <td><code>DateTime.ToString()</code></td>
                                    <td>格式化日期時間為字串</td>
                                    <td><code>"yyyy-MM-dd HH:mm:ss"</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>重要程式設計模式</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0"><i class="fa-solid fa-pattern me-1"></i>匿名物件使用</h6>
                                </div>
                                <div class="card-body">
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-2 small"><code>var newArticle = new
{
    id = Guid.NewGuid().ToString(),
    title = title,
    content = content,
    tags = tagsArray,
    createdAt = DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")
};</code></pre>
                                    </div>
                                    <p class="small mb-0"><strong>優點：</strong>無需定義類別即可建立結構化資料，適合 JSON 序列化。</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="mb-0"><i class="fa-solid fa-chain me-1"></i>LINQ 方法鏈</h6>
                                </div>
                                <div class="card-body">
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-2 small"><code>tagsArray = tagsString.Split(',')
    .Select(tag => tag.Trim())
    .Where(tag => !string.IsNullOrEmpty(tag))
    .ToArray();</code></pre>
                                    </div>
                                    <p class="small mb-0"><strong>優點：</strong>鏈式呼叫讓程式碼更簡潔、可讀性更高。</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-info text-white">
                                    <h6 class="mb-0"><i class="fa-solid fa-shield me-1"></i>安全檔名生成</h6>
                                </div>
                                <div class="card-body">
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-2 small"><code>string guidPart = Guid.NewGuid().ToString("N").Substring(0, 8);
string fileName = $"{DateTime.Now:yyyyMMdd_HHmmss}_{guidPart}{fileExtension}";
// 結果：20241001_143022_a1b2c3d4.jpg</code></pre>
                                    </div>
                                    <p class="small mb-0"><strong>優點：</strong>時間戳 + GUID 確保檔名唯一性和安全性。</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="mb-0"><i class="fa-solid fa-bug me-1"></i>異常處理模式</h6>
                                </div>
                                <div class="card-body">
                                    <div class="code-container">
                                        <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                        <pre class="mb-2 small"><code>try
{
    // 主要邏輯
}
catch (JsonException)
{
    Response.StatusCode = 400;
    Response.Write("{\"error\":\"JSON格式錯誤\"}");
}
catch (Exception ex)
{
    Response.StatusCode = 500;
    Response.Write($"{{\"error\":\"{ex.Message}\"}}");
}</code></pre>
                                    </div>
                                    <p class="small mb-0"><strong>優點：</strong>分層異常處理，不同錯誤回傳適當狀態碼。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-success mt-4">
                    <h6 class="alert-heading"><i class="fa-solid fa-graduation-cap me-2"></i>本章重點總結</h6>
                    <div class="row">
                        <div class="col-md-6">
                            <p class="small mb-1"><strong>API 開發要點：</strong></p>
                            <ul class="small mb-2">
                                <li>正確設定 Content-Type 和 CORS</li>
                                <li>根據 HTTP 方法路由請求</li>
                                <li>適當的錯誤處理和狀態碼</li>
                                <li>支援多種資料格式輸入</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <p class="small mb-1"><strong>安全性考量：</strong></p>
                            <ul class="small mb-2">
                                <li>檔案上傳類型和大小驗證</li>
                                <li>輸入資料驗證和清理</li>
                                <li>使用安全的檔名生成</li>
                                <li>適當的錯誤訊息處理</li>
                            </ul>
                        </div>
                    </div>
                    <p class="small mb-0"><i class="fa-solid fa-star me-1"></i><strong>最佳實踐：</strong>這個範例展示了在 Web Forms 中實作現代化 API 的完整流程，包含資料驗證、檔案處理、錯誤處理等實務技巧。</p>
                </div>
            </section>

            <section id="aspnet-data" class="py-3">
                <h2 class="text-primary fw-bold border-bottom pb-2 mb-3"><span class="badge bg-primary me-2">7</span>資料繫結與資料庫操作</h2>
                <div id="aspnet-data-binding" class="mb-4">
                    <h4 class="text-dark">6.1 使用 SqlDataSource、GridView 顯示資料</h4>
                    
                    <div class="alert alert-primary border-start border-4 border-primary">
                        <h5 class="alert-heading"><i class="fa-solid fa-table me-2"></i>資料繫結概念</h5>
                        <p class="mb-0">資料繫結是 Web Forms 的核心功能，允許控制項自動連接到資料來源，大幅簡化資料顯示和操作。</p>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-database me-2"></i>SqlDataSource 設定</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Web.config 連線字串設定：</h6>
                        <pre class="mb-3"><code>&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="DefaultConnection" 
         connectionString="Data Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\\Database.mdf;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
                        
                        <h6 class="mb-2">ASPX 頁面 SqlDataSource 宣告：</h6>
                        <pre class="mb-0"><code>&lt;asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="&lt;%$ ConnectionStrings:DefaultConnection %&gt;"
    SelectCommand="SELECT ID, Name, Email, Department FROM Employees"
    InsertCommand="INSERT INTO Employees (Name, Email, Department) VALUES (@Name, @Email, @Department)"
    UpdateCommand="UPDATE Employees SET Name=@Name, Email=@Email, Department=@Department WHERE ID=@ID"
    DeleteCommand="DELETE FROM Employees WHERE ID=@ID"&gt;
&lt;/asp:SqlDataSource&gt;</code></pre>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-th me-2"></i>GridView 資料顯示</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">基本 GridView 設定</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;asp:GridView ID="GridView1" runat="server" 
    DataSourceID="SqlDataSource1"
    AutoGenerateColumns="false"
    CssClass="table table-striped"
    AllowPaging="true" PageSize="10"
    AllowSorting="true"&gt;
    &lt;Columns&gt;
        &lt;asp:BoundField DataField="ID" 
            HeaderText="編號" SortExpression="ID" /&gt;
        &lt;asp:BoundField DataField="Name" 
            HeaderText="姓名" SortExpression="Name" /&gt;
        &lt;asp:BoundField DataField="Email" 
            HeaderText="電子郵件" SortExpression="Email" /&gt;
    &lt;/Columns&gt;
&lt;/asp:GridView&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">進階功能設定</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>AutoGenerateColumns="false"</strong> - 自定義欄位</li>
                                        <li><strong>AllowPaging="true"</strong> - 啟用分頁</li>
                                        <li><strong>AllowSorting="true"</strong> - 啟用排序</li>
                                        <li><strong>DataKeyNames="ID"</strong> - 設定主鍵</li>
                                        <li><strong>EmptyDataText</strong> - 無資料時顯示</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li>使用 <strong>參數化查詢</strong> 防止 SQL Injection</li>
                            <li>適當設定 <strong>分頁大小</strong> 提升效能</li>
                            <li>使用 <strong>DataKeyNames</strong> 進行資料操作</li>
                            <li>自定義欄位比 AutoGenerateColumns 更靈活</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-data-connection" class="mb-4">
                    <h4 class="text-dark">6.2 資料庫連線設定</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-link me-2"></i>連線字串管理</h5>
                        <p class="mb-0">正確的資料庫連線設定是 Web 應用程式穩定運行的基礎，需要考慮安全性、效能和維護性。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-server me-2"></i>常見資料庫類型</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-warning">
                                <tr>
                                    <th>資料庫</th>
                                    <th>Provider</th>
                                    <th>連線字串範例</th>
                                    <th>適用場景</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>SQL Server</strong></td>
                                    <td>System.Data.SqlClient</td>
                                    <td>Data Source=server;Initial Catalog=db</td>
                                    <td>企業級應用</td>
                                </tr>
                                <tr>
                                    <td><strong>LocalDB</strong></td>
                                    <td>System.Data.SqlClient</td>
                                    <td>Data Source=(LocalDB)\\v11.0</td>
                                    <td>開發測試</td>
                                </tr>
                                <tr>
                                    <td><strong>SQL Server Express</strong></td>
                                    <td>System.Data.SqlClient</td>
                                    <td>Data Source=.\\SQLEXPRESS</td>
                                    <td>中小型應用</td>
                                </tr>
                                <tr>
                                    <td><strong>Access</strong></td>
                                    <td>System.Data.OleDb</td>
                                    <td>Provider=Microsoft.ACE.OLEDB.12.0</td>
                                    <td>簡單應用</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>連線字串設定方法</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">方法1：Web.config 設定（推薦）</h6>
                        <pre class="mb-3"><code>&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;!-- 開發環境 --&gt;
    &lt;add name="DevConnection" 
         connectionString="Data Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\\MyApp.mdf;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
    
    &lt;!-- 正式環境 --&gt;
    &lt;add name="ProdConnection" 
         connectionString="Data Source=prod-server;Initial Catalog=MyAppDB;User ID=webapp;Password=secretkey;" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
                        
                        <h6 class="mb-2">方法2：程式碼中使用連線字串</h6>
                        <pre class="mb-0"><code>// 讀取 Web.config 中的連線字串
string connString = ConfigurationManager.ConnectionStrings["DevConnection"].ConnectionString;

// 建立資料庫連線
using (SqlConnection conn = new SqlConnection(connString))
{
    conn.Open();
    
    string sql = "SELECT COUNT(*) FROM Users WHERE IsActive = 1";
    using (SqlCommand cmd = new SqlCommand(sql, conn))
    {
        int activeUsers = (int)cmd.ExecuteScalar();
        lblActiveUsers.Text = $"活躍用戶：{activeUsers} 人";
    }
}</code></pre>
                    </div>

                    <div class="alert alert-danger mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-shield-alt me-2"></i>安全性考量</h6>
                        <ul class="mb-0 small">
                            <li><strong>不要</strong>在程式碼中硬編碼連線字串</li>
                            <li>使用 <strong>Windows 驗證</strong> 或 <strong>SQL Server 驗證</strong></li>
                            <li>定期更換 <strong>資料庫密碼</strong></li>
                            <li>限制資料庫用戶的 <strong>最小權限</strong></li>
                            <li>使用 <strong>連線池 (Connection Pooling)</strong> 提升效能</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-state" class="py-3">
                <h2 class="text-success fw-bold border-bottom pb-2 mb-3"><span class="badge bg-success me-2">7</span>狀態管理</h2>
                <div id="aspnet-state-management" class="mb-4">
                    <h4 class="text-dark">7.1 ViewState、Session、Cookie、Application</h4>
                    
                    <div class="alert alert-success border-start border-4 border-success">
                        <h5 class="alert-heading"><i class="fa-solid fa-memory me-2"></i>狀態管理的重要性</h5>
                        <p class="mb-0">HTTP 是無狀態協定，為了保持使用者在網頁之間的資料和狀態，Web Forms 提供了多種狀態管理機制。</p>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>狀態管理機制比較</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-success">
                                <tr>
                                    <th>狀態管理</th>
                                    <th>範圍</th>
                                    <th>存放位置</th>
                                    <th>生命週期</th>
                                    <th>適用情況</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ViewState</strong></td>
                                    <td>單一頁面</td>
                                    <td>用戶端 (隱藏欄位)</td>
                                    <td>頁面生命週期</td>
                                    <td>控制項狀態保持</td>
                                </tr>
                                <tr>
                                    <td><strong>Session</strong></td>
                                    <td>使用者工作階段</td>
                                    <td>伺服器記憶體</td>
                                    <td>20分鐘 (預設)</td>
                                    <td>使用者登入狀態</td>
                                </tr>
                                <tr>
                                    <td><strong>Cookie</strong></td>
                                    <td>特定網域</td>
                                    <td>用戶端磁碟</td>
                                    <td>可設定過期</td>
                                    <td>記住使用者偏好</td>
                                </tr>
                                <tr>
                                    <td><strong>Application</strong></td>
                                    <td>整個應用程式</td>
                                    <td>伺服器記憶體</td>
                                    <td>應用程式重啟</td>
                                    <td>全域設定、計數器</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>使用範例</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">ViewState 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 啟用/禁用 ViewState
this.EnableViewState = false;

// 使用 ViewState 存放資料
ViewState["UserPreference"] = "DarkMode";
string preference = ViewState["UserPreference"] as string;

// 控制單一控制項的 ViewState
txtUserName.EnableViewState = false;</code></pre>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Session 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 存放使用者資料
Session["UserId"] = 123;
Session["UserName"] = "John";
Session["LoginTime"] = DateTime.Now;

// 讀取 Session 資料
                                        <li>✅ 新增使用者 (Create)</li>
                                        <li>✅ 顯示使用者列表 (Read)</li>
                                        <li>✅ 編輯使用者資料 (Update)</li>
                                        <li>✅ 刪除使用者 (Delete)</li>
                                        <li>✅ 搜尋功能</li>
                                        <li>✅ 資料驗證</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">技術要求</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>🛠️ 使用 ASP.NET Web Forms</li>
                                        <li>🛠️ SQL Server 資料庫</li>
                                        <li>🛠️ 參數化查詢防止 SQL Injection</li>
                                        <li>🛠️ 適當的錯誤處理</li>
                                        <li>🛠️ Bootstrap 美化介面</li>
                                        <li>🛠️ 響應式設計</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-database me-2"></i>資料庫設計</h5>
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Users 資料表結構：</h6>
                        <pre class="mb-0"><code>CREATE TABLE Users (
    UserId int IDENTITY(1,1) PRIMARY KEY,
    Name nvarchar(100) NOT NULL,
    Email nvarchar(255) NOT NULL UNIQUE,
    Age int NOT NULL CHECK (Age > 0 AND Age <= 120),
    Phone nvarchar(20),
    Address nvarchar(500),
    IsDeleted bit DEFAULT 0,
    CreatedDate datetime2 DEFAULT GETDATE(),
    ModifiedDate datetime2 NULL,
    DeletedDate datetime2 NULL
);</code></pre>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-sitemap me-2"></i>網站導航結構</h5>
                    <div class="bg-light p-3 rounded">
                        <ul class="mb-0">
                            <li><strong>Default.aspx</strong> - 首頁，顯示系統介紹</li>
                            <li><strong>UserList.aspx</strong> - 使用者列表頁面 (Read + Delete)</li>
                            <li><strong>CreateUser.aspx</strong> - 新增使用者頁面 (Create)</li>
                            <li><strong>EditUser.aspx</strong> - 編輯使用者頁面 (Update)</li>
                            <li><strong>Site.Master</strong> - 主版頁面，包含導航選單</li>
                        </ul>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-graduation-cap me-2"></i>學習成果</h6>
                        <p class="mb-2">完成這個練習後，您將能夠：</p>
                        <ul class="mb-0 small">
                            <li>理解 HTTP 方法與 CRUD 操作的對應關係</li>
                            <li>在 ASP.NET Web Forms 中實作完整的資料操作</li>
                            <li>運用適當的資料驗證和錯誤處理</li>
                            <li>設計使用者友善的操作介面</li>
                            <li>處理資料庫相關的安全性問題</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-state" class="py-3">
                <h2 class="text-success fw-bold border-bottom pb-2 mb-3"><span class="badge bg-success me-2">7</span>狀態管理</h2>
                <div id="aspnet-state-management" class="mb-4">
                    <h4 class="text-dark">7.1 ViewState、Session、Cookie、Application</h4>
                    
                    <div class="alert alert-success border-start border-4 border-success">
                        <h5 class="alert-heading"><i class="fa-solid fa-memory me-2"></i>狀態管理的重要性</h5>
                        <p class="mb-0">HTTP 是無狀態協定，為了保持使用者在網頁之間的資料和狀態，Web Forms 提供了多種狀態管理機制。</p>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>狀態管理機制比較</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-success">
                                <tr>
                                    <th>狀態管理</th>
                                    <th>範圍</th>
                                    <th>存放位置</th>
                                    <th>生命週期</th>
                                    <th>適用情況</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ViewState</strong></td>
                                    <td>單一頁面</td>
                                    <td>用戶端 (隱藏欄位)</td>
                                    <td>頁面生命週期</td>
                                    <td>控制項狀態保持</td>
                                </tr>
                                <tr>
                                    <td><strong>Session</strong></td>
                                    <td>使用者工作階段</td>
                                    <td>伺服器記憶體</td>
                                    <td>20分鐘 (預設)</td>
                                    <td>使用者登入狀態</td>
                                </tr>
                                <tr>
                                    <td><strong>Cookie</strong></td>
                                    <td>特定網域</td>
                                    <td>用戶端磁碟</td>
                                    <td>可設定過期</td>
                                    <td>記住使用者偏好</td>
                                </tr>
                                <tr>
                                    <td><strong>Application</strong></td>
                                    <td>整個應用程式</td>
                                    <td>伺服器記憶體</td>
                                    <td>應用程式重啟</td>
                                    <td>全域設定、計數器</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>使用範例</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">ViewState 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 啟用/禁用 ViewState
this.EnableViewState = false;

// 使用 ViewState 存放資料
ViewState["UserPreference"] = "DarkMode";
string preference = ViewState["UserPreference"] as string;

// 控制單一控制項的 ViewState
txtUserName.EnableViewState = false;</code></pre>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Session 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 存放使用者資料
Session["UserId"] = 123;
Session["UserName"] = "John";
Session["LoginTime"] = DateTime.Now;

// 讀取 Session 資料
if (Session["UserId"] != null)
{
    int userId = (int)Session["UserId"];
    string userName = Session["UserName"].ToString();
}</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Cookie 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 建立 Cookie
HttpCookie userCookie = new HttpCookie("UserSettings");
userCookie["Theme"] = "Dark";
userCookie["Language"] = "zh-TW";
userCookie.Expires = DateTime.Now.AddDays(30);
Response.Cookies.Add(userCookie);

// 讀取 Cookie
if (Request.Cookies["UserSettings"] != null)
{
    string theme = Request.Cookies["UserSettings"]["Theme"];
}</code></pre>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Application 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 存放全域設定
Application["SiteName"] = "我的網站";
Application["VisitorCount"] = 0;

// 線程安全的計數器
Application.Lock();
int count = (int)Application["VisitorCount"];
Application["VisitorCount"] = count + 1;
Application.UnLock();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>ViewState</strong> 會增加頁面大小，請適度使用</li>
                            <li><strong>Session</strong> 占用伺服器記憶體，設定適當的逾時</li>
                            <li><strong>Cookie</strong> 可能被用戶禁用，需要處理異常</li>
                            <li><strong>Application</strong> 需要考慮線程安全性</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-security" class="py-3">
                <h2 class="text-info fw-bold border-bottom pb-2 mb-3"><span class="badge bg-info me-2">8</span>驗證與安全性</h2>
                <div id="aspnet-security-validation" class="mb-4">
                    <h4 class="text-dark">8.1 驗證控制項（RequiredFieldValidator 等）</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-check-circle me-2"></i>資料驗證的重要性</h5>
                        <p class="mb-0">資料驗證是 Web 應用程式安全性的第一道防線，確保使用者輸入的資料符合預期格式和規則。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-shield-alt me-2"></i>常用驗證控制項</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-info">
                                <tr>
                                    <th>驗證控制項</th>
                                    <th>功能</th>
                                    <th>主要屬性</th>
                                    <th>使用情況</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>RequiredFieldValidator</strong></td>
                                    <td>必填欄位驗證</td>
                                    <td>ControlToValidate</td>
                                    <td>基本資料輸入</td>
                                </tr>
                                <tr>
                                    <td><strong>RegularExpressionValidator</strong></td>
                                    <td>正則表示式驗證</td>
                                    <td>ValidationExpression</td>
                                    <td>電子郵件、電話格式</td>
                                </tr>
                                <tr>
                                    <td><strong>RangeValidator</strong></td>
                                    <td>範圍驗證</td>
                                    <td>MinimumValue, MaximumValue</td>
                                    <td>數字、日期範圍</td>
                                </tr>
                                <tr>
                                    <td><strong>CompareValidator</strong></td>
                                    <td>比較驗證</td>
                                    <td>ControlToCompare, Operator</td>
                                    <td>密碼確認、數值比較</td>
                                </tr>
                                <tr>
                                    <td><strong>CustomValidator</strong></td>
                                    <td>自定義驗證</td>
                                    <td>ClientValidationFunction</td>
                                    <td>複雜業務邏輯</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實用範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">使用者註冊表單驗證：</h6>
                        <pre class="mb-0"><code>&lt;!-- 必填欄位驗證 --&gt;
&lt;asp:TextBox ID="txtUserName" runat="server" CssClass="form-control" /&gt;
&lt;asp:RequiredFieldValidator ID="rfvUserName" runat="server" 
    ControlToValidate="txtUserName"
    ErrorMessage="使用者名稱為必填"
    CssClass="text-danger" /&gt;

&lt;!-- 電子郵件格式驗證 --&gt;
&lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" /&gt;
&lt;asp:RegularExpressionValidator ID="revEmail" runat="server" 
    ControlToValidate="txtEmail"
    ValidationExpression="\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+"
    ErrorMessage="電子郵件格式不正確"
    CssClass="text-danger" /&gt;

&lt;!-- 密碼長度驗證 --&gt;
&lt;asp:TextBox ID="txtPassword" runat="server" TextMode="Password" CssClass="form-control" /&gt;
&lt;asp:RegularExpressionValidator ID="revPassword" runat="server" 
    ControlToValidate="txtPassword"
    ValidationExpression=".{6,}"
    ErrorMessage="密碼至少6個字元"
    CssClass="text-danger" /&gt;

&lt;!-- 密碼確認驗證 --&gt;
&lt;asp:TextBox ID="txtConfirmPassword" runat="server" TextMode="Password" CssClass="form-control" /&gt;
&lt;asp:CompareValidator ID="cvPassword" runat="server" 
    ControlToValidate="txtConfirmPassword"
    ControlToCompare="txtPassword"
    ErrorMessage="密碼確認不一致"
    CssClass="text-danger" /&gt;

&lt;!-- 年齡範圍驗證 --&gt;
&lt;asp:TextBox ID="txtAge" runat="server" CssClass="form-control" /&gt;
&lt;asp:RangeValidator ID="rvAge" runat="server" 
    ControlToValidate="txtAge"
    Type="Integer"
    MinimumValue="18"
    MaximumValue="100"
    ErrorMessage="年齡必須在 18-100 歲之間"
    CssClass="text-danger" /&gt;</code></pre>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>驗證最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li>使用 <strong>ValidationSummary</strong> 集中顯示所有錯誤</li>
                            <li>同時實作 <strong>用戶端和伺服器端驗證</strong></li>
                            <li>使用 <strong>Page.IsValid</strong> 在伺服器端檢查驗證結果</li>
                            <li>提供 <strong>明確的錯誤訊息</strong> 幫助使用者修正</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-security-auth" class="mb-4">
                    <h4 class="text-dark">8.2 使用者登入與授權</h4>
                    
                    <div class="alert alert-danger border-start border-4 border-danger">
                        <h5 class="alert-heading"><i class="fa-solid fa-lock me-2"></i>身份驗證與授權</h5>
                        <p class="mb-0">身份驗證 (Authentication) 確認使用者身份，授權 (Authorization) 決定使用者可以存取的資源。</p>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-user-shield me-2"></i>ASP.NET 身份驗證模式</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Windows 驗證</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>使用 Windows 帳戶</p>
                                    <p class="card-text small"><strong>適用：</strong>內部應用系統</p>
                                    <p class="card-text small"><strong>設定：</strong>&lt;authentication mode="Windows" /&gt;</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Forms 驗證</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>自定義登入表單</p>
                                    <p class="card-text small"><strong>適用：</strong>網際網路應用</p>
                                    <p class="card-text small"><strong>設定：</strong>&lt;authentication mode="Forms" /&gt;</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">None</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>無身份驗證</p>
                                    <p class="card-text small"><strong>適用：</strong>公開網站</p>
                                    <p class="card-text small"><strong>設定：</strong>&lt;authentication mode="None" /&gt;</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>Forms 驗證實作</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Web.config 設定：</h6>
                        <pre class="mb-3"><code>&lt;system.web&gt;
  &lt;authentication mode="Forms"&gt;
    &lt;forms loginUrl="Login.aspx" 
           defaultUrl="Default.aspx" 
           timeout="20" 
           cookieless="false" /&gt;
  &lt;/authentication&gt;
  
  &lt;authorization&gt;
    &lt;deny users="?" /&gt;  &lt;!-- 拒絕匿名使用者 --&gt;
  &lt;/authorization&gt;
&lt;/system.web&gt;</code></pre>
                        
                        <h6 class="mb-2">Login.aspx.cs 登入處理：</h6>
                        <pre class="mb-0"><code>protected void btnLogin_Click(object sender, EventArgs e)
{
    string username = txtUserName.Text.Trim();
    string password = txtPassword.Text;
    
    // 驗證使用者身份 (此處應連接資料庫驗證)
    if (ValidateUser(username, password))
    {
        // 建立驗證 Cookie
        FormsAuthentication.SetAuthCookie(username, chkRememberMe.Checked);
        
        // 設定 Session 資料
        Session["UserName"] = username;
        Session["LoginTime"] = DateTime.Now;
        
        // 重定向到預設頁面
        Response.Redirect(FormsAuthentication.GetRedirectUrl(username, false));
    }
    else
    {
        lblError.Text = "帳號或密碼錯誤";
        lblError.Visible = true;
    }
}

private bool ValidateUser(string username, string password)
{
    // TODO: 實作資料庫驗證邏輯
    // 此處應該使用加密密碼與資料庫比對
    string hashedPassword = HashPassword(password);
    
    using (SqlConnection conn = new SqlConnection(connectionString))
    {
        string sql = "SELECT COUNT(*) FROM Users WHERE Username = @Username AND Password = @Password AND IsActive = 1";
        using (SqlCommand cmd = new SqlCommand(sql, conn))
        {
            cmd.Parameters.AddWithValue("@Username", username);
            cmd.Parameters.AddWithValue("@Password", hashedPassword);
            
            conn.Open();
            int userCount = (int)cmd.ExecuteScalar();
            return userCount > 0;
        }
    }
}</code></pre>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-key me-2"></i>安全性最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>密碼加密：</strong>使用 bcrypt 或 PBKDF2 加密密碼</li>
                            <li><strong>HTTPS：</strong>強制使用 SSL/TLS 保護傳輸</li>
                            <li><strong>防止暴力破解：</strong>實作登入失敗鎖定機制</li>
                            <li><strong>Session 管理：</strong>設定適當的逾時時間</li>
                            <li><strong>登出功能：</strong>使用 FormsAuthentication.SignOut()</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-deploy" class="py-3">
                <h2 class="text-warning fw-bold border-bottom pb-2 mb-3"><span class="badge bg-warning me-2">9</span>網站發佈與部署</h2>
                <div id="aspnet-deploy-iis" class="mb-4">
                    <h4 class="text-dark">9.1 發佈到本機 IIS</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-server me-2"></i>IIS 部署概念</h5>
                        <p class="mb-0">Internet Information Services (IIS) 是 Microsoft 的 Web 伺服器，為 ASP.NET 應用程式提供完整的運行環境。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-list-ol me-2"></i>部署步驟</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">1. 安裝 IIS</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>開啟「程式和功能」</li>
                                        <li>選擇「開啟或關閉 Windows 功能」</li>
                                        <li>勾選「Internet Information Services」</li>
                                        <li>勾選「.NET Framework 4.8 進階服務」</li>
                                        <li>重新啟動電腦</li>
                                    </ol>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">2. 建立應用程式</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>開啟 IIS 管理員</li>
                                        <li>展開伺服器名稱</li>
                                        <li>右鍵點擊「網站」</li>
                                        <li>選擇「新增網站」</li>
                                        <li>填入網站資訊</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">3. 發佈程式</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>在 Visual Studio 中選擇「建置」</li>
                                        <li>選擇「發佈網站」</li>
                                        <li>選擇發佈方法：「檔案系統」</li>
                                        <li>設定目標位置</li>
                                        <li>點擊「發佈」</li>
                                    </ol>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">4. 設定權限</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>設定 IIS_IUSRS 權限</li>
                                        <li>設定 App_Data 資料夾權限</li>
                                        <li>設定資料庫連線權限</li>
                                        <li>測試網站運作</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-danger mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>常見問題與解決</h6>
                        <ul class="mb-0 small">
                            <li><strong>404 錯誤：</strong>檢查預設文件設定</li>
                            <li><strong>500 錯誤：</strong>檢查 web.config 設定和錯誤日誌</li>
                            <li><strong>權限問題：</strong>設定 IIS_IUSRS 完整控制權</li>
                            <li><strong>資料庫連線：</strong>調整連線字串中的伺服器名稱</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-deploy-azure" class="mb-4">
                    <h4 class="text-dark">9.2 發佈到雲端（如 Azure）</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-cloud me-2"></i>雲端部署優勢</h5>
                        <p class="mb-0">雲端部署提供高可用性、自動擴展、全球分發等優勢，是現代 Web 應用程式的首選。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-microsoft me-2"></i>Azure App Service 部署</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">1. 建立 Azure App Service：</h6>
                        <pre class="mb-3"><code># 使用 Azure CLI
az login
az group create --name myResourceGroup --location "East US"
az appservice plan create --name myAppServicePlan --resource-group myResourceGroup --sku FREE
az webapp create --resource-group myResourceGroup --plan myAppServicePlan --name myWebApp</code></pre>
                        
                        <h6 class="mb-2">2. Visual Studio 發佈設定：</h6>
                        <ol class="small mb-0">
                            <li>右鍵點擊專案 → 發佈</li>
                            <li>選擇 "Azure" → "Azure App Service (Windows)"</li>
                            <li>選擇或建立新的 App Service</li>
                            <li>設定發佈配置檔</li>
                            <li>點擊發佈</li>
                        </ol>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-check me-2"></i>雲端部署最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>環境分離：</strong>建立開發、測試、生產環境</li>
                            <li><strong>CI/CD：</strong>使用 Azure DevOps 或 GitHub Actions</li>
                            <li><strong>監控：</strong>啟用 Application Insights</li>
                            <li><strong>備份：</strong>定期備份資料庫和應用</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-advanced" class="py-3">
                <h2 class="text-danger fw-bold border-bottom pb-2 mb-3"><span class="badge bg-danger me-2">10</span>進階主題</h2>
                <div id="aspnet-advanced-masteruser" class="mb-4">
                    <h4 class="text-dark">10.1 Master Page 與 User Control</h4>
                    
                    <div class="alert alert-danger border-start border-4 border-danger">
                        <h5 class="alert-heading"><i class="fa-solid fa-puzzle-piece me-2"></i>模組化開發</h5>
                        <p class="mb-0">Master Page 和 User Control 是 Web Forms 實現代碼重用和一致性的主要機制。</p>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>Master Page 概念</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Site.Master 範例</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="MyApp.SiteMaster" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head runat="server"&gt;
    &lt;title&gt;&lt;asp:ContentPlaceHolder ID="TitleContent" runat="server" /&gt;&lt;/title&gt;
    &lt;link href="~/Content/bootstrap.min.css" rel="stylesheet" /&gt;
    &lt;asp:ContentPlaceHolder ID="HeadContent" runat="server"&gt;&lt;/asp:ContentPlaceHolder&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;nav class="navbar navbar-expand-lg navbar-dark bg-dark"&gt;
            &lt;!-- 導航列內容 --&gt;
        &lt;/nav&gt;
        
        &lt;main class="container mt-4"&gt;
            &lt;asp:ContentPlaceHolder ID="MainContent" runat="server"&gt;&lt;/asp:ContentPlaceHolder&gt;
        &lt;/main&gt;
        
        &lt;footer class="bg-dark text-light mt-5 py-3"&gt;
            &lt;!-- 頁尾內容 --&gt;
        &lt;/footer&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">內容頁面使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;%@ Page Title="首頁" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="MyApp.Default" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server"&gt;
    我的網站 - 首頁
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content2" ContentPlaceHolderID="HeadContent" runat="server"&gt;
    &lt;style&gt;
        .welcome { color: #007bff; }
    &lt;/style&gt;
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content3" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;h1 class="welcome"&gt;歡迎來到我的網站&lt;/h1&gt;
    &lt;p&gt;這是使用 Master Page 的內容頁面。&lt;/p&gt;
&lt;/asp:Content&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-cube me-2"></i>User Control 使用</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">UserInfo.ascx 使用者控制項：</h6>
                        <pre class="mb-3"><code>&lt;%@ Control Language="C#" AutoEventWireup="true" CodeBehind="UserInfo.ascx.cs" Inherits="MyApp.Controls.UserInfo" %&gt;

&lt;div class="user-info-panel"&gt;
    &lt;h5&gt;使用者資訊&lt;/h5&gt;
    &lt;p&gt;&lt;strong&gt;姓名：&lt;/strong&gt; &lt;asp:Label ID="lblUserName" runat="server" /&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;部門：&lt;/strong&gt; &lt;asp:Label ID="lblDepartment" runat="server" /&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;登入時間：&lt;/strong&gt; &lt;asp:Label ID="lblLoginTime" runat="server" /&gt;&lt;/p&gt;
&lt;/div&gt;</code></pre>
                        
                        <h6 class="mb-2">在頁面中使用 User Control：</h6>
                        <pre class="mb-0"><code>&lt;%@ Register Src="~/Controls/UserInfo.ascx" TagPrefix="uc" TagName="UserInfo" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="row"&gt;
        &lt;div class="col-md-8"&gt;
            &lt;!-- 主要內容 --&gt;
        &lt;/div&gt;
        &lt;div class="col-md-4"&gt;
            &lt;uc:UserInfo ID="userInfo1" runat="server" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>使用時機</h6>
                        <ul class="mb-0 small">
                            <li><strong>Master Page：</strong>適用於網站布局、導航、頁尾等全域元素</li>
                            <li><strong>User Control：</strong>適用於可重用的功能模組，如評論系統、廣告</li>
                            <li><strong>效益：</strong>減少代碼重複、提高維護性、確保一致性</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-advanced-customcontrols" class="mb-4">
                    <h4 class="text-dark">10.2 自訂伺服器控制項</h4>
                    <p>詳細內容將在此處提供。</p>
                </div>
                <div id="aspnet-advanced-ajax" class="mb-4">
                    <h4 class="text-dark">10.3 AJAX 與 UpdatePanel</h4>
                    
                    <div class="alert alert-primary border-start border-4 border-primary">
                        <h5 class="alert-heading"><i class="fa-solid fa-bolt me-2"></i>AJAX 在 Web Forms 中的應用</h5>
                        <p class="mb-0">AJAX 技術讓 Web 應用程式可以在不重新載入整個頁面的情況下更新部分內容，提供更好的使用者體驗。</p>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-sync-alt me-2"></i>UpdatePanel 使用</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">基本設定</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;asp:ScriptManager ID="ScriptManager1" runat="server" /&gt;

&lt;asp:UpdatePanel ID="UpdatePanel1" runat="server"&gt;
    &lt;ContentTemplate&gt;
        &lt;asp:Label ID="lblTime" runat="server" /&gt;
        &lt;asp:Button ID="btnUpdate" runat="server" 
            Text="更新時間" OnClick="btnUpdate_Click" /&gt;
    &lt;/ContentTemplate&gt;
&lt;/asp:UpdatePanel&gt;

&lt;!-- 這個部分不會因 AJAX 而重新載入 --&gt;
&lt;div&gt;
    &lt;p&gt;頁面加載時間：&lt;asp:Label ID="lblPageLoad" runat="server" /&gt;&lt;/p&gt;
&lt;/div&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">伺服器端程式碼</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        lblPageLoad.Text = DateTime.Now.ToString("HH:mm:ss");
        lblTime.Text = DateTime.Now.ToString("HH:mm:ss");
    }
}

protected void btnUpdate_Click(object sender, EventArgs e)
{
    // 只有 UpdatePanel 內部會更新
    lblTime.Text = DateTime.Now.ToString("HH:mm:ss");
    
    // 模擬處理時間
    System.Threading.Thread.Sleep(1000);
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-cog me-2"></i>進階功能</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">外部觸發器 (Triggers)：</h6>
                        <pre class="mb-3"><code>&lt;asp:UpdatePanel ID="UpdatePanel2" runat="server"&gt;
    &lt;ContentTemplate&gt;
        &lt;asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1" /&gt;
    &lt;/ContentTemplate&gt;
    &lt;Triggers&gt;
        &lt;asp:AsyncPostBackTrigger ControlID="btnRefresh" EventName="Click" /&gt;
        &lt;asp:PostBackTrigger ControlID="btnExport" /&gt; &lt;!-- 強制完整 PostBack --&gt;
    &lt;/Triggers&gt;
&lt;/asp:UpdatePanel&gt;

&lt;!-- 在 UpdatePanel 外部的控制項 --&gt;
&lt;asp:Button ID="btnRefresh" runat="server" Text="更新資料" OnClick="btnRefresh_Click" /&gt;
&lt;asp:Button ID="btnExport" runat="server" Text="匯出 Excel" OnClick="btnExport_Click" /&gt;</code></pre>
                        
                        <h6 class="mb-2">程式化更新：</h6>
                        <pre class="mb-0"><code>// 在伺服器端程式碼中手動觸發更新
UpdatePanel1.Update();

// 設定更新模式
UpdatePanel1.UpdateMode = UpdatePanelUpdateMode.Conditional;

// 在用戶端 JavaScript 中觸發 PostBack
__doPostBack('UpdatePanel1', '');</code></pre>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>使用注意事項</h6>
                        <ul class="mb-0 small">
                            <li><strong>效能：</strong>UpdatePanel 仍然會執行完整的頁面生命週期</li>
                            <li><strong>單一 ScriptManager：</strong>每個頁面只能有一個 ScriptManager</li>
                            <li><strong>巢狀結構：</strong>避免 UpdatePanel 巢狀使用</li>
                            <li><strong>JavaScript 相容：</strong>注意 AJAX 更新後 JavaScript 事件繩定</li>
                        </ul>
                    </div>
                </div>
            </section>

        </section>
    </main>

    <button onclick="scrollToTop()" id="backToTopBtn" class="back-to-top" title="回到頂部"><i
            class="fa-solid fa-arrow-up"></i></button>

    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div class="container">
            <p class="mb-0">&copy; 2023-2025 網站教學. All Rights Reserved.</p>
            <p class="small mb-0">本網站內容僅供教學使用，不具任何商業用途。</p>
            <div>
                <a href="#" class="text-white me-2"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-white me-2"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-white"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5.3.0 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 顯示複製成功狀態
        function showCopySuccess(button) {
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fa-solid fa-check me-1"></i>已複製';
            button.classList.add('success');
            
            // 2秒後恢復原狀
            setTimeout(function() {
                button.innerHTML = originalText;
                button.classList.remove('success');
            }, 2000);
        }
        
        // 備用複製方法（對於不支援 Clipboard API 的瀏覽器）
        function fallbackCopy(text, button) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess(button);
                } else {
                    console.error('備用複製方法失敗');
                }
            } catch (err) {
                console.error('備用複製方法錯誤: ', err);
            }
            
            document.body.removeChild(textArea);
        }

        // copyCode 函數：處理複製按鈕的點擊事件
        function copyCode(button) {
            // 找到相鄰的 pre 元素
            const container = button.parentElement;
            const pre = container.querySelector('pre');
            const code = pre.querySelector('code');
            
            if (!code) return;
            
            // 取得程式碼內容
            const codeText = code.textContent || code.innerText;
            
            // 使用 Clipboard API 複製文字
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(codeText).then(function() {
                    showCopySuccess(button);
                }).catch(function(err) {
                    console.error('複製失敗: ', err);
                    fallbackCopy(codeText, button);
                });
            } else {
                // 使用備用方法
                fallbackCopy(codeText, button);
            }
        }

        // 當頁面載入完成後執行
        document.addEventListener('DOMContentLoaded', function() {
            // 為所有的 pre > code 元素添加複製按鈕
            const codeBlocks = document.querySelectorAll('pre code');
            
            codeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                
                // 如果已經有複製按鈕，跳過
                if (pre.parentElement.classList.contains('code-container')) {
                    return;
                }
                
                // 創建容器包裝 pre 元素
                const container = document.createElement('div');
                container.className = 'code-container';
                
                // 將 pre 元素包裝在容器中
                pre.parentNode.insertBefore(container, pre);
                container.appendChild(pre);
                
                // 創建複製按鈕
                const copyButton = document.createElement('button');
                copyButton.className = 'copy-btn';
                copyButton.innerHTML = '<i class="fa-regular fa-copy me-1"></i>複製';
                copyButton.setAttribute('title', '複製程式碼');
                
                // 添加複製功能
                copyButton.addEventListener('click', function() {
                    // 取得程式碼文字（移除多餘的空白和換行）
                    const codeText = codeBlock.textContent || codeBlock.innerText;
                    
                    // 使用 Clipboard API 複製文字
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(codeText).then(function() {
                            showCopySuccess(copyButton);
                        }).catch(function(err) {
                            console.error('複製失敗: ', err);
                            fallbackCopy(codeText, copyButton);
                        });
                    } else {
                        // 使用備用方法
                        fallbackCopy(codeText, copyButton);
                    }
                });
                
                // 將按鈕添加到容器中
                container.appendChild(copyButton);
            });

            // 索引選單展開/收合圖示切換
            const indexContent = document.getElementById('indexContent');
            const toggleIcon = document.getElementById('toggleIcon');

            if (indexContent && toggleIcon) {
                indexContent.addEventListener('shown.bs.collapse', function () {
                    toggleIcon.className = 'fa-solid fa-chevron-up';
                });

                indexContent.addEventListener('hidden.bs.collapse', function () {
                    toggleIcon.className = 'fa-solid fa-chevron-down';
                });
            }
        });
        
        // 返回頂部按鈕功能
        const backToTopBtn = document.getElementById('backToTopBtn');

        window.onscroll = function () {
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                backToTopBtn.classList.add('show');
            } else {
                backToTopBtn.classList.remove('show');
            }
        };

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>

</html>
