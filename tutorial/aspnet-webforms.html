<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET Web Forms 教學</title>
    <!-- Bootstrap 5.3.0 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome 6.4.0 CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">

    <!-- 索引選單相關樣式 -->
    <style>
        /* 平滑滾動效果 */
        html {
            scroll-behavior: smooth;
        }

        /* 錨點偏移，避免被固定導航欄遮蓋 */
        [id] {
            scroll-margin-top: 80px; /* 根據你的導航欄高度調整 */
        }

        /* 索引選單樣式 */
        .index-menu {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 4px solid #0d6efd;
        }

        .index-menu a {
            transition: all 0.2s ease;
            padding: 2px 0;
            display: inline-block;
        }

        .index-menu a:hover {
            color: #0d6efd !important;
            transform: translateX(5px);
        }

        /* 主選單標題樣式 */
        .index-menu h5.index-main-topic { /* Renamed class for clarity */
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
            padding-bottom: 8px;
            margin-bottom: 15px !important;
        }

        /* 子選單項目縮排與間距 */
        .index-menu .ps-3 { /* Keep this for sub-items if using week1's exact structure */
            border-left: 2px dotted rgba(0, 0, 0, 0.2);
            margin-left: 10px;
        }
        .index-menu ul.sub-items { /* Added class for sub-items list */
             padding-left: 20px; /* Indent sub-items */
        }

        /* 子選單徽章樣式 - reusing from week1 for consistency */
        .index-menu .badge.bg-outline-primary {
            background-color: transparent !important;
            border: 1px solid #0d6efd !important;
        }
        .index-menu .badge.bg-outline-success {
            background-color: transparent !important;
            border: 1px solid #198754 !important;
        }
        .index-menu .badge.bg-outline-info {
            background-color: transparent !important;
            border: 1px solid #0dcaf0 !important;
        }
         .index-menu .badge.bg-outline-warning {
            background-color: transparent !important;
            border: 1px solid #ffc107 !important;
        }
        .index-menu .badge.bg-outline-danger {
            background-color: transparent !important;
            border: 1px solid #dc3545 !important;
        }
        .index-menu .badge.bg-outline-secondary {
            background-color: transparent !important;
            border: 1px solid #6c757d !important;
        }

        /* 浮動回到頂部按鈕 */
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #0d6efd;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background: #0b5ed7;
            transform: translateY(-2px);
        }

        /* 程式碼複製按鈕樣式 */
        .code-container {
            position: relative;
            margin-bottom: 1rem;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(108, 117, 125, 0.8);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            z-index: 10;
            backdrop-filter: blur(4px);
            min-width: 60px;
        }

        .copy-btn:hover {
            background: rgba(108, 117, 125, 0.9);
            transform: scale(1.05);
        }

        .copy-btn.success {
            background: rgba(25, 135, 84, 0.8);
        }

        .copy-btn.success:hover {
            background: rgba(25, 135, 84, 0.9);
        }

        /* 確保程式碼區塊有適當的padding避免被按鈕遮擋 */
        .code-container pre {
            padding-top: 40px !important;
            padding-right: 80px !important;
            overflow-x: auto;
        }

        /* 在較小螢幕上調整按鈕位置 */
        @media (max-width: 768px) {
            .copy-btn {
                top: 6px;
                right: 6px;
                padding: 3px 6px;
                font-size: 11px;
                min-width: 50px;
            }
            
            .code-container pre {
                padding-top: 35px !important;
                padding-right: 60px !important;
            }
        }
    </style>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
            <div class="container">
                <a href="aspnet-webforms.html" class="navbar-brand"><i class="fa-solid fa-graduation-cap me-2"></i>ASP.NET Web Forms 教學</a>
            </div>
        </nav>
    </header>
    <main class="container" id="top" style="padding-top: 70px;"> <!-- Added padding-top for fixed navbar -->
        <section class="lesson">
            <h1 class="display-6 fw-bold mb-4"><i class="fa-solid fa-server me-2"></i>ASP.NET Web Forms 教學</h1>
            <!-- 課程索引選單 -->
            <div class="alert alert-light border mb-4 index-menu">
                <div class="d-flex justify-content-between align-items-center">
                    <h5 class="alert-heading mb-0"><i class="fa-solid fa-list me-2 text-primary"></i>課程內容索引</h5>
                    <button class="btn btn-sm btn-outline-primary" type="button" data-bs-toggle="collapse"
                        data-bs-target="#indexContent" aria-expanded="true" aria-controls="indexContent">
                        <i class="fa-solid fa-chevron-up" id="toggleIcon"></i>
                    </button>
                </div>
                <div class="collapse show" id="indexContent">
                    <p class="mb-3 mt-2 small text-muted">點擊下方連結快速跳轉到對應章節</p>

                    <!-- Curriculum Index -->
                    <div class="row">
                        <div class="col-md-6">
                            <!-- Section 0 - HTTP 基礎 -->
                            <div class="mb-3">
                                <h5 class="text-dark mb-2 fw-bold">
                                    <a href="#http-basics" class="text-decoration-none text-dark">
                                        <span class="badge bg-dark me-2">0</span><i class="fa-solid fa-globe me-2"></i>HTTP 協議基礎
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#http-intro" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.1</span>HTTP 協議介紹</a></li>
                                    <li class="mb-1"><a href="#http-methods" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.2</span>HTTP 請求方法 (GET、POST、PUT、DELETE)</a></li>
                                    <li class="mb-1"><a href="#http-status" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.3</span>HTTP 狀態碼</a></li>
                                    <li class="mb-1"><a href="#http-headers" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-dark border me-2" style="min-width: 32px;">0.4</span>HTTP 標頭與內容類型</a></li>
                                </ul>
                            </div>
                            <!-- Section 1 -->
                            <div class="mb-3">
                                <h5 class="text-primary mb-2 fw-bold">
                                    <a href="#aspnet-intro" class="text-decoration-none text-primary">
                                        <span class="badge bg-primary me-2">1</span><i class="fa-solid fa-book me-2"></i>認識 ASP.NET Web Forms
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-intro-what" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">1.1</span>什麼是 Web Forms？</a></li>
                                    <li class="mb-1"><a href="#aspnet-intro-diff" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">1.2</span>與 ASP.NET MVC 和 ASP.NET Core MVC 的差異</a></li>
                                    <li class="mb-1"><a href="#aspnet-intro-http" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">1.3</span>Web Forms 如何處理 HTTP 請求</a></li>
                                </ul>
                            </div>
                            <!-- Section 2 -->
                            <div class="mb-3">
                                <h5 class="text-success mb-2 fw-bold">
                                    <a href="#aspnet-env" class="text-decoration-none text-success">
                                        <span class="badge bg-success me-2">2</span><i class="fa-solid fa-tools me-2"></i>開發環境安裝與設定
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-env-vs" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">2.1</span>安裝 Visual Studio</a></li>
                                    <li class="mb-1"><a href="#aspnet-env-project" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">2.2</span>建立第一個 Web Forms 專案</a></li>
                                </ul>
                            </div>
                            <!-- Section 3 -->
                            <div class="mb-3">
                                <h5 class="text-info mb-2 fw-bold">
                                    <a href="#aspnet-structure" class="text-decoration-none text-info">
                                        <span class="badge bg-info me-2">3</span><i class="fa-solid fa-folder-open me-2"></i>專案結構與檔案說明
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-structure-overview" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.1</span>專案架構概覽</a></li>
                                    <li class="mb-1"><a href="#aspnet-structure-special" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.2</span>專案節點說明</a></li>
                                    <li class="mb-1"><a href="#aspnet-structure-folders" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.3</span>核心資料夾解析</a></li>
                                    <li class="mb-1"><a href="#aspnet-structure-core-files" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">3.4</span>重要檔案詳解</a></li>
                                </ul>
                            </div>
                            <!-- Section 4 -->
                            <div class="mb-3">
                                <h5 class="text-warning mb-2 fw-bold">
                                    <a href="#aspnet-ui" class="text-decoration-none text-warning">
                                        <span class="badge bg-warning me-2">4</span><i class="fa-solid fa-palette me-2"></i>設計網頁介面
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-ui-designer" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">4.1</span>使用設計器與原始碼編輯</a></li>
                                    <li class="mb-1"><a href="#aspnet-ui-controls" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">4.2</span>常用伺服器控制項</a></li>
                                </ul>
                            </div>
                            <!-- Section 5 -->
                            <div class="mb-3">
                                <h5 class="text-danger mb-2 fw-bold">
                                    <a href="#aspnet-logic" class="text-decoration-none text-danger">
                                        <span class="badge bg-danger me-2">5</span><i class="fa-solid fa-cogs me-2"></i>事件處理與程式邏輯
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-logic-lifecycle" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">5.1</span>Page Life Cycle</a></li>
                                    <li class="mb-1"><a href="#aspnet-logic-events" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">5.2</span>控制項事件</a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <!-- Section 6 -->
                            <div class="mb-3">
                                <h5 class="text-primary mb-2 fw-bold">
                                    <a href="#aspnet-data" class="text-decoration-none text-primary">
                                        <span class="badge bg-primary me-2">6</span><i class="fa-solid fa-database me-2"></i>資料繫結與資料庫操作
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-data-binding" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">6.1</span>使用 SqlDataSource、GridView</a></li>
                                    <li class="mb-1"><a href="#aspnet-data-connection" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-primary text-primary border me-2" style="min-width: 32px;">6.2</span>資料庫連線設定</a></li>
                                </ul>
                            </div>
                            <!-- Section 6.5 - CRUD 操作 -->
                            <div class="mb-3">
                                <h5 class="text-secondary mb-2 fw-bold">
                                    <a href="#crud-operations" class="text-decoration-none text-secondary">
                                        <span class="badge bg-secondary me-2">6.5</span><i class="fa-solid fa-sync-alt me-2"></i>CRUD 資料操作
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#crud-create" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-secondary border me-2" style="min-width: 32px;">6.5.1</span>Create - 新增資料</a></li>
                                    <li class="mb-1"><a href="#crud-read" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-secondary border me-2" style="min-width: 32px;">6.5.2</span>Read - 讀取資料</a></li>
                                    <li class="mb-1"><a href="#crud-update" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-secondary border me-2" style="min-width: 32px;">6.5.3</span>Update - 更新資料</a></li>
                                    <li class="mb-1"><a href="#crud-delete" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-secondary border me-2" style="min-width: 32px;">6.5.4</span>Delete - 刪除資料</a></li>
                                    <li class="mb-1"><a href="#crud-practice" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-secondary text-secondary border me-2" style="min-width: 32px;">6.5.5</span>CRUD 實作練習</a></li>
                                </ul>
                            </div>
                            <!-- Section 7 -->
                            <div class="mb-3">
                                <h5 class="text-success mb-2 fw-bold">
                                    <a href="#aspnet-state" class="text-decoration-none text-success">
                                        <span class="badge bg-success me-2">7</span><i class="fa-solid fa-history me-2"></i>狀態管理
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-state-management" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-success text-success border me-2" style="min-width: 32px;">7.1</span>ViewState、Session、Cookie、Application</a></li>
                                </ul>
                            </div>
                            <!-- Section 8 -->
                            <div class="mb-3">
                                <h5 class="text-info mb-2 fw-bold">
                                    <a href="#aspnet-security" class="text-decoration-none text-info">
                                        <span class="badge bg-info me-2">8</span><i class="fa-solid fa-shield-alt me-2"></i>驗證與安全性
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-security-validation" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">8.1</span>驗證控制項</a></li>
                                    <li class="mb-1"><a href="#aspnet-security-auth" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-info text-info border me-2" style="min-width: 32px;">8.2</span>使用者登入與授權</a></li>
                                </ul>
                            </div>
                            <!-- Section 9 -->
                            <div class="mb-3">
                                <h5 class="text-warning mb-2 fw-bold">
                                    <a href="#aspnet-deploy" class="text-decoration-none text-warning">
                                        <span class="badge bg-warning me-2">9</span><i class="fa-solid fa-rocket me-2"></i>網站發佈與部署
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-deploy-iis" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">9.1</span>發佈到本機 IIS</a></li>
                                    <li class="mb-1"><a href="#aspnet-deploy-azure" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-warning text-warning border me-2" style="min-width: 32px;">9.2</span>發佈到雲端（如 Azure）</a></li>
                                </ul>
                            </div>
                            <!-- Section 10 -->
                            <div class="mb-3">
                                <h5 class="text-danger mb-2 fw-bold">
                                    <a href="#aspnet-advanced" class="text-decoration-none text-danger">
                                        <span class="badge bg-danger me-2">10</span><i class="fa-solid fa-star me-2"></i>進階主題
                                    </a>
                                </h5>
                                <ul class="list-unstyled small ps-3 sub-items">
                                    <li class="mb-1"><a href="#aspnet-advanced-masteruser" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">10.1</span>Master Page 與 User Control</a></li>
                                    <li class="mb-1"><a href="#aspnet-advanced-customcontrols" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">10.2</span>自訂伺服器控制項</a></li>
                                    <li class="mb-1"><a href="#aspnet-advanced-ajax" class="text-decoration-none d-flex align-items-center"><span class="badge bg-outline-danger text-danger border me-2" style="min-width: 32px;">10.3</span>AJAX 與 UpdatePanel</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Content Sections -->
                
                <!-- HTTP 基礎章節 -->
                <section id="http-basics" class="py-3">
                    <h2 class="text-dark fw-bold border-bottom pb-2 mb-3"><span class="badge bg-dark me-2">0</span>HTTP 協議基礎</h2>
                    
                    <div id="http-intro" class="mb-4">
                        <h4 class="text-dark">0.1 HTTP 協議介紹</h4>
                        
                        <div class="alert alert-dark border-start border-4 border-dark">
                            <h5 class="alert-heading"><i class="fa-solid fa-globe me-2"></i>什麼是 HTTP？</h5>
                            <p class="mb-0">HTTP (HyperText Transfer Protocol) 是網際網路上最重要的通信協議，定義了瀏覽器和伺服器之間如何交換資料。</p>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-exchange-alt me-2"></i>HTTP 的工作原理</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-light">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-arrow-right me-2 text-success"></i>請求 (Request)</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">用戶端（瀏覽器）向伺服器發送請求</p>
                                        <ul class="small mb-0">
                                            <li>請求方法 (GET, POST 等)</li>
                                            <li>請求 URL</li>
                                            <li>請求標頭</li>
                                            <li>請求主體 (如有)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-light">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-arrow-left me-2 text-info"></i>回應 (Response)</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">伺服器處理請求後回傳回應</p>
                                        <ul class="small mb-0">
                                            <li>狀態碼 (200, 404 等)</li>
                                            <li>回應標頭</li>
                                            <li>回應主體 (HTML, JSON 等)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-info-circle me-2"></i>HTTP 的特性</h5>
                        <div class="bg-light p-3 rounded">
                            <ul class="mb-0">
                                <li><strong>無狀態 (Stateless)：</strong>每個請求都是獨立的，伺服器不會記住之前的請求</li>
                                <li><strong>基於文字：</strong>HTTP 訊息都是可讀的文字格式</li>
                                <li><strong>簡單易懂：</strong>協議設計簡潔，容易理解和實作</li>
                                <li><strong>可擴展：</strong>可以透過標頭擴展功能</li>
                            </ul>
                        </div>
                    </div>

                    <div id="http-methods" class="mb-4">
                        <h4 class="text-dark">0.2 HTTP 請求方法 (GET、POST、PUT、DELETE)</h4>
                        
                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-list me-2"></i>四種主要的 HTTP 方法</h5>
                        
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-dark">
                                    <tr>
                                        <th>方法</th>
                                        <th>用途</th>
                                        <th>安全性</th>
                                        <th>冪等性</th>
                                        <th>常見用途</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class="badge bg-success">GET</span></td>
                                        <td>讀取資料</td>
                                        <td>安全</td>
                                        <td>冪等</td>
                                        <td>瀏覽網頁、查詢資料</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-primary">POST</span></td>
                                        <td>新增資料</td>
                                        <td>不安全</td>
                                        <td>非冪等</td>
                                        <td>提交表單、新增記錄</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-warning">PUT</span></td>
                                        <td>更新資料</td>
                                        <td>不安全</td>
                                        <td>冪等</td>
                                        <td>完整更新資源</td>
                                    </tr>
                                    <tr>
                                        <td><span class="badge bg-danger">DELETE</span></td>
                                        <td>刪除資料</td>
                                        <td>不安全</td>
                                        <td>冪等</td>
                                        <td>刪除資源</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="alert alert-info mt-4">
                            <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>重要概念說明</h6>
                            <ul class="mb-0 small">
                                <li><strong>安全 (Safe)：</strong>不會修改伺服器上的資料，只讀取</li>
                                <li><strong>冪等 (Idempotent)：</strong>多次執行相同請求的效果相同</li>
                                <li><strong>Web Forms 主要使用 GET 和 POST</strong>，PUT 和 DELETE 在 REST API 中較常見</li>
                            </ul>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-shield-alt me-2"></i>為什麼冪等性重要？</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-redo me-2"></i>網路重試安全</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">當網路不穩定或請求逾時時，系統可以安全地重試冪等操作，不用擔心產生重複的副作用。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>更新使用者資料失敗時，可以安全重試，不會造成數據異常。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-user-shield me-2"></i>防止重複操作</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">防止使用者重複點擊按鈕或重複提交表單造成的問題，確保系統狀態的一致性。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>刪除資料時，多次點擊不會產生錯誤或異常狀態。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-cogs me-2"></i>系統可靠性</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">提高系統的容錯能力，即使在分散式環境或微服務架構中，也能確保操作的可預測性。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>在負載平衡環境下，請求可能被路由到不同伺服器，冪等性確保結果一致。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-code me-2"></i>API 設計標準</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">符合 REST API 設計原則，讓 API 更容易理解、使用和維護，提高開發效率。</p>
                                        <div class="bg-light p-2 rounded mt-2">
                                            <small><strong>例子：</strong>第三方開發者可以安全地整合您的 API，不用擔心重複呼叫的問題。</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-cloud me-2"></i>什麼是 REST API？</h5>
                        
                        <div class="alert alert-primary border-start border-4 border-primary">
                            <h6 class="alert-heading"><i class="fa-solid fa-info-circle me-2"></i>REST API 定義</h6>
                            <p class="mb-0"><strong>REST (Representational State Transfer)</strong> 是一種軟體架構風格，定義了設計網路服務的一組約束條件。REST API 是遵循這些原則設計的應用程式介面。</p>
                        </div>

                        <h6 class="text-dark mt-3 mb-2"><i class="fa-solid fa-list me-2"></i>REST 的六大原則</h6>
                        <div class="table-responsive">
                            <table class="table table-striped table-sm">
                                <thead class="table-dark">
                                    <tr>
                                        <th>原則</th>
                                        <th>說明</th>
                                        <th>範例</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>客戶端-伺服器分離</strong></td>
                                        <td>前端與後端獨立開發</td>
                                        <td>Web Forms 頁面 + Web API 後端</td>
                                    </tr>
                                    <tr>
                                        <td><strong>無狀態 (Stateless)</strong></td>
                                        <td>每個請求包含所有必要資訊</td>
                                        <td>不依賴 Session，使用 Token 驗證</td>
                                    </tr>
                                    <tr>
                                        <td><strong>可快取 (Cacheable)</strong></td>
                                        <td>回應可以被快取以提高效能</td>
                                        <td>靜態資料加上 Cache-Control 標頭</td>
                                    </tr>
                                    <tr>
                                        <td><strong>統一介面</strong></td>
                                        <td>使用標準的 HTTP 方法和狀態碼</td>
                                        <td>GET /users、POST /users</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h6 class="text-dark mt-3 mb-2"><i class="fa-solid fa-route me-2"></i>REST API 的 URL 設計模式</h6>
                        <div class="bg-light p-3 rounded">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6 class="text-success mb-2">✅ 好的設計</h6>
                                    <ul class="small mb-0">
                                        <li><code>GET /api/users</code> - 取得所有使用者</li>
                                        <li><code>GET /api/users/123</code> - 取得特定使用者</li>
                                        <li><code>POST /api/users</code> - 建立新使用者</li>
                                        <li><code>PUT /api/users/123</code> - 更新使用者</li>
                                        <li><code>DELETE /api/users/123</code> - 刪除使用者</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6 class="text-danger mb-2">❌ 不好的設計</h6>
                                    <ul class="small mb-0">
                                        <li><code>GET /api/getUsers</code> - 動詞在 URL 中</li>
                                        <li><code>POST /api/user/delete</code> - 錯誤的 HTTP 方法</li>
                                        <li><code>GET /api/users?action=create</code> - 用查詢參數表示動作</li>
                                        <li><code>POST /api/updateUser</code> - 不一致的命名</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <h6 class="text-dark mt-3 mb-2"><i class="fa-solid fa-exchange-alt me-2"></i>REST API vs Web Forms</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0">REST API 特點</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li>資源導向的 URL 設計</li>
                                            <li>使用 HTTP 動詞表達操作</li>
                                            <li>回傳 JSON 或 XML 格式</li>
                                            <li>無狀態，適合行動應用</li>
                                            <li>容易測試和偵錯</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0">Web Forms 特點</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li>頁面導向的設計</li>
                                            <li>主要使用 GET 和 POST</li>
                                            <li>回傳完整的 HTML 頁面</li>
                                            <li>有狀態，使用 ViewState</li>
                                            <li>適合傳統網頁應用</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="alert alert-success mt-3">
                            <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>學習重點</h6>
                            <ul class="mb-0 small">
                                <li><strong>冪等性</strong>確保操作的安全性和可靠性，是設計穩定系統的重要概念</li>
                                <li><strong>REST API</strong>提供了一套標準化的網路服務設計原則</li>
                                <li>雖然 Web Forms 不是 REST 風格，但了解這些概念有助於設計更好的 Web 應用程式</li>
                                <li>現代 Web 開發趨向於使用 REST API + 前端框架的架構</li>
                            </ul>
                        </div>
                    </div>

                    <div id="http-status" class="mb-4">
                        <h4 class="text-dark">0.3 HTTP 狀態碼</h4>
                        
                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-traffic-light me-2"></i>常見的 HTTP 狀態碼</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0">2xx - 成功</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>200 OK：</strong>請求成功</li>
                                            <li><strong>201 Created：</strong>資源已建立</li>
                                            <li><strong>204 No Content：</strong>成功但無內容</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="card mb-3">
                                    <div class="card-header bg-info text-white">
                                        <h6 class="card-title mb-0">3xx - 重新導向</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>301 Moved Permanently：</strong>永久重新導向</li>
                                            <li><strong>302 Found：</strong>暫時重新導向</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-warning text-dark">
                                        <h6 class="card-title mb-0">4xx - 用戶端錯誤</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>400 Bad Request：</strong>請求格式錯誤</li>
                                            <li><strong>401 Unauthorized：</strong>未授權</li>
                                            <li><strong>404 Not Found：</strong>資源不存在</li>
                                        </ul>
                                    </div>
                                </div>
                                
                                <div class="card mb-3">
                                    <div class="card-header bg-danger text-white">
                                        <h6 class="card-title mb-0">5xx - 伺服器錯誤</h6>
                                    </div>
                                    <div class="card-body">
                                        <ul class="small mb-0">
                                            <li><strong>500 Internal Server Error：</strong>伺服器內部錯誤</li>
                                            <li><strong>503 Service Unavailable：</strong>服務暫時無法使用</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="http-headers" class="mb-4">
                        <h4 class="text-dark">0.4 HTTP 標頭與內容類型</h4>
                        
                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-tags me-2"></i>常用的 HTTP 標頭</h5>
                        
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead class="table-dark">
                                    <tr>
                                        <th>標頭名稱</th>
                                        <th>用途</th>
                                        <th>範例值</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>Content-Type</code></td>
                                        <td>指定內容類型</td>
                                        <td>text/html, application/json</td>
                                    </tr>
                                    <tr>
                                        <td><code>Content-Length</code></td>
                                        <td>內容長度</td>
                                        <td>1024</td>
                                    </tr>
                                    <tr>
                                        <td><code>User-Agent</code></td>
                                        <td>用戶端資訊</td>
                                        <td>Mozilla/5.0 (Windows NT 10.0)</td>
                                    </tr>
                                    <tr>
                                        <td><code>Accept</code></td>
                                        <td>可接受的內容類型</td>
                                        <td>text/html, application/json</td>
                                    </tr>
                                    <tr>
                                        <td><code>Cookie</code></td>
                                        <td>Cookie 資料</td>
                                        <td>sessionid=abc123</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h5 class="text-dark mt-4 mb-3"><i class="fa-solid fa-file-alt me-2"></i>常見的內容類型 (Content-Type)</h5>
                        <div class="bg-light p-3 rounded">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="small mb-0">
                                        <li><code>text/html</code> - HTML 文件</li>
                                        <li><code>text/css</code> - CSS 樣式表</li>
                                        <li><code>text/javascript</code> - JavaScript</li>
                                        <li><code>application/json</code> - JSON 資料</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="small mb-0">
                                        <li><code>image/jpeg</code> - JPEG 圖片</li>
                                        <li><code>image/png</code> - PNG 圖片</li>
                                        <li><code>application/pdf</code> - PDF 文件</li>
                                        <li><code>multipart/form-data</code> - 表單檔案上傳</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="aspnet-intro" class="py-3">
                    <h2 class="text-primary fw-bold border-bottom pb-2 mb-3"><span class="badge bg-primary me-2">1</span>認識 ASP.NET Web Forms</h2>
                    <div id="aspnet-intro-what" class="mb-4">
                        <h4 class="text-dark">1.1 什麼是 Web Forms？</h4>
                        
                        <div class="alert alert-primary border-start border-4 border-primary">
                            <h5 class="alert-heading"><i class="fa-solid fa-info-circle me-2"></i>ASP.NET Web Forms 簡介</h5>
                            <p class="mb-0">ASP.NET Web Forms 是 Microsoft 提供的網頁應用程式開發框架，讓開發者能以事件驅動的方式建立動態網頁應用程式。</p>
                        </div>

                        <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-puzzle-piece me-2"></i>Web Forms 的核心概念</h5>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-primary text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-mouse-pointer me-2"></i>事件驅動模型</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">類似桌面應用程式的開發方式</p>
                                        <ul class="small mb-0">
                                            <li>按鈕點擊事件</li>
                                            <li>頁面載入事件</li>
                                            <li>控制項值改變事件</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card mb-3">
                                    <div class="card-header bg-success text-white">
                                        <h6 class="card-title mb-0"><i class="fa-solid fa-eye me-2"></i>視覺化設計</h6>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text small">提供拖拉式的設計介面</p>
                                        <ul class="small mb-0">
                                            <li>豐富的伺服器控制項</li>
                                            <li>視覺化佈局設計</li>
                                            <li>屬性視窗設定</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>Web Forms 的架構組成</h5>
                        
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead class="table-primary">
                                    <tr>
                                        <th>組件</th>
                                        <th>檔案副檔名</th>
                                        <th>用途</th>
                                        <th>範例</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>頁面檔案</strong></td>
                                        <td>.aspx</td>
                                        <td>定義使用者介面</td>
                                        <td>Default.aspx</td>
                                    </tr>
                                    <tr>
                                        <td><strong>程式碼檔案</strong></td>
                                        <td>.aspx.cs</td>
                                        <td>處理事件邏輯</td>
                                        <td>Default.aspx.cs</td>
                                    </tr>
                                    <tr>
                                        <td><strong>主版頁面</strong></td>
                                        <td>.master</td>
                                        <td>統一版面配置</td>
                                        <td>Site.master</td>
                                    </tr>
                                    <tr>
                                        <td><strong>使用者控制項</strong></td>
                                        <td>.ascx</td>
                                        <td>可重用的控制項</td>
                                        <td>Header.ascx</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>簡單的 Web Forms 範例</h5>
                        
                        <div class="bg-light p-3 rounded">
                            <h6 class="mb-2">Default.aspx (頁面設計)</h6>
                            <pre class="mb-3"><code>&lt;%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="MyApp.Default" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head runat="server"&gt;
    &lt;title&gt;我的第一個 Web Forms 頁面&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;h1&gt;歡迎使用 ASP.NET Web Forms&lt;/h1&gt;
        &lt;asp:Label ID="lblMessage" runat="server" Text="請點擊下方按鈕" /&gt;
        &lt;br /&gt;&lt;br /&gt;
        &lt;asp:Button ID="btnHello" runat="server" Text="說哈囉" OnClick="btnHello_Click" /&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                            <h6 class="mb-2">Default.aspx.cs (程式邏輯)</h6>
                            <pre class="mb-0"><code>using System;
using System.Web.UI;

namespace MyApp
{
    public partial class Default : Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {
            // 頁面載入時執行
            if (!IsPostBack)
            {
                lblMessage.Text = "頁面首次載入完成";
            }
        }

        protected void btnHello_Click(object sender, EventArgs e)
        {
            // 按鈕點擊事件
            lblMessage.Text = "哈囉！現在時間是：" + DateTime.Now.ToString();
        }
    }
}</code></pre>
                        </div>

                        <div class="alert alert-success mt-4">
                            <h6 class="alert-heading"><i class="fa-solid fa-check-circle me-2"></i>Web Forms 的優點</h6>
                            <ul class="mb-0 small">
                                <li><strong>快速開發：</strong>RAD (Rapid Application Development) 開發模式</li>
                                <li><strong>事件導向：</strong>類似 WinForms 的開發體驗</li>
                                <li><strong>豐富控制項：</strong>內建大量的伺服器控制項</li>
                                <li><strong>狀態管理：</strong>自動處理頁面狀態（ViewState）</li>
                                <li><strong>IDE 支援：</strong>Visual Studio 完整的設計時支援</li>
                            </ul>
                        </div>
                    </div>
                    <div id="aspnet-intro-diff" class="mb-4">
                    <h4 class="text-dark">1.2 與 ASP.NET MVC 和 ASP.NET Core MVC 的差異</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-balance-scale me-2"></i>三種不同的開發模式</h5>
                        <p class="mb-0">ASP.NET Web Forms、ASP.NET MVC 和 ASP.NET Core MVC 是三種不同的網頁開發架構，代表了 Microsoft Web 技術的演進歷程。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-timeline me-2"></i>技術演進歷程</h5>
                    
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-primary text-white text-center">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-calendar me-2"></i>2002年</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h5 class="text-primary">ASP.NET Web Forms</h5>
                                    <p class="small">第一代 ASP.NET 框架<br/>事件驅動模式<br/>類似 Windows Forms</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white text-center">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-calendar me-2"></i>2009年</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h5 class="text-success">ASP.NET MVC</h5>
                                    <p class="small">基於 .NET Framework<br/>MVC 架構模式<br/>更好的可測試性</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card h-100">
                                <div class="card-header bg-danger text-white text-center">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-calendar me-2"></i>2016年</h6>
                                </div>
                                <div class="card-body text-center">
                                    <h5 class="text-danger">ASP.NET Core MVC</h5>
                                    <p class="small">跨平台框架<br/>高性能架構<br/>雲端原生設計</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-table me-2"></i>核心差異比較</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-warning">
                                <tr>
                                    <th>特性</th>
                                    <th>Web Forms</th>
                                    <th>ASP.NET MVC</th>
                                    <th>ASP.NET Core MVC</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>架構模式</strong></td>
                                    <td>事件驅動 (Event-Driven)</td>
                                    <td>模型-視圖-控制器 (MVC)</td>
                                    <td>模型-視圖-控制器 (MVC)</td>
                                </tr>
                                <tr>
                                    <td><strong>平台支援</strong></td>
                                    <td>Windows + IIS</td>
                                    <td>Windows + IIS</td>
                                    <td>跨平台 (Windows/Linux/macOS)</td>
                                </tr>
                                <tr>
                                    <td><strong>運行時</strong></td>
                                    <td>.NET Framework</td>
                                    <td>.NET Framework</td>
                                    <td>.NET Core / .NET 5+</td>
                                </tr>
                                <tr>
                                    <td><strong>URL 結構</strong></td>
                                    <td>/Default.aspx</td>
                                    <td>/Home/Index</td>
                                    <td>/Home/Index</td>
                                </tr>
                                <tr>
                                    <td><strong>狀態管理</strong></td>
                                    <td>有狀態 (ViewState)</td>
                                    <td>無狀態 (Stateless)</td>
                                    <td>無狀態 (Stateless)</td>
                                </tr>
                                <tr>
                                    <td><strong>測試性</strong></td>
                                    <td>較難進行單元測試</td>
                                    <td>容易進行單元測試</td>
                                    <td>優秀的單元測試支援</td>
                                </tr>
                                <tr>
                                    <td><strong>HTML 控制</strong></td>
                                    <td>較少控制權</td>
                                    <td>完全控制 HTML 輸出</td>
                                    <td>完全控制 HTML 輸出</td>
                                </tr>
                                <tr>
                                    <td><strong>性能</strong></td>
                                    <td>中等（ViewState 開銷）</td>
                                    <td>良好</td>
                                    <td>優秀（高性能設計）</td>
                                </tr>
                                <tr>
                                    <td><strong>開發速度</strong></td>
                                    <td>快速</td>
                                    <td>中等</td>
                                    <td>中等至快速</td>
                                </tr>
                                <tr>
                                    <td><strong>學習曲線</strong></td>
                                    <td>較平緩（類似桌面開發）</td>
                                    <td>較陡峭（需了解 MVC）</td>
                                    <td>中等（豐富的文檔和工具）</td>
                                </tr>
                                <tr>
                                    <td><strong>生命週期狀態</strong></td>
                                    <td>維護模式</td>
                                    <td>維護模式</td>
                                    <td>積極開發</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code-branch me-2"></i>架構模式詳細對比</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0">Web Forms 架構</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        <div class="bg-light p-2 rounded mb-2">
                                            <strong>頁面 (.aspx)</strong>
                                        </div>
                                        <div class="text-muted">↕</div>
                                        <div class="bg-light p-2 rounded">
                                            <strong>程式碼 (.aspx.cs)</strong>
                                        </div>
                                    </div>
                                    <ul class="small mb-0">
                                        <li>頁面和邏輯緊密結合</li>
                                        <li>事件處理在 Code-Behind</li>
                                        <li>PostBack 機制</li>
                                        <li>伺服器控制項</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">ASP.NET MVC 架構</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>Model</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>View</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded">
                                            <strong>Controller</strong>
                                        </div>
                                    </div>
                                    <ul class="small mb-0">
                                        <li>關注點分離</li>
                                        <li>路由導向</li>
                                        <li>RESTful 設計</li>
                                        <li>Razor 視圖引擎</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="card-title mb-0">ASP.NET Core MVC 架構</h6>
                                </div>
                                <div class="card-body">
                                    <div class="text-center mb-3">
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>Model</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>View</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded mb-1">
                                            <strong>Controller</strong>
                                        </div>
                                        <div class="bg-light p-2 rounded">
                                            <strong>Middleware</strong>
                                        </div>
                                    </div>
                                    <ul class="small mb-0">
                                        <li>模組化架構</li>
                                        <li>中間件管道</li>
                                        <li>依賴注入內建</li>
                                        <li>統一的 Web API</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-lightbulb me-2"></i>選擇建議</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3 border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">適合使用 Web Forms</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>快速開發原型或內部系統</li>
                                        <li>團隊有 WinForms 開發經驗</li>
                                        <li>維護現有的 Web Forms 應用</li>
                                        <li>重點在商業邏輯而非使用者介面</li>
                                        <li>傳統企業應用程式</li>
                                        <li>學習 ASP.NET 的入門</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3 border-success">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">適合使用 ASP.NET MVC</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>維護現有的 MVC 應用</li>
                                        <li>需要完全控制 HTML 輸出</li>
                                        <li>重視單元測試</li>
                                        <li>與前端框架整合</li>
                                        <li>Windows 環境限制</li>
                                        <li>不想遷移到 Core</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3 border-danger">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="card-title mb-0">適合使用 ASP.NET Core MVC</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>新專案開發（強烈推薦）</li>
                                        <li>跨平台部署需求</li>
                                        <li>高性能要求</li>
                                        <li>雲端原生應用</li>
                                        <li>微服務架構</li>
                                        <li>容器化部署</li>
                                        <li>現代化 Web 應用程式</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>程式碼風格對比</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Web Forms 處理表單提交</h6>
                        <pre class="mb-3"><code>// Default.aspx.cs
protected void btnSubmit_Click(object sender, EventArgs e)
{
    string name = txtName.Text;
    string email = txtEmail.Text;
    
    // 處理資料
    SaveUser(name, email);
    
    lblMessage.Text = "儲存成功！";
}</code></pre>
                        
                        <h6 class="mb-2">ASP.NET MVC 處理表單提交</h6>
                        <pre class="mb-3"><code>// HomeController.cs
[HttpPost]
public ActionResult Create(UserModel model)
{
    if (ModelState.IsValid)
    {
        // 處理資料
        SaveUser(model.Name, model.Email);
        
        ViewBag.Message = "儲存成功！";
        return View(model);
    }
    
    return View(model);
}</code></pre>
                        
                        <h6 class="mb-2">ASP.NET Core MVC 處理表單提交</h6>
                        <pre class="mb-0"><code>// HomeController.cs
[HttpPost]
public async Task&lt;IActionResult&gt; Create(UserModel model)
{
    if (ModelState.IsValid)
    {
        // 處理資料（非同步）
        await _userService.SaveUserAsync(model.Name, model.Email);
        
        TempData["Message"] = "儲存成功！";
        return RedirectToAction(nameof(Index));
    }
    
    return View(model);
}</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-info-circle me-2"></i>遷移路徑建議</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>從 Web Forms 遷移：</strong></p>
                                <ul class="small mb-0">
                                    <li>先學習 MVC 概念和 Razor 語法</li>
                                    <li>逐步重寫核心功能</li>
                                    <li>考慮直接遷移到 ASP.NET Core</li>
                                    <li>利用 .NET Upgrade Assistant</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>從 ASP.NET MVC 遷移：</strong></p>
                                <ul class="small mb-0">
                                    <li>使用 .NET Upgrade Assistant</li>
                                    <li>更新依賴項目和套件</li>
                                    <li>調整 Startup 和設定</li>
                                    <li>測試和效能優化</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-star me-2"></i>學習重點</h6>
                        <ul class="mb-0 small">
                            <li><strong>Web Forms</strong> 適合學習 Web 開發基礎概念</li>
                            <li><strong>ASP.NET MVC</strong> 引入了現代 Web 開發模式</li>
                            <li><strong>ASP.NET Core MVC</strong> 是目前和未來的主流選擇</li>
                            <li>理解三者差異有助於做出明智的技術決策</li>
                            <li>新專案強烈建議使用 ASP.NET Core MVC</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-structure" class="py-3">
                <h2 class="text-info fw-bold border-bottom pb-2 mb-3"><span class="badge bg-info me-2">3</span>專案結構與檔案說明</h2>
                
                <div id="aspnet-structure-overview" class="mb-4">
                    <h4 class="text-dark">3.1 專案架構概覽</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-sitemap me-2"></i>ASP.NET Web Forms 專案架構</h5>
                        <p class="mb-0">我們將逐一深入了解 Visual Studio 中每個檔案和資料夾的具體用途，幫助您掌握專案組織結構。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-folder-tree me-2"></i>完整專案結構圖</h5>
                    
                    <div class="bg-light p-3 rounded mb-4">
                        <pre class="mb-0 small"><code>📁 方案 'WebApplication1' (1 / 1 個專案)
└─ 📁 WebApplication1
    ├─ 🔗 Connected Services      <span class="text-muted">// 第三方服務連接</span>
    ├─ 🔧 Properties              <span class="text-muted">// 專案屬性設定</span>
    ├─ 📚 參考                    <span class="text-muted">// 程式庫參照</span>
    ├─ 📁 App_Data               <span class="text-muted">// 應用程式資料</span>
    ├─ 📁 App_Start              <span class="text-muted">// 啟動設定檔案</span>
    │   ├─ 📄 BundleConfig.cs     <span class="text-muted">// 資源打包設定</span>
    │   └─ 📄 RouteConfig.cs      <span class="text-muted">// 路由設定</span>
    ├─ 📁 Content                <span class="text-muted">// 靜態資源</span>
    │   ├─ 📄 bootstrap.css       <span class="text-muted">// Bootstrap 樣式</span>
    │   └─ 📄 Site.css            <span class="text-muted">// 網站樣式</span>
    ├─ 📁 Scripts                <span class="text-muted">// JavaScript 檔案</span>
    │   ├─ � bootstrap.js        <span class="text-muted">// Bootstrap 腳本</span>
    │   └─ � jquery-3.4.1.js     <span class="text-muted">// jQuery 函式庫</span>
    ├─ 📝 About.aspx             <span class="text-muted">// 關於頁面</span>
    ├─ 📝 Bundle.config          <span class="text-muted">// 打包設定檔</span>
    ├─ 📝 Contact.aspx           <span class="text-muted">// 聯絡頁面</span>
    ├─ 📝 Default.aspx           <span class="text-muted">// 預設首頁</span>
    ├─ � favicon.ico            <span class="text-muted">// 網站圖示</span>
    ├─ 📝 Global.asax            <span class="text-muted">// 全域應用程式檔案</span>
    ├─ 📝 packages.config        <span class="text-muted">// NuGet 套件設定</span>
    ├─ 📝 Site.Master            <span class="text-muted">// 主版頁面</span>
    ├─ 📝 Site.Mobile.Master     <span class="text-muted">// 行動版主版頁面</span>
    ├─ 📝 ViewSwitcher.ascx      <span class="text-muted">// 檢視切換控制項</span>
    └─ 📝 Web.config             <span class="text-muted">// 主要設定檔</span></code></pre>
                    </div>
                </div>

                <div id="aspnet-structure-special" class="mb-4">
                    <h4 class="text-dark">3.2 專案節點說明</h4>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-link me-2"></i>Connected Services</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>功能：</strong>管理與第三方服務的連接</p>
                                    <p class="card-text small"><strong>常見服務：</strong></p>
                                    <ul class="small mb-2">
                                        <li>Azure 雲端服務</li>
                                        <li>Application Insights 監控</li>
                                        <li>SQL Server 資料庫</li>
                                        <li>Web API 服務</li>
                                    </ul>
                                    <p class="card-text small text-muted"><strong>操作：</strong>右鍵點擊可新增服務連線</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-secondary text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-cog me-2"></i>Properties</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>功能：</strong>專案屬性和組件資訊</p>
                                    <p class="card-text small"><strong>包含檔案：</strong></p>
                                    <ul class="small mb-2">
                                        <li>AssemblyInfo.cs - 組件資訊</li>
                                        <li>專案設定檔案</li>
                                        <li>版本資訊</li>
                                        <li>建置設定</li>
                                    </ul>
                                    <p class="card-text small text-muted"><strong>用途：</strong>定義專案基本資訊</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-book me-2"></i>參考 (References)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>功能：</strong>管理專案使用的程式庫</p>
                                    <p class="card-text small"><strong>參考類型：</strong></p>
                                    <ul class="small mb-2">
                                        <li>.NET Framework 參考</li>
                                        <li>System.Web - Web 相關功能</li>
                                        <li>System.Data - 資料存取</li>
                                        <li>第三方 DLL 檔案</li>
                                        <li>NuGet 套件參考</li>
                                    </ul>
                                    <p class="card-text small text-muted"><strong>管理：</strong>可新增、移除程式庫參考</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-box me-2"></i>NuGet 套件 (隱藏)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>功能：</strong>透過 packages.config 管理</p>
                                    <p class="card-text small"><strong>常見套件：</strong></p>
                                    <ul class="small mb-2">
                                        <li>Bootstrap - UI 框架</li>
                                        <li>jQuery - JavaScript 函式庫</li>
                                        <li>Modernizr - 瀏覽器功能檢測</li>
                                        <li>Entity Framework - ORM</li>
                                    </ul>
                                    <p class="card-text small text-muted"><strong>查看：</strong>套件管理員主控台或 UI</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="aspnet-structure-folders" class="mb-4">
                    <h4 class="text-dark">3.3 核心資料夾解析</h4>
                    
                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-folder me-2"></i>App_Data 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-info text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-database me-2"></i>App_Data 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>主要用途：</strong></p>
                                    <ul class="small mb-3">
                                        <li>存放應用程式資料檔案</li>
                                        <li>Local DB 資料庫檔案 (.mdf)</li>
                                        <li>XML 資料檔案</li>
                                        <li>JSON 設定檔案</li>
                                        <li>SQLite 資料庫檔案</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>安全特性：</strong></p>
                                    <ul class="small mb-3">
                                        <li>IIS 預設拒絕直接存取</li>
                                        <li>無法透過瀏覽器直接下載</li>
                                        <li>適合存放敏感資料</li>
                                        <li>自動受到 Web.config 保護</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">典型內容範例：</h6>
                                <pre class="mb-0 small"><code>📁 App_Data/
├─ 📄 Database.mdf           <span class="text-muted">// SQL Server LocalDB 資料庫主檔</span>
├─ 📄 Database_Log.ldf       <span class="text-muted">// SQL Server 交易日誌檔</span>
├─ 📄 users.xml              <span class="text-muted">// XML 格式的使用者資料</span>
├─ 📄 settings.json          <span class="text-muted">// JSON 設定檔案</span>
└─ 📄 backup.bak             <span class="text-muted">// 資料庫備份檔案</span></code></pre>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-rocket me-2"></i>App_Start 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-play me-2"></i>App_Start 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>功能目的：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式啟動時的初始化設定</li>
                                        <li>路由規則設定</li>
                                        <li>資源打包與壓縮設定</li>
                                        <li>篩選器設定</li>
                                        <li>相依性注入設定</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>執行時機：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式首次啟動時</li>
                                        <li>在 Global.asax Application_Start 之後</li>
                                        <li>只執行一次</li>
                                        <li>設定全域規則</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2">BundleConfig.cs 範例：</h6>
                                <pre class="mb-0 small"><code>public class BundleConfig
{
    public static void RegisterBundles(BundleCollection bundles)
    {
        // JavaScript 打包
        bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
                    "~/Scripts/jquery-{version}.js"));
        
        // CSS 打包
        bundles.Add(new StyleBundle("~/Content/css").Include(
                    "~/Content/bootstrap.css",
                    "~/Content/site.css"));
    }
}</code></pre>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">RouteConfig.cs 範例：</h6>
                                <pre class="mb-0 small"><code>public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.EnableFriendlyUrls();
        routes.MapPageRoute("ProductDetails", 
                           "products/{id}", 
                           "~/ProductDetails.aspx");
    }
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-palette me-2"></i>Content 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-dark">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-css3-alt me-2"></i>Content 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>存放內容：</strong></p>
                                    <ul class="small mb-3">
                                        <li>CSS 樣式表檔案</li>
                                        <li>字型檔案 (fonts)</li>
                                        <li>圖片資源 (images)</li>
                                        <li>主題檔案 (themes)</li>
                                        <li>SASS/LESS 原始檔</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>組織結構：</strong></p>
                                    <ul class="small mb-3">
                                        <li>bootstrap.css - Bootstrap 框架</li>
                                        <li>Site.css - 網站自訂樣式</li>
                                        <li>themes/ - 主題資料夾</li>
                                        <li>images/ - 圖片檔案</li>
                                        <li>fonts/ - 字型檔案</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2">典型 Content 結構：</h6>
                                <pre class="mb-0 small"><code>📁 Content/
├─ 📄 bootstrap.css          <span class="text-muted">// Bootstrap CSS 框架</span>
├─ 📄 bootstrap.min.css      <span class="text-muted">// Bootstrap 壓縮版</span>
├─ 📄 Site.css               <span class="text-muted">// 網站主要樣式</span>
├─ 📁 themes/                <span class="text-muted">// 主題檔案夾</span>
│  ├─ 📄 blue-theme.css      <span class="text-muted">// 藍色主題</span>
│  └─ 📄 dark-theme.css      <span class="text-muted">// 暗色主題</span>
├─ 📁 images/                <span class="text-muted">// 圖片資源</span>
│  ├─ 🖼️ logo.png            <span class="text-muted">// 網站標誌</span>
│  └─ 🖼️ banner.jpg          <span class="text-muted">// 橫幅圖片</span>
└─ 📁 fonts/                 <span class="text-muted">// 字型檔案</span>
   ├─ 📄 custom-font.woff    <span class="text-muted">// 自訂字型</span>
   └─ 📄 icons.ttf           <span class="text-muted">// 圖示字型</span></code></pre>
                            </div>
                            <div class="alert alert-info">
                                <small><i class="fa-solid fa-lightbulb me-2"></i><strong>最佳實踐：</strong>使用相對路徑引用 Content 中的檔案，例如：<code>~/Content/Site.css</code></small>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>Scripts 資料夾</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h6 class="card-title mb-0"><i class="fa-brands fa-js me-2"></i>Scripts 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>存放內容：</strong></p>
                                    <ul class="small mb-3">
                                        <li>JavaScript 檔案</li>
                                        <li>jQuery 函式庫</li>
                                        <li>Bootstrap JavaScript</li>
                                        <li>第三方 JS 套件</li>
                                        <li>自訂 JavaScript 功能</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案類型：</strong></p>
                                    <ul class="small mb-3">
                                        <li>.js - 一般 JavaScript 檔案</li>
                                        <li>.min.js - 壓縮版本</li>
                                        <li>.map - Source Map 檔案</li>
                                        <li>TypeScript 編譯後的檔案</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded mb-3">
                                <h6 class="mb-2">引用 Scripts 的方式：</h6>
                                <pre class="mb-0 small"><code>&lt;!-- 在 .aspx 頁面中引用 --&gt;
&lt;script src="&lt;%= ResolveUrl("~/Scripts/jquery-3.4.1.min.js") %&gt;"&gt;&lt;/script&gt;

&lt;!-- 使用 Bundle 打包引用 --&gt;
&lt;%: Scripts.Render("~/bundles/jquery") %&gt;

&lt;!-- 條件式載入 --&gt;
&lt;% if (!IsDebug) { %&gt;
    &lt;script src="~/Scripts/site.min.js"&gt;&lt;/script&gt;
&lt;% } else { %&gt;
    &lt;script src="~/Scripts/site.js"&gt;&lt;/script&gt;
&lt;% } %&gt;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="aspnet-structure-core-files" class="mb-4">
                    <h4 class="text-dark">3.4 重要檔案詳解</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-file-code me-2"></i>核心檔案深度解析</h5>
                        <p class="mb-0">接下來我們將詳細說明每個重要檔案的作用、結構和使用方法，幫助您深入理解 ASP.NET Web Forms 專案中各檔案的職責。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-file-code me-2"></i>Default.aspx - 預設首頁</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-home me-2"></i>Default.aspx 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>檔案作用：</strong></p>
                                    <ul class="small mb-3">
                                        <li>網站的預設首頁</li>
                                        <li>訪客第一個看到的頁面</li>
                                        <li>包含 HTML 和 ASP.NET 控制項</li>
                                        <li>定義頁面的視覺呈現</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>關聯檔案：</strong></p>
                                    <ul class="small mb-3">
                                        <li>Default.aspx.cs - 程式邏輯</li>
                                        <li>Default.aspx.designer.cs - 設計器產生</li>
                                        <li>Site.Master - 主版頁面 (如使用)</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">Default.aspx 基本結構：</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;%@ Page Title="首頁" Language="C#" MasterPageFile="~/Site.Master" 
         AutoEventWireup="true" CodeBehind="Default.aspx.cs" 
         Inherits="WebApplication1.Default" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server"&gt;
    我的網站 - 首頁
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content2" ContentPlaceHolderID="HeadContent" runat="server"&gt;
    &lt;style&gt;
        .welcome { color: #007bff; }
    &lt;/style&gt;
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content3" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;h1 class="welcome"&gt;歡迎來到我的網站&lt;/h1&gt;
    &lt;p&gt;這是使用 Master Page 的內容頁面。&lt;/p&gt;
&lt;/asp:Content&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-globe me-2"></i>Global.asax - 全域應用程式檔案</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-danger text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-server me-2"></i>Global.asax 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>主要功能：</strong></p>
                                    <ul class="small mb-3">
                                        <li>應用程式全域事件處理</li>
                                        <li>應用程式生命週期管理</li>
                                        <li>Session 管理</li>
                                        <li>錯誤處理</li>
                                        <li>路由設定</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>重要事件：</strong></p>
                                    <ul class="small mb-3">
                                        <li>Application_Start - 應用程式啟動</li>
                                        <li>Session_Start - 新 Session 開始</li>
                                        <li>Application_Error - 錯誤發生</li>
                                        <li>Session_End - Session 結束</li>
                                        <li>Application_End - 應用程式結束</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">Global.asax.cs 完整範例：</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>public class Global : System.Web.HttpApplication
{
    protected void Application_Start()
    {
        // 應用程式啟動時執行一次
        // 註冊路由、Bundle、Filter 等
        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);
        
        // 初始化全域變數
        Application["StartTime"] = DateTime.Now;
        Application["VisitorCount"] = 0;
    }

    protected void Session_Start()
    {
        // 每個新使用者 Session 開始時執行
        int count = (int)Application["VisitorCount"];
        Application["VisitorCount"] = count + 1;
        
        // 設定 Session 預設值
        Session["UserPreferences"] = new UserPreferences();
    }

    protected void Application_Error()
    {
        // 發生未處理例外時執行
        Exception ex = Server.GetLastError();
        
        // 記錄錯誤
        System.Diagnostics.Debug.WriteLine($"錯誤: {ex.Message}");
        
        // 清除錯誤並導向錯誤頁面
        Server.ClearError();
        Response.Redirect("~/ErrorPage.aspx");
    }
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-cog me-2"></i>Web.config - 組態設定檔</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-dark">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-tools me-2"></i>Web.config 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>設定項目：</strong></p>
                                    <ul class="small mb-3">
                                        <li>資料庫連線字串</li>
                                        <li>應用程式設定值</li>
                                        <li>驗證與授權</li>
                                        <li>HTTP 模組與處理器</li>
                                        <li>錯誤頁面設定</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>安全注意：</strong></p>
                                    <ul class="small mb-3">
                                        <li>敏感資訊需加密</li>
                                        <li>不能直接透過瀏覽器存取</li>
                                        <li>修改後會重啟應用程式</li>
                                        <li>語法錯誤會導致網站無法執行</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">Web.config 完整結構範例：</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;!-- 連線字串設定 --&gt;
  &lt;connectionStrings&gt;
    &lt;add name="DefaultConnection" 
         connectionString="Data Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\\Database.mdf;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;

  &lt;!-- 應用程式設定 --&gt;
  &lt;appSettings&gt;
    &lt;add key="SiteName" value="我的 Web Forms 網站" /&gt;
    &lt;add key="AdminEmail" value="admin@example.com" /&gt;
    &lt;add key="EnableDebugMode" value="true" /&gt;
  &lt;/appSettings&gt;

  &lt;!-- 系統網頁設定 --&gt;
  &lt;system.web&gt;
    &lt;!-- 編譯設定 --&gt;
    &lt;compilation debug="true" targetFramework="4.8" /&gt;
    &lt;httpRuntime targetFramework="4.8" maxRequestLength="4096" /&gt;
    
    &lt;!-- 驗證設定 --&gt;
    &lt;authentication mode="Forms"&gt;
      &lt;forms loginUrl="~/Login.aspx" timeout="30" /&gt;
    &lt;/authentication&gt;
    
    &lt;!-- 自訂錯誤頁面 --&gt;
    &lt;customErrors mode="On" defaultRedirect="~/ErrorPage.aspx"&gt;
      &lt;error statusCode="404" redirect="~/NotFound.aspx" /&gt;
    &lt;/customErrors&gt;
    
    &lt;!-- Session 設定 --&gt;
    &lt;sessionState mode="InProc" timeout="20" /&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-layout-template me-2"></i>Site.Master - 主版頁面</h5>
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h6 class="card-title mb-0"><i class="fa-solid fa-th-large me-2"></i>Site.Master 詳細說明</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>主要功能：</strong></p>
                                    <ul class="small mb-3">
                                        <li>定義網站統一版面</li>
                                        <li>包含共用的導航列</li>
                                        <li>提供內容佔位符</li>
                                        <li>引用共用的 CSS/JS</li>
                                        <li>設定網站標題和 meta 標籤</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <p class="card-text small"><strong>相關檔案：</strong></p>
                                    <ul class="small mb-3">
                                        <li>Site.Master.cs - 主版頁面邏輯</li>
                                        <li>Site.Master.designer.cs - 設計器產生</li>
                                        <li>Site.Mobile.Master - 行動版主版頁面</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="bg-light p-3 rounded">
                                <h6 class="mb-2">Site.Master 基本結構：</h6>
                                <div class="code-container">
                                    <button class="copy-btn" onclick="copyCode(this)">複製</button>
                                    <pre class="mb-0 small"><code>&lt;%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="WebApplication1.SiteMaster" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head runat="server"&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;&lt;%: Page.Title %&gt; - 我的 ASP.NET 應用程式&lt;/title&gt;
    
    &lt;!-- Bootstrap CSS --&gt;
    &lt;%: Styles.Render("~/Content/css") %&gt;
    &lt;link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" /&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;nav class="navbar navbar-expand-lg navbar-dark bg-dark"&gt;
            &lt;div class="container"&gt;
                &lt;a class="navbar-brand" href="~/"&gt;我的網站&lt;/a&gt;
                &lt;ul class="navbar-nav"&gt;
                    &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="~/"&gt;首頁&lt;/a&gt;&lt;/li&gt;
                    &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="~/About"&gt;關於&lt;/a&gt;&lt;/li&gt;
                    &lt;li class="nav-item"&gt;&lt;a class="nav-link" href="~/Contact"&gt;聯絡&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
        
        &lt;main class="container mt-4"&gt;
            &lt;asp:ContentPlaceHolder ID="MainContent" runat="server"&gt;
            &lt;/asp:ContentPlaceHolder&gt;
        &lt;/main&gt;
        
        &lt;footer class="bg-dark text-light mt-5 py-3"&gt;
            &lt;!-- 頁尾內容 --&gt;
        &lt;/footer&gt;
    &lt;/form&gt;
    
    &lt;!-- JavaScript --&gt;
    &lt;%: Scripts.Render("~/bundles/jquery") %&gt;
    &lt;%: Scripts.Render("~/bundles/bootstrap") %&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-file-alt me-2"></i>其他重要檔案</h5>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-image me-2"></i>favicon.ico</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>網站圖示檔案</p>
                                    <p class="card-text small"><strong>顯示位置：</strong></p>
                                    <ul class="small mb-2">
                                        <li>瀏覽器分頁標籤</li>
                                        <li>書籤列</li>
                                        <li>桌面捷徑</li>
                                        <li>搜尋引擎結果</li>
                                    </ul>
                                    <p class="card-text small"><strong>建議：</strong>使用 16x16 或 32x32 像素的 .ico 檔案</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-secondary text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-box me-2"></i>packages.config</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>NuGet 套件管理檔案</p>
                                    <p class="card-text small"><strong>記錄內容：</strong></p>
                                    <ul class="small mb-2">
                                        <li>已安裝的套件名稱</li>
                                        <li>套件版本號</li>
                                        <li>目標 Framework 版本</li>
                                        <li>套件相依性</li>
                                    </ul>
                                    <p class="card-text small"><strong>注意：</strong>不要手動編輯此檔案</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-link me-2"></i>Bundle.config</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>資源打包與最佳化設定</p>
                                    <p class="card-text small"><strong>功能：</strong></p>
                                    <ul class="small mb-2">
                                        <li>CSS/JS 檔案合併</li>
                                        <li>檔案壓縮</li>
                                        <li>減少 HTTP 請求</li>
                                        <li>提升載入效能</li>
                                    </ul>
                                    <div class="bg-light p-2 rounded">
                                        <pre class="mb-0" style="font-size: 10px;"><code>&lt;bundles&gt;
  &lt;styleBundle path="~/Content/css"&gt;
    &lt;include path="~/Content/bootstrap.css" /&gt;
    &lt;include path="~/Content/site.css" /&gt;
  &lt;/styleBundle&gt;
&lt;/bundles&gt;</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-mobile-alt me-2"></i>ViewSwitcher.ascx</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>使用者控制項</p>
                                    <p class="card-text small"><strong>功能：</strong></p>
                                    <ul class="small mb-2">
                                        <li>桌面版/行動版切換</li>
                                        <li>響應式設計輔助</li>
                                        <li>使用者體驗優化</li>
                                        <li>可重複使用元件</li>
                                    </ul>
                                    <p class="card-text small"><strong>檔案：</strong></p>
                                    <ul class="small mb-0">
                                        <li>ViewSwitcher.ascx - 介面</li>
                                        <li>ViewSwitcher.ascx.cs - 邏輯</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>開發重點提醒</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>必須了解的檔案：</strong></p>
                                <ul class="small mb-0">
                                    <li>🔴 Web.config - 系統設定</li>
                                    <li>🔴 Global.asax - 全域事件</li>
                                    <li>🟡 .aspx 檔案 - 頁面介面</li>
                                    <li>🟡 .aspx.cs - 頁面邏輯</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <p class="small mb-2"><strong>開發注意事項：</strong></p>
                                <ul class="small mb-0">
                                    <li>修改 Web.config 會重啟應用程式</li>
                                    <li>App_Data 資料夾內容受保護</li>
                                    <li>主版頁面影響所有子頁面</li>
                                    <li>Bundle 設定影響載入效能</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="aspnet-ui" class="py-3">
                <h2 class="text-warning fw-bold border-bottom pb-2 mb-3"><span class="badge bg-warning me-2">4</span>設計網頁介面</h2>
                
                <div id="aspnet-ui-designer" class="mb-4">
                    <h4 class="text-dark">4.1 使用設計器與原始碼編輯</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-paint-brush me-2"></i>Visual Studio 設計模式</h5>
                        <p class="mb-0">Visual Studio 提供三種編輯模式：設計檢視、原始碼檢視和分割檢視，讓開發者能靈活設計網頁介面。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-eye me-2"></i>三種編輯模式</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-desktop me-2 text-primary"></i>設計檢視 (Design)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>視覺化拖拉操作</p>
                                    <p class="card-text small"><strong>優點：</strong>直觀、快速佈局</p>
                                    <p class="card-text small"><strong>適用：</strong>初學者、快速原型</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-code me-2 text-success"></i>原始碼檢視 (Source)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>直接編輯 HTML/ASPX</p>
                                    <p class="card-text small"><strong>優點：</strong>精確控制、效能最佳</p>
                                    <p class="card-text small"><strong>適用：</strong>進階開發者</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-columns me-2 text-info"></i>分割檢視 (Split)</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>同時顯示設計與原始碼</p>
                                    <p class="card-text small"><strong>優點：</strong>即時預覽變更</p>
                                    <p class="card-text small"><strong>適用：</strong>學習階段</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-mouse-pointer me-2"></i>工具箱使用</h5>
                    
                    <div class="bg-light p-3 rounded mb-3">
                        <h6 class="mb-2">從工具箱拖拉控制項到頁面：</h6>
                        <ol class="small mb-0">
                            <li>開啟 Visual Studio 的「工具箱」視窗</li>
                            <li>展開「標準」或「資料」分類</li>
                            <li>選擇所需的控制項（如 Button、Label、TextBox）</li>
                            <li>拖拉到設計檢視的目標位置</li>
                            <li>在屬性視窗中調整控制項屬性</li>
                        </ol>
                    </div>
                </div>

                <div id="aspnet-ui-controls" class="mb-4">
                    <h4 class="text-dark">4.2 常用伺服器控制項</h4>
                    
                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-puzzle-piece me-2"></i>基本輸入控制項</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-warning">
                                <tr>
                                    <th>控制項</th>
                                    <th>用途</th>
                                    <th>常用屬性</th>
                                    <th>程式碼範例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>Label</code></td>
                                    <td>顯示文字</td>
                                    <td>Text, CssClass</td>
                                    <td><code>&lt;asp:Label ID="lblName" runat="server" Text="姓名" /&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>TextBox</code></td>
                                    <td>單行文字輸入</td>
                                    <td>Text, MaxLength</td>
                                    <td><code>&lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" /&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>Button</code></td>
                                    <td>觸發事件按鈕</td>
                                    <td>Text, OnClick</td>
                                    <td><code>&lt;asp:Button ID="btnSubmit" runat="server" Text="送出" OnClick="btnSubmit_Click" /&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>DropDownList</code></td>
                                    <td>下拉選單</td>
                                    <td>Items, SelectedValue</td>
                                    <td><code>&lt;asp:DropDownList ID="ddlCity" runat="server" CssClass="form-select"&gt;
            &lt;asp:ListItem Text="請選擇" Value="" /&gt;
            &lt;asp:ListItem Text="台北" Value="Taipei" /&gt;
            &lt;asp:ListItem Text="台中" Value="Taichung" /&gt;
            &lt;asp:ListItem Text="高雄" Value="Kaohsiung" /&gt;
        &lt;/asp:DropDownList&gt;</code></td>
                                </tr>
                                <tr>
                                    <td><code>CheckBox</code></td>
                                    <td>勾選框</td>
                                    <td>Checked, Text</td>
                                    <td><code>&lt;asp:CheckBox ID="chkAgree" runat="server" Text="我同意" /&gt;</code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-table me-2"></i>資料顯示控制項</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-th me-2"></i>GridView</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>表格形式顯示資料</p>
                                    <p class="card-text small"><strong>特色：</strong>支援分頁、排序、編輯</p>
                                    <div class="bg-light p-2 rounded mt-2">
                                        <code class="small">&lt;asp:GridView ID="gvUsers" runat="server" AutoGenerateColumns="false"&gt;<br>
                                        &nbsp;&nbsp;&lt;Columns&gt;<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;asp:BoundField DataField="Name" HeaderText="姓名" /&gt;<br>
                                        &nbsp;&nbsp;&lt;/Columns&gt;<br>
                                        &lt;/asp:GridView&gt;</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-repeat me-2"></i>Repeater</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>用途：</strong>重複顯示資料模板</p>
                                    <p class="card-text small"><strong>特色：</strong>完全自訂 HTML 輸出</p>
                                    <div class="bg-light p-2 rounded mt-2">
                                        <code class="small">&lt;asp:Repeater ID="rptNews" runat="server"&gt;<br>
                                        &nbsp;&nbsp;&lt;ItemTemplate&gt;<br>
                                        &nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;%# Eval("Title") %&lt;/div&gt;<br>
                                        &nbsp;&nbsp;&lt;/ItemTemplate&gt;<br>
                                        &lt;/asp:Repeater&gt;</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>容器控制項</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-square me-2 text-primary"></i>Panel</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small">產生 &lt;div&gt; 標籤的容器</p>
                                    <p class="card-text small">可控制顯示/隱藏</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-grip me-2 text-success"></i>PlaceHolder</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small">不產生額外 HTML 標籤</p>
                                    <p class="card-text small">適合動態加入控制項</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0"><i class="fa-solid fa-window-maximize me-2 text-info"></i>MultiView</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small">多頁面切換容器</p>
                                    <p class="card-text small">類似分頁效果</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>完整範例：用戶註冊表單</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <pre class="mb-0"><code>&lt;!-- 用戶註冊表單範例 --&gt;
&lt;asp:Panel ID="pnlRegister" runat="server" CssClass="container"&gt;
    &lt;h3&gt;用戶註冊&lt;/h3&gt;
    
    &lt;!-- 姓名輸入 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblName" runat="server" Text="姓名：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" MaxLength="50" /&gt;
    &lt;/div&gt;
    
    &lt;!-- Email 輸入 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblEmail" runat="server" Text="Email：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" TextMode="Email" /&gt;
    &lt;/div&gt;
    
    &lt;!-- 城市選擇 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblCity" runat="server" Text="城市：" CssClass="form-label" /&gt;
        &lt;asp:DropDownList ID="ddlCity" runat="server" CssClass="form-select"&gt;
            &lt;asp:ListItem Text="請選擇" Value="" /&gt;
            &lt;asp:ListItem Text="台北" Value="Taipei" /&gt;
            &lt;asp:ListItem Text="台中" Value="Taichung" /&gt;
            &lt;asp:ListItem Text="高雄" Value="Kaohsiung" /&gt;
        &lt;/asp:DropDownList&gt;
    &lt;/div&gt;
    
    &lt;!-- 同意條款 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:CheckBox ID="chkAgree" runat="server" Text="我同意服務條款" CssClass="form-check-input" /&gt;
    &lt;/div&gt;
    
    &lt;!-- 送出按鈕 --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Button ID="btnRegister" runat="server" Text="註冊" CssClass="btn btn-primary" 
                    OnClick="btnRegister_Click" /&gt;
        &lt;asp:Button ID="btnCancel" runat="server" Text="取消" CssClass="btn btn-secondary ms-2" 
                    OnClick="btnCancel_Click" /&gt;
    &lt;/div&gt;
    
    &lt;!-- 訊息顯示 --&gt;
    &lt;asp:Label ID="lblMessage" runat="server" CssClass="alert alert-info" Visible="false" /&gt;
&lt;/asp:Panel&gt;</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-tips me-2"></i>設計介面小技巧</h6>
                        <ul class="mb-0 small">
                            <li><strong>使用 Bootstrap CSS 類別</strong>讓介面更美觀現代</li>
                            <li><strong>善用 Panel 控制項</strong>組織和群組相關控制項</li>
                            <li><strong>設定有意義的 ID</strong>便於後續程式碼維護</li>
                            <li><strong>結合 HTML 與伺服器控制項</strong>達到最佳的彈性</li>
                            <li><strong>預覽不同瀏覽器</strong>確保跨瀏覽器相容性</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-logic" class="py-3">
                <h2 class="text-danger fw-bold border-bottom pb-2 mb-3"><span class="badge bg-danger me-2">5</span>事件處理與程式邏輯</h2>
                <div id="aspnet-logic-lifecycle" class="mb-4">
                    <h4 class="text-dark">5.1 Page Life Cycle（頁面生命週期）</h4>
                    
                    <div class="alert alert-danger border-start border-4 border-danger">
                        <h5 class="alert-heading"><i class="fa-solid fa-recycle me-2"></i>什麼是 Page Life Cycle？</h5>
                        <p class="mb-0">Page Life Cycle 是 ASP.NET Web Forms 的核心概念，描述了當 HTTP 請求達到伺服器時，頁面物件從建立到銷毀的完整過程。</p>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-timeline me-2"></i>主要生命週期階段</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-danger">
                                <tr>
                                    <th>階段</th>
                                    <th>事件</th>
                                    <th>用途</th>
                                    <th>常見使用</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1. 頁面初始化</strong></td>
                                    <td>PreInit</td>
                                    <td>設定主版頁面、佈景主題</td>
                                    <td>動態設定 MasterPage</td>
                                </tr>
                                <tr>
                                    <td><strong>2. 控制項初始化</strong></td>
                                    <td>Init</td>
                                    <td>初始化控制項設定</td>
                                    <td>設定控制項預設值</td>
                                </tr>
                                <tr class="table-warning">
                                    <td><strong>3. 頁面載入</strong></td>
                                    <td>Load</td>
                                    <td>主要業務邏輯處理</td>
                                    <td>最常使用的事件</td>
                                </tr>
                                <tr>
                                    <td><strong>4. 控制項事件</strong></td>
                                    <td>Control Events</td>
                                    <td>處理使用者互動</td>
                                    <td>按鈕點擊、文字改變</td>
                                </tr>
                                <tr>
                                    <td><strong>5. 頁面預渲染</strong></td>
                                    <td>PreRender</td>
                                    <td>最後的變更機會</td>
                                    <td>最終資料設定</td>
                                </tr>
                                <tr>
                                    <td><strong>6. 頁面銷毀</strong></td>
                                    <td>Unload</td>
                                    <td>清理資源</td>
                                    <td>關閉資料庫連線</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實用程式碼範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">完整的生命週期事件處理：</h6>
                        <pre class="mb-0"><code>public partial class Default : System.Web.UI.Page
{
    protected void Page_PreInit(object sender, EventArgs e)
    {
        // 1. 頁面初始化階段 - 動態設定 MasterPage
        if (Session["UserType"] != null && Session["UserType"].ToString() == "Admin")
        {
            this.MasterPageFile = "~/Admin.master";
        }
    }

    protected void Page_Init(object sender, EventArgs e)
    {
        // 2. 控制項初始化階段 - 設定控制項屬性
        Button dynButton = new Button();
        dynButton.ID = "btnDynamic";
        dynButton.Text = "動態按鈕";
        dynButton.Click += DynButton_Click;
        this.form1.Controls.Add(dynButton);
    }

    protected void Page_Load(object sender, EventArgs e)
    {
        // 3. 頁面載入階段 - 最常使用
        if (!IsPostBack)
        {
            // 首次載入時執行
            LoadInitialData();
        }
    }

    // 4. 控制項事件階段
    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        // 處理按鈕點擊事件
    }

    protected void Page_PreRender(object sender, EventArgs e)
    {
        // 5. 預渲染階段 - 最後的 UI 調整
        this.Title = "頁面已就緒 - " + DateTime.Now.ToString("HH:mm:ss");
    }

    protected void Page_Unload(object sender, EventArgs e)
    {
        // 6. 頁面銷毀階段 - 清理資源
        if (dbConnection != null)
        {
            dbConnection.Close();
            dbConnection.Dispose();
        }
    }
}</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-star me-2"></i>最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>Page_Load</strong> 是最常使用的事件，適合大部分業務邏輯</li>
                            <li>使用 <strong>IsPostBack</strong> 區分首次載入和 PostBack</li>
                            <li><strong>PreInit</strong> 用於動態設定 MasterPage 或 Theme</li>
                            <li><strong>PreRender</strong> 適合最後的 UI 調整</li>
                            <li><strong>Unload</strong> 用於清理資源，但不能使用 Response 物件</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-logic-events" class="mb-4">
                    <h4 class="text-dark">5.2 控制項事件（Click、TextChanged 等）</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-mouse-pointer me-2"></i>控制項事件處理</h5>
                        <p class="mb-0">控制項事件是 Web Forms 互動性的核心，讓開發者能夠回應使用者的各種操作行為。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-list me-2"></i>常用控制項事件</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-info">
                                <tr>
                                    <th>控制項</th>
                                    <th>事件</th>
                                    <th>觸發時機</th>
                                    <th>常見用途</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Button</strong></td>
                                    <td>Click</td>
                                    <td>點擊按鈕</td>
                                    <td>表單提交、操作執行</td>
                                </tr>
                                <tr>
                                    <td><strong>TextBox</strong></td>
                                    <td>TextChanged</td>
                                    <td>文字改變且失去焦點</td>
                                    <td>即時檢查、資料驗證</td>
                                </tr>
                                <tr>
                                    <td><strong>DropDownList</strong></td>
                                    <td>SelectedIndexChanged</td>
                                    <td>選項改變</td>
                                    <td>級聯選單、動態築選</td>
                                </tr>
                                <tr>
                                    <td><strong>CheckBox</strong></td>
                                    <td>CheckedChanged</td>
                                    <td>勾選狀態改變</td>
                                    <td>功能開關、選項控制</td>
                                </tr>
                                <tr>
                                    <td><strong>GridView</strong></td>
                                    <td>RowCommand</td>
                                    <td>資料列操作</td>
                                    <td>編輯、刪除、查看</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>Button Click 事件範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">ASPX 頁面：</h6>
                        <pre class="mb-3"><code>&lt;asp:Button ID="btnCalculate" runat="server" Text="計算" 
        CssClass="btn btn-primary" OnClick="btnCalculate_Click" /&gt;
&lt;asp:Label ID="lblResult" runat="server" CssClass="ms-2" /&gt;</code></pre>
                        
                        <h6 class="mb-2">C# 程式碼：</h6>
                        <pre class="mb-0"><code>protected void btnCalculate_Click(object sender, EventArgs e)
{
    try
    {
        int num1 = Convert.ToInt32(txtNumber1.Text);
        int num2 = Convert.ToInt32(txtNumber2.Text);
        int result = num1 + num2;
        
        lblResult.Text = $"{num1} + {num2} = {result}";
        lblResult.CssClass = "ms-2 text-success";
    }
    catch (Exception ex)
    {
        lblResult.Text = "輸入格式錯誤";
        lblResult.CssClass = "ms-2 text-danger";
    }
}</code></pre>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>注意事項</h6>
                        <ul class="mb-0 small">
                            <li><strong>AutoPostBack</strong> 會增加伺服器負載，請有節制地使用</li>
                            <li>事件處理中一定要包含 <strong>錯誤處理</strong></li>
                            <li>使用 <strong>Page.IsValid</strong> 驗證資料後再處理</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-data" class="py-3">
                <h2 class="text-primary fw-bold border-bottom pb-2 mb-3"><span class="badge bg-primary me-2">6</span>資料繫結與資料庫操作</h2>
                <div id="aspnet-data-binding" class="mb-4">
                    <h4 class="text-dark">6.1 使用 SqlDataSource、GridView 顯示資料</h4>
                    
                    <div class="alert alert-primary border-start border-4 border-primary">
                        <h5 class="alert-heading"><i class="fa-solid fa-table me-2"></i>資料繫結概念</h5>
                        <p class="mb-0">資料繫結是 Web Forms 的核心功能，允許控制項自動連接到資料來源，大幅簡化資料顯示和操作。</p>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-database me-2"></i>SqlDataSource 設定</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Web.config 連線字串設定：</h6>
                        <pre class="mb-3"><code>&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="DefaultConnection" 
         connectionString="Data Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\\Database.mdf;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
                        
                        <h6 class="mb-2">ASPX 頁面 SqlDataSource 宣告：</h6>
                        <pre class="mb-0"><code>&lt;asp:SqlDataSource ID="SqlDataSource1" runat="server" 
    ConnectionString="&lt;%$ ConnectionStrings:DefaultConnection %&gt;"
    SelectCommand="SELECT ID, Name, Email, Department FROM Employees"
    InsertCommand="INSERT INTO Employees (Name, Email, Department) VALUES (@Name, @Email, @Department)"
    UpdateCommand="UPDATE Employees SET Name=@Name, Email=@Email, Department=@Department WHERE ID=@ID"
    DeleteCommand="DELETE FROM Employees WHERE ID=@ID"&gt;
&lt;/asp:SqlDataSource&gt;</code></pre>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-th me-2"></i>GridView 資料顯示</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">基本 GridView 設定</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;asp:GridView ID="GridView1" runat="server" 
    DataSourceID="SqlDataSource1"
    AutoGenerateColumns="false"
    CssClass="table table-striped"
    AllowPaging="true" PageSize="10"
    AllowSorting="true"&gt;
    &lt;Columns&gt;
        &lt;asp:BoundField DataField="ID" 
            HeaderText="編號" SortExpression="ID" /&gt;
        &lt;asp:BoundField DataField="Name" 
            HeaderText="姓名" SortExpression="Name" /&gt;
        &lt;asp:BoundField DataField="Email" 
            HeaderText="電子郵件" SortExpression="Email" /&gt;
    &lt;/Columns&gt;
&lt;/asp:GridView&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">進階功能設定</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>AutoGenerateColumns="false"</strong> - 自定義欄位</li>
                                        <li><strong>AllowPaging="true"</strong> - 啟用分頁</li>
                                        <li><strong>AllowSorting="true"</strong> - 啟用排序</li>
                                        <li><strong>DataKeyNames="ID"</strong> - 設定主鍵</li>
                                        <li><strong>EmptyDataText</strong> - 無資料時顯示</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li>使用 <strong>參數化查詢</strong> 防止 SQL Injection</li>
                            <li>適當設定 <strong>分頁大小</strong> 提升效能</li>
                            <li>使用 <strong>DataKeyNames</strong> 進行資料操作</li>
                            <li>自定義欄位比 AutoGenerateColumns 更靈活</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-data-connection" class="mb-4">
                    <h4 class="text-dark">6.2 資料庫連線設定</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-link me-2"></i>連線字串管理</h5>
                        <p class="mb-0">正確的資料庫連線設定是 Web 應用程式穩定運行的基礎，需要考慮安全性、效能和維護性。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-server me-2"></i>常見資料庫類型</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-warning">
                                <tr>
                                    <th>資料庫</th>
                                    <th>Provider</th>
                                    <th>連線字串範例</th>
                                    <th>適用場景</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>SQL Server</strong></td>
                                    <td>System.Data.SqlClient</td>
                                    <td>Data Source=server;Initial Catalog=db</td>
                                    <td>企業級應用</td>
                                </tr>
                                <tr>
                                    <td><strong>LocalDB</strong></td>
                                    <td>System.Data.SqlClient</td>
                                    <td>Data Source=(LocalDB)\\v11.0</td>
                                    <td>開發測試</td>
                                </tr>
                                <tr>
                                    <td><strong>SQL Server Express</strong></td>
                                    <td>System.Data.SqlClient</td>
                                    <td>Data Source=.\\SQLEXPRESS</td>
                                    <td>中小型應用</td>
                                </tr>
                                <tr>
                                    <td><strong>Access</strong></td>
                                    <td>System.Data.OleDb</td>
                                    <td>Provider=Microsoft.ACE.OLEDB.12.0</td>
                                    <td>簡單應用</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>連線字串設定方法</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">方法1：Web.config 設定（推薦）</h6>
                        <pre class="mb-3"><code>&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;!-- 開發環境 --&gt;
    &lt;add name="DevConnection" 
         connectionString="Data Source=(LocalDB)\\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\\MyApp.mdf;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
    
    &lt;!-- 正式環境 --&gt;
    &lt;add name="ProdConnection" 
         connectionString="Data Source=prod-server;Initial Catalog=MyAppDB;User ID=webapp;Password=secretkey;" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;</code></pre>
                        
                        <h6 class="mb-2">方法2：程式碼中使用連線字串</h6>
                        <pre class="mb-0"><code>// 讀取 Web.config 中的連線字串
string connString = ConfigurationManager.ConnectionStrings["DevConnection"].ConnectionString;

// 建立資料庫連線
using (SqlConnection conn = new SqlConnection(connString))
{
    conn.Open();
    
    string sql = "SELECT COUNT(*) FROM Users WHERE IsActive = 1";
    using (SqlCommand cmd = new SqlCommand(sql, conn))
    {
        int activeUsers = (int)cmd.ExecuteScalar();
        lblActiveUsers.Text = $"活躍用戶：{activeUsers} 人";
    }
}</code></pre>
                    </div>

                    <div class="alert alert-danger mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-shield-alt me-2"></i>安全性考量</h6>
                        <ul class="mb-0 small">
                            <li><strong>不要</strong>在程式碼中硬編碼連線字串</li>
                            <li>使用 <strong>Windows 驗證</strong> 或 <strong>SQL Server 驗證</strong></li>
                            <li>定期更換 <strong>資料庫密碼</strong></li>
                            <li>限制資料庫用戶的 <strong>最小權限</strong></li>
                            <li>使用 <strong>連線池 (Connection Pooling)</strong> 提升效能</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- CRUD 操作專門章節 -->
            <section id="crud-operations" class="py-3">
                <h2 class="text-secondary fw-bold border-bottom pb-2 mb-3"><span class="badge bg-secondary me-2">6.5</span>CRUD 資料操作</h2>
                
                <div class="alert alert-secondary border-start border-4 border-secondary">
                    <h5 class="alert-heading"><i class="fa-solid fa-database me-2"></i>什麼是 CRUD？</h5>
                    <p class="mb-0">CRUD 是四種基本資料庫操作的縮寫：Create (建立)、Read (讀取)、Update (更新)、Delete (刪除)。這些操作構成了大部分資料驅動應用程式的核心功能。</p>
                </div>

                <div id="crud-create" class="mb-4">
                    <h4 class="text-secondary">6.5.1 Create - 新增資料</h4>
                    
                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-plus me-2"></i>HTTP POST 與資料新增</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-success text-white">
                                    <h6 class="card-title mb-0">HTTP 層面</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>方法：</strong>POST</li>
                                        <li><strong>狀態碼：</strong>201 Created</li>
                                        <li><strong>內容：</strong>新增的資料</li>
                                        <li><strong>位置：</strong>資料在請求主體</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">Web Forms 實作</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>控制項：</strong>TextBox, DropDownList</li>
                                        <li><strong>事件：</strong>Button Click</li>
                                        <li><strong>方法：</strong>SqlCommand.ExecuteNonQuery</li>
                                        <li><strong>SQL：</strong>INSERT INTO 語句</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實作範例：新增使用者</h5>
                    
                    <!-- ASPX 頁面 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">ASPX 頁面設計</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>&lt;div class="container mt-4"&gt;
    &lt;h3&gt;新增使用者&lt;/h3&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblName" runat="server" Text="姓名：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" /&gt;
        &lt;asp:RequiredFieldValidator ID="rfvName" runat="server" 
                ControlToValidate="txtName" ErrorMessage="請輸入姓名" 
                CssClass="text-danger" /&gt;
    &lt;/div&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblEmail" runat="server" Text="Email：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" TextMode="Email" /&gt;
        &lt;asp:RequiredFieldValidator ID="rfvEmail" runat="server" 
                ControlToValidate="txtEmail" ErrorMessage="請輸入Email" 
                CssClass="text-danger" /&gt;
    &lt;/div&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblAge" runat="server" Text="年齡：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtAge" runat="server" CssClass="form-control" TextMode="Number" /&gt;
        &lt;asp:RangeValidator ID="rvAge" runat="server" 
                ControlToValidate="txtAge" MinimumValue="1" MaximumValue="120" 
                Type="Integer" ErrorMessage="年齡必須在1-120之間" 
                CssClass="text-danger" /&gt;
    &lt;/div&gt;
    
    &lt;asp:Button ID="btnCreate" runat="server" Text="新增" CssClass="btn btn-success" 
            OnClick="btnCreate_Click" /&gt;
    &lt;asp:Label ID="lblMessage" runat="server" CssClass="ms-2" /&gt;
&lt;/div&gt;</code></pre>
                        </div>
                    </div>

                    <!-- C# 程式碼 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">C# 程式碼 (Code-Behind)</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>using System;
using System.Data.SqlClient;
using System.Configuration;
using System.Web.UI;

public partial class CreateUser : Page
{
    protected void btnCreate_Click(object sender, EventArgs e)
    {
        if (Page.IsValid)
        {
            try
            {
                // 從 Web.config 取得連線字串
                string connectionString = ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString;
                
                using (SqlConnection conn = new SqlConnection(connectionString))
                {
                    // SQL INSERT 語句
                    string sql = @"INSERT INTO Users (Name, Email, Age, CreatedDate) 
                                   VALUES (@Name, @Email, @Age, @CreatedDate)";
                    
                    using (SqlCommand cmd = new SqlCommand(sql, conn))
                    {
                        // 參數化查詢，防止 SQL Injection
                        cmd.Parameters.AddWithValue("@Name", txtName.Text.Trim());
                        cmd.Parameters.AddWithValue("@Email", txtEmail.Text.Trim());
                        cmd.Parameters.AddWithValue("@Age", Convert.ToInt32(txtAge.Text));
                        cmd.Parameters.AddWithValue("@CreatedDate", DateTime.Now);
                        
                        conn.Open();
                        int rowsAffected = cmd.ExecuteNonQuery();
                        
                        if (rowsAffected > 0)
                        {
                            lblMessage.Text = "使用者新增成功！";
                            lblMessage.CssClass = "ms-2 text-success";
                            ClearForm();
                        }
                        else
                        {
                            lblMessage.Text = "新增失敗，請重試。";
                            lblMessage.CssClass = "ms-2 text-danger";
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                lblMessage.Text = "發生錯誤：" + ex.Message;
                lblMessage.CssClass = "ms-2 text-danger";
            }
        }
    }
    
    private void ClearForm()
    {
        txtName.Text = "";
        txtEmail.Text = "";
        txtAge.Text = "";
    }
}</code></pre>
                        </div>
                    </div>
                </div>

                <div id="crud-read" class="mb-4">
                    <h4 class="text-secondary">6.5.2 Read - 讀取資料</h4>
                    
                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-eye me-2"></i>HTTP GET 與資料讀取</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-info text-white">
                                    <h6 class="card-title mb-0">HTTP 層面</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>方法：</strong>GET</li>
                                        <li><strong>狀態碼：</strong>200 OK</li>
                                        <li><strong>參數：</strong>查詢字串或路由</li>
                                        <li><strong>回應：</strong>資料在回應主體</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">Web Forms 實作</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>控制項：</strong>GridView, Repeater</li>
                                        <li><strong>事件：</strong>Page_Load</li>
                                        <li><strong>方法：</strong>SqlCommand.ExecuteReader</li>
                                        <li><strong>SQL：</strong>SELECT 語句</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實作範例：顯示使用者列表</h5>
                    
                    <!-- ASPX 頁面 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">使用 GridView 顯示資料</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>&lt;div class="container mt-4"&gt;
    &lt;h3&gt;使用者列表&lt;/h3&gt;
    
    &lt;!-- 搜尋功能 --&gt;
    &lt;div class="row mb-3"&gt;
        &lt;div class="col-md-6"&gt;
            &lt;asp:TextBox ID="txtSearch" runat="server" CssClass="form-control" 
                    placeholder="搜尋姓名或Email" /&gt;
        &lt;/div&gt;
        &lt;div class="col-md-6"&gt;
            &lt;asp:Button ID="btnSearch" runat="server" Text="搜尋" CssClass="btn btn-primary" 
                    OnClick="btnSearch_Click" /&gt;
            &lt;asp:Button ID="btnShowAll" runat="server" Text="顯示全部" CssClass="btn btn-secondary ms-2" 
                    OnClick="btnShowAll_Click" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;!-- 資料顯示 --&gt;
    &lt;asp:GridView ID="gvUsers" runat="server" CssClass="table table-striped table-hover" 
            AutoGenerateColumns="false" EmptyDataText="沒有找到使用者資料"&gt;
        &lt;Columns&gt;
            &lt;asp:BoundField DataField="UserId" HeaderText="ID" /&gt;
            &lt;asp:BoundField DataField="Name" HeaderText="姓名" /&gt;
            &lt;asp:BoundField DataField="Email" HeaderText="Email" /&gt;
            &lt;asp:BoundField DataField="Age" HeaderText="年齡" /&gt;
            &lt;asp:BoundField DataField="CreatedDate" HeaderText="建立時間" DataFormatString="{0:yyyy/MM/dd}" /&gt;
            &lt;asp:TemplateField HeaderText="操作"&gt;
                &lt;ItemTemplate&gt;
                    &lt;asp:LinkButton ID="lnkEdit" runat="server" Text="編輯" CssClass="btn btn-sm btn-warning me-1"
                            CommandName="Edit" CommandArgument='&lt;%# Eval("UserId") %&gt;' /&gt;
                    &lt;asp:LinkButton ID="lnkDelete" runat="server" Text="刪除" CssClass="btn btn-sm btn-danger"
                            CommandName="Delete" CommandArgument='&lt;%# Eval("UserId") %&gt;' 
                            OnClientClick="return confirm('確定要刪除這位使用者嗎？');" /&gt;
                &lt;/ItemTemplate&gt;
            &lt;/asp:TemplateField&gt;
        &lt;/Columns&gt;
    &lt;/asp:GridView&gt;
&lt;/div&gt;</code></pre>
                        </div>
                    </div>

                    <!-- C# 程式碼 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">C# 程式碼 (Code-Behind)</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>using System;
using System.Data;
using System.Data.SqlClient;
using System.Configuration;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class UserList : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            LoadUsers();
        }
    }
    
    private void LoadUsers(string searchTerm = "")
    {
        try
        {
            string connectionString = ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString;
            
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                string sql = @"SELECT UserId, Name, Email, Age, CreatedDate 
                               FROM Users 
                               WHERE (@SearchTerm = '' OR Name LIKE @SearchTerm OR Email LIKE @SearchTerm)
                               ORDER BY CreatedDate DESC";
                
                using (SqlCommand cmd = new SqlCommand(sql, conn))
                {
                    cmd.Parameters.AddWithValue("@SearchTerm", string.IsNullOrEmpty(searchTerm) ? "" : "%" + searchTerm + "%");
                    
                    using (SqlDataAdapter adapter = new SqlDataAdapter(cmd))
                    {
                        DataTable dt = new DataTable();
                        adapter.Fill(dt);
                        
                        gvUsers.DataSource = dt;
                        gvUsers.DataBind();
                    }
                }
            }
        }
        catch (Exception ex)
        {
            // 錯誤處理
            Response.Write("&lt;script&gt;alert('載入資料時發生錯誤：" + ex.Message + "');&lt;/script&gt;");
        }
    }
    
    protected void btnSearch_Click(object sender, EventArgs e)
    {
        LoadUsers(txtSearch.Text.Trim());
    }
    
    protected void btnShowAll_Click(object sender, EventArgs e)
    {
        txtSearch.Text = "";
        LoadUsers();
    }
}</code></pre>
                        </div>
                    </div>
                </div>

                <div id="crud-update" class="mb-4">
                    <h4 class="text-secondary">6.5.3 Update - 更新資料</h4>
                    
                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-edit me-2"></i>HTTP PUT/POST 與資料更新</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-warning text-dark">
                                    <h6 class="card-title mb-0">HTTP 層面</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>方法：</strong>PUT 或 POST</li>
                                        <li><strong>狀態碼：</strong>200 OK</li>
                                        <li><strong>識別：</strong>資源 ID</li>
                                        <li><strong>內容：</strong>更新的資料</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">Web Forms 實作</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>傳遞：</strong>QueryString 或 Session</li>
                                        <li><strong>事件：</strong>Button Click</li>
                                        <li><strong>方法：</strong>SqlCommand.ExecuteNonQuery</li>
                                        <li><strong>SQL：</strong>UPDATE 語句</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實作範例：編輯使用者</h5>
                    
                    <!-- ASPX 頁面 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">ASPX 頁面設計</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>&lt;div class="container mt-4"&gt;
    &lt;h3&gt;編輯使用者&lt;/h3&gt;
    
    &lt;!-- 隱藏的 UserId --&gt;
    &lt;asp:HiddenField ID="hfUserId" runat="server" /&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblName" runat="server" Text="姓名：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" /&gt;
        &lt;asp:RequiredFieldValidator ID="rfvName" runat="server" 
                ControlToValidate="txtName" ErrorMessage="請輸入姓名" 
                CssClass="text-danger" /&gt;
    &lt;/div&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblEmail" runat="server" Text="Email：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" TextMode="Email" /&gt;
        &lt;asp:RequiredFieldValidator ID="rfvEmail" runat="server" 
                ControlToValidate="txtEmail" ErrorMessage="請輸入Email" 
                CssClass="text-danger" /&gt;
    &lt;/div&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblAge" runat="server" Text="年齡：" CssClass="form-label" /&gt;
        &lt;asp:TextBox ID="txtAge" runat="server" CssClass="form-control" TextMode="Number" /&gt;
        &lt;asp:RangeValidator ID="rvAge" runat="server" 
                ControlToValidate="txtAge" MinimumValue="1" MaximumValue="120" 
                Type="Integer" ErrorMessage="年齡必須在1-120之間" 
                CssClass="text-danger" /&gt;
    &lt;/div&gt;
    
    &lt;asp:Button ID="btnUpdate" runat="server" Text="更新" CssClass="btn btn-warning" 
            OnClick="btnUpdate_Click" /&gt;
    &lt;asp:Button ID="btnCancel" runat="server" Text="取消" CssClass="btn btn-secondary ms-2" 
            OnClick="btnCancel_Click" /&gt;
    &lt;asp:Label ID="lblMessage" runat="server" CssClass="ms-2" /&gt;
&lt;/div&gt;</code></pre>
                        </div>
                    </div>

                    <!-- C# 程式碼 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">C# 程式碼 (Code-Behind)</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>public partial class EditUser : Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            // 從 QueryString 取得要編輯的 UserId
            string userId = Request.QueryString["id"];
            if (!string.IsNullOrEmpty(userId))
            {
                hfUserId.Value = userId;
                LoadUserData(Convert.ToInt32(userId));
            }
            else
            {
                Response.Redirect("UserList.aspx");
            }
        }
    }
    
    private void LoadUserData(int userId)
    {
        try
        {
            string connectionString = ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString;
            
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                string sql = "SELECT Name, Email, Age FROM Users WHERE UserId = @UserId";
                
                using (SqlCommand cmd = new SqlCommand(sql, conn))
                {
                    cmd.Parameters.AddWithValue("@UserId", userId);
                    
                    conn.Open();
                    using (SqlDataReader reader = cmd.ExecuteReader())
                    {
                        if (reader.Read())
                        {
                            txtName.Text = reader["Name"].ToString();
                            txtEmail.Text = reader["Email"].ToString();
                            txtAge.Text = reader["Age"].ToString();
                        }
                        else
                        {
                            Response.Redirect("UserList.aspx");
                        }
                    }
                }
            }
        }
        catch (Exception ex)
        {
            lblMessage.Text = "載入資料時發生錯誤：" + ex.Message;
            lblMessage.CssClass = "ms-2 text-danger";
        }
    }
    
    protected void btnUpdate_Click(object sender, EventArgs e)
    {
        if (Page.IsValid)
        {
            try
            {
                string connectionString = ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString;
                
                using (SqlConnection conn = new SqlConnection(connectionString))
                {
                    string sql = @"UPDATE Users 
                                   SET Name = @Name, Email = @Email, Age = @Age, ModifiedDate = @ModifiedDate 
                                   WHERE UserId = @UserId";
                    
                    using (SqlCommand cmd = new SqlCommand(sql, conn))
                    {
                        cmd.Parameters.AddWithValue("@UserId", Convert.ToInt32(hfUserId.Value));
                        cmd.Parameters.AddWithValue("@Name", txtName.Text.Trim());
                        cmd.Parameters.AddWithValue("@Email", txtEmail.Text.Trim());
                        cmd.Parameters.AddWithValue("@Age", Convert.ToInt32(txtAge.Text));
                        cmd.Parameters.AddWithValue("@ModifiedDate", DateTime.Now);
                        
                        conn.Open();
                        int rowsAffected = cmd.ExecuteNonQuery();
                        
                        if (rowsAffected > 0)
                        {
                            lblMessage.Text = "使用者資料更新成功！";
                            lblMessage.CssClass = "ms-2 text-success";
                        }
                        else
                        {
                            lblMessage.Text = "更新失敗，請重試。";
                            lblMessage.CssClass = "ms-2 text-danger";
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                lblMessage.Text = "發生錯誤：" + ex.Message;
                lblMessage.CssClass = "ms-2 text-danger";
            }
        }
    }
    
    protected void btnCancel_Click(object sender, EventArgs e)
    {
        Response.Redirect("UserList.aspx");
    }
}</code></pre>
                        </div>
                    </div>
                </div>

                <div id="crud-delete" class="mb-4">
                    <h4 class="text-secondary">6.5.4 Delete - 刪除資料</h4>
                    
                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-trash me-2"></i>HTTP DELETE 與資料刪除</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-danger text-white">
                                    <h6 class="card-title mb-0">HTTP 層面</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>方法：</strong>DELETE 或 POST</li>
                                        <li><strong>狀態碼：</strong>204 No Content</li>
                                        <li><strong>識別：</strong>資源 ID</li>
                                        <li><strong>安全：</strong>需要確認操作</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-primary text-white">
                                    <h6 class="card-title mb-0">Web Forms 實作</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li><strong>確認：</strong>JavaScript confirm</li>
                                        <li><strong>事件：</strong>LinkButton Click</li>
                                        <li><strong>方法：</strong>SqlCommand.ExecuteNonQuery</li>
                                        <li><strong>SQL：</strong>DELETE 語句</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實作範例：刪除使用者</h5>
                    
                    <!-- C# 程式碼 -->
                    <div class="mb-3">
                        <h6 class="text-secondary mb-2">GridView 中的刪除功能</h6>
                        <div class="bg-light p-3 rounded">
                            <pre class="mb-0"><code>public partial class UserList : Page
{
    protected void gvUsers_RowCommand(object sender, GridViewCommandEventArgs e)
    {
        if (e.CommandName == "Delete")
        {
            int userId = Convert.ToInt32(e.CommandArgument);
            DeleteUser(userId);
        }
        else if (e.CommandName == "Edit")
        {
            int userId = Convert.ToInt32(e.CommandArgument);
            Response.Redirect("EditUser.aspx?id=" + userId);
        }
    }
    
    private void DeleteUser(int userId)
    {
        try
        {
            string connectionString = ConfigurationManager.ConnectionStrings["DefaultConnection"].ConnectionString;
            
            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                // 先檢查是否有相關資料需要處理
                string checkSql = "SELECT COUNT(*) FROM UserOrders WHERE UserId = @UserId";
                using (SqlCommand checkCmd = new SqlCommand(checkSql, conn))
                {
                    checkCmd.Parameters.AddWithValue("@UserId", userId);
                    conn.Open();
                    int relatedCount = (int)checkCmd.ExecuteScalar();
                    
                    if (relatedCount > 0)
                    {
                        // 有相關資料，執行軟刪除或提示用戶
                        string softDeleteSql = "UPDATE Users SET IsDeleted = 1, DeletedDate = @DeletedDate WHERE UserId = @UserId";
                        using (SqlCommand softCmd = new SqlCommand(softDeleteSql, conn))
                        {
                            softCmd.Parameters.AddWithValue("@UserId", userId);
                            softCmd.Parameters.AddWithValue("@DeletedDate", DateTime.Now);
                            softCmd.ExecuteNonQuery();
                        }
                    }
                    else
                    {
                        // 沒有相關資料，可以直接刪除
                        string deleteSql = "DELETE FROM Users WHERE UserId = @UserId";
                        using (SqlCommand deleteCmd = new SqlCommand(deleteSql, conn))
                        {
                            deleteCmd.Parameters.AddWithValue("@UserId", userId);
                            deleteCmd.ExecuteNonQuery();
                        }
                    }
                }
            }
            
            // 重新載入資料
            LoadUsers();
            
            ScriptManager.RegisterStartupScript(this, GetType(), "alert", 
                "alert('使用者已成功刪除！');", true);
        }
        catch (Exception ex)
        {
            ScriptManager.RegisterStartupScript(this, GetType(), "alert", 
                "alert('刪除時發生錯誤：" + ex.Message + "');", true);
        }
    }
}</code></pre>
                        </div>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>刪除操作的重要考量</h6>
                        <ul class="mb-0 small">
                            <li><strong>確認機制：</strong>使用 JavaScript confirm 或模態對話框</li>
                            <li><strong>軟刪除：</strong>對於重要資料，考慮使用標記刪除而非實際刪除</li>
                            <li><strong>外鍵約束：</strong>處理相關資料的刪除或更新</li>
                            <li><strong>權限檢查：</strong>確保使用者有刪除權限</li>
                            <li><strong>日誌記錄：</strong>記錄刪除操作的詳細資訊</li>
                        </ul>
                    </div>
                </div>

                <div id="crud-practice" class="mb-4">
                    <h4 class="text-secondary">6.5.5 CRUD 實作練習</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-tasks me-2"></i>完整的 CRUD 應用程式練習</h5>
                        <p class="mb-0">結合以上所學，建立一個完整的使用者管理系統，包含所有 CRUD 操作。</p>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-list-check me-2"></i>練習要求</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">功能需求</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>✅ 新增使用者 (Create)</li>
                                        <li>✅ 顯示使用者列表 (Read)</li>
                                        <li>✅ 編輯使用者資料 (Update)</li>
                                        <li>✅ 刪除使用者 (Delete)</li>
                                        <li>✅ 搜尋功能</li>
                                        <li>✅ 資料驗證</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">技術要求</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>🛠️ 使用 ASP.NET Web Forms</li>
                                        <li>🛠️ SQL Server 資料庫</li>
                                        <li>🛠️ 參數化查詢防止 SQL Injection</li>
                                        <li>🛠️ 適當的錯誤處理</li>
                                        <li>🛠️ Bootstrap 美化介面</li>
                                        <li>🛠️ 響應式設計</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-database me-2"></i>資料庫設計</h5>
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Users 資料表結構：</h6>
                        <pre class="mb-0"><code>CREATE TABLE Users (
    UserId int IDENTITY(1,1) PRIMARY KEY,
    Name nvarchar(100) NOT NULL,
    Email nvarchar(255) NOT NULL UNIQUE,
    Age int NOT NULL CHECK (Age > 0 AND Age <= 120),
    Phone nvarchar(20),
    Address nvarchar(500),
    IsDeleted bit DEFAULT 0,
    CreatedDate datetime2 DEFAULT GETDATE(),
    ModifiedDate datetime2 NULL,
    DeletedDate datetime2 NULL
);</code></pre>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-sitemap me-2"></i>網站導航結構</h5>
                    <div class="bg-light p-3 rounded">
                        <ul class="mb-0">
                            <li><strong>Default.aspx</strong> - 首頁，顯示系統介紹</li>
                            <li><strong>UserList.aspx</strong> - 使用者列表頁面 (Read + Delete)</li>
                            <li><strong>CreateUser.aspx</strong> - 新增使用者頁面 (Create)</li>
                            <li><strong>EditUser.aspx</strong> - 編輯使用者頁面 (Update)</li>
                            <li><strong>Site.Master</strong> - 主版頁面，包含導航選單</li>
                        </ul>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-graduation-cap me-2"></i>學習成果</h6>
                        <p class="mb-2">完成這個練習後，您將能夠：</p>
                        <ul class="mb-0 small">
                            <li>理解 HTTP 方法與 CRUD 操作的對應關係</li>
                            <li>在 ASP.NET Web Forms 中實作完整的資料操作</li>
                            <li>運用適當的資料驗證和錯誤處理</li>
                            <li>設計使用者友善的操作介面</li>
                            <li>處理資料庫相關的安全性問題</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-state" class="py-3">
                <h2 class="text-success fw-bold border-bottom pb-2 mb-3"><span class="badge bg-success me-2">7</span>狀態管理</h2>
                <div id="aspnet-state-management" class="mb-4">
                    <h4 class="text-dark">7.1 ViewState、Session、Cookie、Application</h4>
                    
                    <div class="alert alert-success border-start border-4 border-success">
                        <h5 class="alert-heading"><i class="fa-solid fa-memory me-2"></i>狀態管理的重要性</h5>
                        <p class="mb-0">HTTP 是無狀態協定，為了保持使用者在網頁之間的資料和狀態，Web Forms 提供了多種狀態管理機制。</p>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>狀態管理機制比較</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-success">
                                <tr>
                                    <th>狀態管理</th>
                                    <th>範圍</th>
                                    <th>存放位置</th>
                                    <th>生命週期</th>
                                    <th>適用情況</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ViewState</strong></td>
                                    <td>單一頁面</td>
                                    <td>用戶端 (隱藏欄位)</td>
                                    <td>頁面生命週期</td>
                                    <td>控制項狀態保持</td>
                                </tr>
                                <tr>
                                    <td><strong>Session</strong></td>
                                    <td>使用者工作階段</td>
                                    <td>伺服器記憶體</td>
                                    <td>20分鐘 (預設)</td>
                                    <td>使用者登入狀態</td>
                                </tr>
                                <tr>
                                    <td><strong>Cookie</strong></td>
                                    <td>特定網域</td>
                                    <td>用戶端磁碟</td>
                                    <td>可設定過期</td>
                                    <td>記住使用者偏好</td>
                                </tr>
                                <tr>
                                    <td><strong>Application</strong></td>
                                    <td>整個應用程式</td>
                                    <td>伺服器記憶體</td>
                                    <td>應用程式重啟</td>
                                    <td>全域設定、計數器</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>使用範例</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">ViewState 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 啟用/禁用 ViewState
this.EnableViewState = false;

// 使用 ViewState 存放資料
ViewState["UserPreference"] = "DarkMode";
string preference = ViewState["UserPreference"] as string;

// 控制單一控制項的 ViewState
txtUserName.EnableViewState = false;</code></pre>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Session 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 存放使用者資料
Session["UserId"] = 123;
Session["UserName"] = "John";
Session["LoginTime"] = DateTime.Now;

// 讀取 Session 資料
                                        <li>✅ 新增使用者 (Create)</li>
                                        <li>✅ 顯示使用者列表 (Read)</li>
                                        <li>✅ 編輯使用者資料 (Update)</li>
                                        <li>✅ 刪除使用者 (Delete)</li>
                                        <li>✅ 搜尋功能</li>
                                        <li>✅ 資料驗證</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">技術要求</h6>
                                </div>
                                <div class="card-body">
                                    <ul class="small mb-0">
                                        <li>🛠️ 使用 ASP.NET Web Forms</li>
                                        <li>🛠️ SQL Server 資料庫</li>
                                        <li>🛠️ 參數化查詢防止 SQL Injection</li>
                                        <li>🛠️ 適當的錯誤處理</li>
                                        <li>🛠️ Bootstrap 美化介面</li>
                                        <li>🛠️ 響應式設計</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-database me-2"></i>資料庫設計</h5>
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Users 資料表結構：</h6>
                        <pre class="mb-0"><code>CREATE TABLE Users (
    UserId int IDENTITY(1,1) PRIMARY KEY,
    Name nvarchar(100) NOT NULL,
    Email nvarchar(255) NOT NULL UNIQUE,
    Age int NOT NULL CHECK (Age > 0 AND Age <= 120),
    Phone nvarchar(20),
    Address nvarchar(500),
    IsDeleted bit DEFAULT 0,
    CreatedDate datetime2 DEFAULT GETDATE(),
    ModifiedDate datetime2 NULL,
    DeletedDate datetime2 NULL
);</code></pre>
                    </div>

                    <h5 class="text-secondary mt-4 mb-3"><i class="fa-solid fa-sitemap me-2"></i>網站導航結構</h5>
                    <div class="bg-light p-3 rounded">
                        <ul class="mb-0">
                            <li><strong>Default.aspx</strong> - 首頁，顯示系統介紹</li>
                            <li><strong>UserList.aspx</strong> - 使用者列表頁面 (Read + Delete)</li>
                            <li><strong>CreateUser.aspx</strong> - 新增使用者頁面 (Create)</li>
                            <li><strong>EditUser.aspx</strong> - 編輯使用者頁面 (Update)</li>
                            <li><strong>Site.Master</strong> - 主版頁面，包含導航選單</li>
                        </ul>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-graduation-cap me-2"></i>學習成果</h6>
                        <p class="mb-2">完成這個練習後，您將能夠：</p>
                        <ul class="mb-0 small">
                            <li>理解 HTTP 方法與 CRUD 操作的對應關係</li>
                            <li>在 ASP.NET Web Forms 中實作完整的資料操作</li>
                            <li>運用適當的資料驗證和錯誤處理</li>
                            <li>設計使用者友善的操作介面</li>
                            <li>處理資料庫相關的安全性問題</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-state" class="py-3">
                <h2 class="text-success fw-bold border-bottom pb-2 mb-3"><span class="badge bg-success me-2">7</span>狀態管理</h2>
                <div id="aspnet-state-management" class="mb-4">
                    <h4 class="text-dark">7.1 ViewState、Session、Cookie、Application</h4>
                    
                    <div class="alert alert-success border-start border-4 border-success">
                        <h5 class="alert-heading"><i class="fa-solid fa-memory me-2"></i>狀態管理的重要性</h5>
                        <p class="mb-0">HTTP 是無狀態協定，為了保持使用者在網頁之間的資料和狀態，Web Forms 提供了多種狀態管理機制。</p>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>狀態管理機制比較</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-success">
                                <tr>
                                    <th>狀態管理</th>
                                    <th>範圍</th>
                                    <th>存放位置</th>
                                    <th>生命週期</th>
                                    <th>適用情況</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>ViewState</strong></td>
                                    <td>單一頁面</td>
                                    <td>用戶端 (隱藏欄位)</td>
                                    <td>頁面生命週期</td>
                                    <td>控制項狀態保持</td>
                                </tr>
                                <tr>
                                    <td><strong>Session</strong></td>
                                    <td>使用者工作階段</td>
                                    <td>伺服器記憶體</td>
                                    <td>20分鐘 (預設)</td>
                                    <td>使用者登入狀態</td>
                                </tr>
                                <tr>
                                    <td><strong>Cookie</strong></td>
                                    <td>特定網域</td>
                                    <td>用戶端磁碟</td>
                                    <td>可設定過期</td>
                                    <td>記住使用者偏好</td>
                                </tr>
                                <tr>
                                    <td><strong>Application</strong></td>
                                    <td>整個應用程式</td>
                                    <td>伺服器記憶體</td>
                                    <td>應用程式重啟</td>
                                    <td>全域設定、計數器</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-success mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>使用範例</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">ViewState 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 啟用/禁用 ViewState
this.EnableViewState = false;

// 使用 ViewState 存放資料
ViewState["UserPreference"] = "DarkMode";
string preference = ViewState["UserPreference"] as string;

// 控制單一控制項的 ViewState
txtUserName.EnableViewState = false;</code></pre>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Session 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 存放使用者資料
Session["UserId"] = 123;
Session["UserName"] = "John";
Session["LoginTime"] = DateTime.Now;

// 讀取 Session 資料
if (Session["UserId"] != null)
{
    int userId = (int)Session["UserId"];
    string userName = Session["UserName"].ToString();
}</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Cookie 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 建立 Cookie
HttpCookie userCookie = new HttpCookie("UserSettings");
userCookie["Theme"] = "Dark";
userCookie["Language"] = "zh-TW";
userCookie.Expires = DateTime.Now.AddDays(30);
Response.Cookies.Add(userCookie);

// 讀取 Cookie
if (Request.Cookies["UserSettings"] != null)
{
    string theme = Request.Cookies["UserSettings"]["Theme"];
}</code></pre>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Application 使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>// 存放全域設定
Application["SiteName"] = "我的網站";
Application["VisitorCount"] = 0;

// 線程安全的計數器
Application.Lock();
int count = (int)Application["VisitorCount"];
Application["VisitorCount"] = count + 1;
Application.UnLock();</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>ViewState</strong> 會增加頁面大小，請適度使用</li>
                            <li><strong>Session</strong> 占用伺服器記憶體，設定適當的逾時</li>
                            <li><strong>Cookie</strong> 可能被用戶禁用，需要處理異常</li>
                            <li><strong>Application</strong> 需要考慮線程安全性</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-security" class="py-3">
                <h2 class="text-info fw-bold border-bottom pb-2 mb-3"><span class="badge bg-info me-2">8</span>驗證與安全性</h2>
                <div id="aspnet-security-validation" class="mb-4">
                    <h4 class="text-dark">8.1 驗證控制項（RequiredFieldValidator 等）</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-check-circle me-2"></i>資料驗證的重要性</h5>
                        <p class="mb-0">資料驗證是 Web 應用程式安全性的第一道防線，確保使用者輸入的資料符合預期格式和規則。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-shield-alt me-2"></i>常用驗證控制項</h5>
                    
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-info">
                                <tr>
                                    <th>驗證控制項</th>
                                    <th>功能</th>
                                    <th>主要屬性</th>
                                    <th>使用情況</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>RequiredFieldValidator</strong></td>
                                    <td>必填欄位驗證</td>
                                    <td>ControlToValidate</td>
                                    <td>基本資料輸入</td>
                                </tr>
                                <tr>
                                    <td><strong>RegularExpressionValidator</strong></td>
                                    <td>正則表示式驗證</td>
                                    <td>ValidationExpression</td>
                                    <td>電子郵件、電話格式</td>
                                </tr>
                                <tr>
                                    <td><strong>RangeValidator</strong></td>
                                    <td>範圍驗證</td>
                                    <td>MinimumValue, MaximumValue</td>
                                    <td>數字、日期範圍</td>
                                </tr>
                                <tr>
                                    <td><strong>CompareValidator</strong></td>
                                    <td>比較驗證</td>
                                    <td>ControlToCompare, Operator</td>
                                    <td>密碼確認、數值比較</td>
                                </tr>
                                <tr>
                                    <td><strong>CustomValidator</strong></td>
                                    <td>自定義驗證</td>
                                    <td>ClientValidationFunction</td>
                                    <td>複雜業務邏輯</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>實用範例</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">使用者註冊表單驗證：</h6>
                        <pre class="mb-0"><code>&lt;!-- 必填欄位驗證 --&gt;
&lt;asp:TextBox ID="txtUserName" runat="server" CssClass="form-control" /&gt;
&lt;asp:RequiredFieldValidator ID="rfvUserName" runat="server" 
    ControlToValidate="txtUserName"
    ErrorMessage="使用者名稱為必填"
    CssClass="text-danger" /&gt;

&lt;!-- 電子郵件格式驗證 --&gt;
&lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" /&gt;
&lt;asp:RegularExpressionValidator ID="revEmail" runat="server" 
    ControlToValidate="txtEmail"
    ValidationExpression="\\w+([\\.-]?\\w+)*@\\w+([\\.-]?\\w+)*(\\.\\w{2,3})+"
    ErrorMessage="電子郵件格式不正確"
    CssClass="text-danger" /&gt;

&lt;!-- 密碼長度驗證 --&gt;
&lt;asp:TextBox ID="txtPassword" runat="server" TextMode="Password" CssClass="form-control" /&gt;
&lt;asp:RegularExpressionValidator ID="revPassword" runat="server" 
    ControlToValidate="txtPassword"
    ValidationExpression=".{6,}"
    ErrorMessage="密碼至少6個字元"
    CssClass="text-danger" /&gt;

&lt;!-- 密碼確認驗證 --&gt;
&lt;asp:TextBox ID="txtConfirmPassword" runat="server" TextMode="Password" CssClass="form-control" /&gt;
&lt;asp:CompareValidator ID="cvPassword" runat="server" 
    ControlToValidate="txtConfirmPassword"
    ControlToCompare="txtPassword"
    ErrorMessage="密碼確認不一致"
    CssClass="text-danger" /&gt;

&lt;!-- 年齡範圍驗證 --&gt;
&lt;asp:TextBox ID="txtAge" runat="server" CssClass="form-control" /&gt;
&lt;asp:RangeValidator ID="rvAge" runat="server" 
    ControlToValidate="txtAge"
    Type="Integer"
    MinimumValue="18"
    MaximumValue="100"
    ErrorMessage="年齡必須在 18-100 歲之間"
    CssClass="text-danger" /&gt;</code></pre>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>驗證最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li>使用 <strong>ValidationSummary</strong> 集中顯示所有錯誤</li>
                            <li>同時實作 <strong>用戶端和伺服器端驗證</strong></li>
                            <li>使用 <strong>Page.IsValid</strong> 在伺服器端檢查驗證結果</li>
                            <li>提供 <strong>明確的錯誤訊息</strong> 幫助使用者修正</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-security-auth" class="mb-4">
                    <h4 class="text-dark">8.2 使用者登入與授權</h4>
                    
                    <div class="alert alert-danger border-start border-4 border-danger">
                        <h5 class="alert-heading"><i class="fa-solid fa-lock me-2"></i>身份驗證與授權</h5>
                        <p class="mb-0">身份驗證 (Authentication) 確認使用者身份，授權 (Authorization) 決定使用者可以存取的資源。</p>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-user-shield me-2"></i>ASP.NET 身份驗證模式</h5>
                    
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Windows 驗證</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>使用 Windows 帳戶</p>
                                    <p class="card-text small"><strong>適用：</strong>內部應用系統</p>
                                    <p class="card-text small"><strong>設定：</strong>&lt;authentication mode="Windows" /&gt;</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Forms 驗證</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>自定義登入表單</p>
                                    <p class="card-text small"><strong>適用：</strong>網際網路應用</p>
                                    <p class="card-text small"><strong>設定：</strong>&lt;authentication mode="Forms" /&gt;</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">None</h6>
                                </div>
                                <div class="card-body">
                                    <p class="card-text small"><strong>特色：</strong>無身份驗證</p>
                                    <p class="card-text small"><strong>適用：</strong>公開網站</p>
                                    <p class="card-text small"><strong>設定：</strong>&lt;authentication mode="None" /&gt;</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-code me-2"></i>Forms 驗證實作</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">Web.config 設定：</h6>
                        <pre class="mb-3"><code>&lt;system.web&gt;
  &lt;authentication mode="Forms"&gt;
    &lt;forms loginUrl="Login.aspx" 
           defaultUrl="Default.aspx" 
           timeout="20" 
           cookieless="false" /&gt;
  &lt;/authentication&gt;
  
  &lt;authorization&gt;
    &lt;deny users="?" /&gt;  &lt;!-- 拒絕匿名使用者 --&gt;
  &lt;/authorization&gt;
&lt;/system.web&gt;</code></pre>
                        
                        <h6 class="mb-2">Login.aspx.cs 登入處理：</h6>
                        <pre class="mb-0"><code>protected void btnLogin_Click(object sender, EventArgs e)
{
    string username = txtUserName.Text.Trim();
    string password = txtPassword.Text;
    
    // 驗證使用者身份 (此處應連接資料庫驗證)
    if (ValidateUser(username, password))
    {
        // 建立驗證 Cookie
        FormsAuthentication.SetAuthCookie(username, chkRememberMe.Checked);
        
        // 設定 Session 資料
        Session["UserName"] = username;
        Session["LoginTime"] = DateTime.Now;
        
        // 重定向到預設頁面
        Response.Redirect(FormsAuthentication.GetRedirectUrl(username, false));
    }
    else
    {
        lblError.Text = "帳號或密碼錯誤";
        lblError.Visible = true;
    }
}

private bool ValidateUser(string username, string password)
{
    // TODO: 實作資料庫驗證邏輯
    // 此處應該使用加密密碼與資料庫比對
    string hashedPassword = HashPassword(password);
    
    using (SqlConnection conn = new SqlConnection(connectionString))
    {
        string sql = "SELECT COUNT(*) FROM Users WHERE Username = @Username AND Password = @Password AND IsActive = 1";
        using (SqlCommand cmd = new SqlCommand(sql, conn))
        {
            cmd.Parameters.AddWithValue("@Username", username);
            cmd.Parameters.AddWithValue("@Password", hashedPassword);
            
            conn.Open();
            int userCount = (int)cmd.ExecuteScalar();
            return userCount > 0;
        }
    }
}</code></pre>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-key me-2"></i>安全性最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>密碼加密：</strong>使用 bcrypt 或 PBKDF2 加密密碼</li>
                            <li><strong>HTTPS：</strong>強制使用 SSL/TLS 保護傳輸</li>
                            <li><strong>防止暴力破解：</strong>實作登入失敗鎖定機制</li>
                            <li><strong>Session 管理：</strong>設定適當的逾時時間</li>
                            <li><strong>登出功能：</strong>使用 FormsAuthentication.SignOut()</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-deploy" class="py-3">
                <h2 class="text-warning fw-bold border-bottom pb-2 mb-3"><span class="badge bg-warning me-2">9</span>網站發佈與部署</h2>
                <div id="aspnet-deploy-iis" class="mb-4">
                    <h4 class="text-dark">9.1 發佈到本機 IIS</h4>
                    
                    <div class="alert alert-warning border-start border-4 border-warning">
                        <h5 class="alert-heading"><i class="fa-solid fa-server me-2"></i>IIS 部署概念</h5>
                        <p class="mb-0">Internet Information Services (IIS) 是 Microsoft 的 Web 伺服器，為 ASP.NET 應用程式提供完整的運行環境。</p>
                    </div>

                    <h5 class="text-warning mt-4 mb-3"><i class="fa-solid fa-list-ol me-2"></i>部署步驟</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">1. 安裝 IIS</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>開啟「程式和功能」</li>
                                        <li>選擇「開啟或關閉 Windows 功能」</li>
                                        <li>勾選「Internet Information Services」</li>
                                        <li>勾選「.NET Framework 4.8 進階服務」</li>
                                        <li>重新啟動電腦</li>
                                    </ol>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">2. 建立應用程式</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>開啟 IIS 管理員</li>
                                        <li>展開伺服器名稱</li>
                                        <li>右鍵點擊「網站」</li>
                                        <li>選擇「新增網站」</li>
                                        <li>填入網站資訊</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">3. 發佈程式</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>在 Visual Studio 中選擇「建置」</li>
                                        <li>選擇「發佈網站」</li>
                                        <li>選擇發佈方法：「檔案系統」</li>
                                        <li>設定目標位置</li>
                                        <li>點擊「發佈」</li>
                                    </ol>
                                </div>
                            </div>
                            
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">4. 設定權限</h6>
                                </div>
                                <div class="card-body">
                                    <ol class="small mb-0">
                                        <li>設定 IIS_IUSRS 權限</li>
                                        <li>設定 App_Data 資料夾權限</li>
                                        <li>設定資料庫連線權限</li>
                                        <li>測試網站運作</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-danger mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>常見問題與解決</h6>
                        <ul class="mb-0 small">
                            <li><strong>404 錯誤：</strong>檢查預設文件設定</li>
                            <li><strong>500 錯誤：</strong>檢查 web.config 設定和錯誤日誌</li>
                            <li><strong>權限問題：</strong>設定 IIS_IUSRS 完整控制權</li>
                            <li><strong>資料庫連線：</strong>調整連線字串中的伺服器名稱</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-deploy-azure" class="mb-4">
                    <h4 class="text-dark">9.2 發佈到雲端（如 Azure）</h4>
                    
                    <div class="alert alert-info border-start border-4 border-info">
                        <h5 class="alert-heading"><i class="fa-solid fa-cloud me-2"></i>雲端部署優勢</h5>
                        <p class="mb-0">雲端部署提供高可用性、自動擴展、全球分發等優勢，是現代 Web 應用程式的首選。</p>
                    </div>

                    <h5 class="text-info mt-4 mb-3"><i class="fa-solid fa-microsoft me-2"></i>Azure App Service 部署</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">1. 建立 Azure App Service：</h6>
                        <pre class="mb-3"><code># 使用 Azure CLI
az login
az group create --name myResourceGroup --location "East US"
az appservice plan create --name myAppServicePlan --resource-group myResourceGroup --sku FREE
az webapp create --resource-group myResourceGroup --plan myAppServicePlan --name myWebApp</code></pre>
                        
                        <h6 class="mb-2">2. Visual Studio 發佈設定：</h6>
                        <ol class="small mb-0">
                            <li>右鍵點擊專案 → 發佈</li>
                            <li>選擇 "Azure" → "Azure App Service (Windows)"</li>
                            <li>選擇或建立新的 App Service</li>
                            <li>設定發佈配置檔</li>
                            <li>點擊發佈</li>
                        </ol>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-check me-2"></i>雲端部署最佳實踐</h6>
                        <ul class="mb-0 small">
                            <li><strong>環境分離：</strong>建立開發、測試、生產環境</li>
                            <li><strong>CI/CD：</strong>使用 Azure DevOps 或 GitHub Actions</li>
                            <li><strong>監控：</strong>啟用 Application Insights</li>
                            <li><strong>備份：</strong>定期備份資料庫和應用</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section id="aspnet-advanced" class="py-3">
                <h2 class="text-danger fw-bold border-bottom pb-2 mb-3"><span class="badge bg-danger me-2">10</span>進階主題</h2>
                <div id="aspnet-advanced-masteruser" class="mb-4">
                    <h4 class="text-dark">10.1 Master Page 與 User Control</h4>
                    
                    <div class="alert alert-danger border-start border-4 border-danger">
                        <h5 class="alert-heading"><i class="fa-solid fa-puzzle-piece me-2"></i>模組化開發</h5>
                        <p class="mb-0">Master Page 和 User Control 是 Web Forms 實現代碼重用和一致性的主要機制。</p>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-layer-group me-2"></i>Master Page 概念</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">Site.Master 範例</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;%@ Master Language="C#" AutoEventWireup="true" CodeBehind="Site.master.cs" Inherits="MyApp.SiteMaster" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head runat="server"&gt;
    &lt;title&gt;&lt;asp:ContentPlaceHolder ID="TitleContent" runat="server" /&gt;&lt;/title&gt;
    &lt;link href="~/Content/bootstrap.min.css" rel="stylesheet" /&gt;
    &lt;asp:ContentPlaceHolder ID="HeadContent" runat="server"&gt;&lt;/asp:ContentPlaceHolder&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;nav class="navbar navbar-expand-lg navbar-dark bg-dark"&gt;
            &lt;!-- 導航列內容 --&gt;
        &lt;/nav&gt;
        
        &lt;main class="container mt-4"&gt;
            &lt;asp:ContentPlaceHolder ID="MainContent" runat="server"&gt;&lt;/asp:ContentPlaceHolder&gt;
        &lt;/main&gt;
        
        &lt;footer class="bg-dark text-light mt-5 py-3"&gt;
            &lt;!-- 頁尾內容 --&gt;
        &lt;/footer&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">內容頁面使用</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;%@ Page Title="首頁" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="MyApp.Default" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server"&gt;
    我的網站 - 首頁
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content2" ContentPlaceHolderID="HeadContent" runat="server"&gt;
    &lt;style&gt;
        .welcome { color: #007bff; }
    &lt;/style&gt;
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content3" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;h1 class="welcome"&gt;歡迎來到我的網站&lt;/h1&gt;
    &lt;p&gt;這是使用 Master Page 的內容頁面。&lt;/p&gt;
&lt;/asp:Content&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-danger mt-4 mb-3"><i class="fa-solid fa-cube me-2"></i>User Control 使用</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">UserInfo.ascx 使用者控制項：</h6>
                        <pre class="mb-3"><code>&lt;%@ Control Language="C#" AutoEventWireup="true" CodeBehind="UserInfo.ascx.cs" Inherits="MyApp.Controls.UserInfo" %&gt;

&lt;div class="user-info-panel"&gt;
    &lt;h5&gt;使用者資訊&lt;/h5&gt;
    &lt;p&gt;&lt;strong&gt;姓名：&lt;/strong&gt; &lt;asp:Label ID="lblUserName" runat="server" /&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;部門：&lt;/strong&gt; &lt;asp:Label ID="lblDepartment" runat="server" /&gt;&lt;/p&gt;
    &lt;p&gt;&lt;strong&gt;登入時間：&lt;/strong&gt; &lt;asp:Label ID="lblLoginTime" runat="server" /&gt;&lt;/p&gt;
&lt;/div&gt;</code></pre>
                        
                        <h6 class="mb-2">在頁面中使用 User Control：</h6>
                        <pre class="mb-0"><code>&lt;%@ Register Src="~/Controls/UserInfo.ascx" TagPrefix="uc" TagName="UserInfo" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="row"&gt;
        &lt;div class="col-md-8"&gt;
            &lt;!-- 主要內容 --&gt;
        &lt;/div&gt;
        &lt;div class="col-md-4"&gt;
            &lt;uc:UserInfo ID="userInfo1" runat="server" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>
                    </div>

                    <div class="alert alert-info mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-lightbulb me-2"></i>使用時機</h6>
                        <ul class="mb-0 small">
                            <li><strong>Master Page：</strong>適用於網站布局、導航、頁尾等全域元素</li>
                            <li><strong>User Control：</strong>適用於可重用的功能模組，如評論系統、廣告</li>
                            <li><strong>效益：</strong>減少代碼重複、提高維護性、確保一致性</li>
                        </ul>
                    </div>
                </div>
                <div id="aspnet-advanced-customcontrols" class="mb-4">
                    <h4 class="text-dark">10.2 自訂伺服器控制項</h4>
                    <p>詳細內容將在此處提供。</p>
                </div>
                <div id="aspnet-advanced-ajax" class="mb-4">
                    <h4 class="text-dark">10.3 AJAX 與 UpdatePanel</h4>
                    
                    <div class="alert alert-primary border-start border-4 border-primary">
                        <h5 class="alert-heading"><i class="fa-solid fa-bolt me-2"></i>AJAX 在 Web Forms 中的應用</h5>
                        <p class="mb-0">AJAX 技術讓 Web 應用程式可以在不重新載入整個頁面的情況下更新部分內容，提供更好的使用者體驗。</p>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-sync-alt me-2"></i>UpdatePanel 使用</h5>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">基本設定</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>&lt;asp:ScriptManager ID="ScriptManager1" runat="server" /&gt;

&lt;asp:UpdatePanel ID="UpdatePanel1" runat="server"&gt;
    &lt;ContentTemplate&gt;
        &lt;asp:Label ID="lblTime" runat="server" /&gt;
        &lt;asp:Button ID="btnUpdate" runat="server" 
            Text="更新時間" OnClick="btnUpdate_Click" /&gt;
    &lt;/ContentTemplate&gt;
&lt;/asp:UpdatePanel&gt;

&lt;!-- 這個部分不會因 AJAX 而重新載入 --&gt;
&lt;div&gt;
    &lt;p&gt;頁面加載時間：&lt;asp:Label ID="lblPageLoad" runat="server" /&gt;&lt;/p&gt;
&lt;/div&gt;</code></pre>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header bg-light">
                                    <h6 class="card-title mb-0">伺服器端程式碼</h6>
                                </div>
                                <div class="card-body">
                                    <pre class="small mb-0"><code>protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        lblPageLoad.Text = DateTime.Now.ToString("HH:mm:ss");
        lblTime.Text = DateTime.Now.ToString("HH:mm:ss");
    }
}

protected void btnUpdate_Click(object sender, EventArgs e)
{
    // 只有 UpdatePanel 內部會更新
    lblTime.Text = DateTime.Now.ToString("HH:mm:ss");
    
    // 模擬處理時間
    System.Threading.Thread.Sleep(1000);
}</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h5 class="text-primary mt-4 mb-3"><i class="fa-solid fa-cog me-2"></i>進階功能</h5>
                    
                    <div class="bg-light p-3 rounded">
                        <h6 class="mb-2">外部觸發器 (Triggers)：</h6>
                        <pre class="mb-3"><code>&lt;asp:UpdatePanel ID="UpdatePanel2" runat="server"&gt;
    &lt;ContentTemplate&gt;
        &lt;asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1" /&gt;
    &lt;/ContentTemplate&gt;
    &lt;Triggers&gt;
        &lt;asp:AsyncPostBackTrigger ControlID="btnRefresh" EventName="Click" /&gt;
        &lt;asp:PostBackTrigger ControlID="btnExport" /&gt; &lt;!-- 強制完整 PostBack --&gt;
    &lt;/Triggers&gt;
&lt;/asp:UpdatePanel&gt;

&lt;!-- 在 UpdatePanel 外部的控制項 --&gt;
&lt;asp:Button ID="btnRefresh" runat="server" Text="更新資料" OnClick="btnRefresh_Click" /&gt;
&lt;asp:Button ID="btnExport" runat="server" Text="匯出 Excel" OnClick="btnExport_Click" /&gt;</code></pre>
                        
                        <h6 class="mb-2">程式化更新：</h6>
                        <pre class="mb-0"><code>// 在伺服器端程式碼中手動觸發更新
UpdatePanel1.Update();

// 設定更新模式
UpdatePanel1.UpdateMode = UpdatePanelUpdateMode.Conditional;

// 在用戶端 JavaScript 中觸發 PostBack
__doPostBack('UpdatePanel1', '');</code></pre>
                    </div>

                    <div class="alert alert-warning mt-4">
                        <h6 class="alert-heading"><i class="fa-solid fa-exclamation-triangle me-2"></i>使用注意事項</h6>
                        <ul class="mb-0 small">
                            <li><strong>效能：</strong>UpdatePanel 仍然會執行完整的頁面生命週期</li>
                            <li><strong>單一 ScriptManager：</strong>每個頁面只能有一個 ScriptManager</li>
                            <li><strong>巢狀結構：</strong>避免 UpdatePanel 巢狀使用</li>
                            <li><strong>JavaScript 相容：</strong>注意 AJAX 更新後 JavaScript 事件繩定</li>
                        </ul>
                    </div>
                </div>
            </section>

        </section>
    </main>

    <button onclick="scrollToTop()" id="backToTopBtn" class="back-to-top" title="回到頂部"><i
            class="fa-solid fa-arrow-up"></i></button>

    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div class="container">
            <p class="mb-0">&copy; 2023-2025 網站教學. All Rights Reserved.</p>
            <p class="small mb-0">本網站內容僅供教學使用，不具任何商業用途。</p>
            <div>
                <a href="#" class="text-white me-2"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="text-white me-2"><i class="fab fa-twitter"></i></a>
                <a href="#" class="text-white"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5.3.0 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 當頁面載入完成後執行
        document.addEventListener('DOMContentLoaded', function() {
            // 為所有的 pre > code 元素添加複製按鈕
            const codeBlocks = document.querySelectorAll('pre code');
            
            codeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                
                // 如果已經有複製按鈕，跳過
                if (pre.parentElement.classList.contains('code-container')) {
                    return;
                }
                
                // 創建容器包裝 pre 元素
                const container = document.createElement('div');
                container.className = 'code-container';
                
                // 將 pre 元素包裝在容器中
                pre.parentNode.insertBefore(container, pre);
                container.appendChild(pre);
                
                // 創建複製按鈕
                const copyButton = document.createElement('button');
                copyButton.className = 'copy-btn';
                copyButton.innerHTML = '<i class="fa-regular fa-copy me-1"></i>複製';
                copyButton.setAttribute('title', '複製程式碼');
                
                // 添加複製功能
                copyButton.addEventListener('click', function() {
                    // 取得程式碼文字（移除多餘的空白和換行）
                    const codeText = codeBlock.textContent || codeBlock.innerText;
                    
                    // 使用 Clipboard API 複製文字
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(codeText).then(function() {
                            showCopySuccess(copyButton);
                        }).catch(function(err) {
                            console.error('複製失敗: ', err);
                            fallbackCopy(codeText, copyButton);
                        });
                    } else {
                        // 使用備用方法
                        fallbackCopy(codeText, copyButton);
                    }
                });
                
                // 將按鈕添加到容器中
                container.appendChild(copyButton);
            });

            // 索引選單展開/收合圖示切換
            const indexContent = document.getElementById('indexContent');
            const toggleIcon = document.getElementById('toggleIcon');

            if (indexContent && toggleIcon) {
                indexContent.addEventListener('shown.bs.collapse', function () {
                    toggleIcon.className = 'fa-solid fa-chevron-up';
                });

                indexContent.addEventListener('hidden.bs.collapse', function () {
                    toggleIcon.className = 'fa-solid fa-chevron-down';
                });
            }
        });
        
        // 顯示複製成功狀態
        function showCopySuccess(button) {
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fa-solid fa-check me-1"></i>已複製';
            button.classList.add('success');
            
            // 2秒後恢復原狀
            setTimeout(function() {
                button.innerHTML = originalText;
                button.classList.remove('success');
            }, 2000);
        }
        
        // 備用複製方法（對於不支援 Clipboard API 的瀏覽器）
        function fallbackCopy(text, button) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess(button);
                } else {
                    console.error('備用複製方法失敗');
                }
            } catch (err) {
                console.error('備用複製方法錯誤: ', err);
            }
            
            document.body.removeChild(textArea);
        }

        // 返回頂部按鈕功能
        const backToTopBtn = document.getElementById('backToTopBtn');

        window.onscroll = function () {
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                backToTopBtn.classList.add('show');
            } else {
                backToTopBtn.classList.remove('show');
            }
        };

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>

</html>
